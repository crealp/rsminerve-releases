<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
  <meta charset="utf-8">
  <meta name="generator" content="quarto-0.9.233">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>RS MINERVE - Technical Manual - 4&nbsp; Expert module - Calibration algorithms</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>

  <script src="site_libs/quarto-nav/quarto-nav.js"></script>
  <script src="site_libs/quarto-nav/headroom.min.js"></script>
  <script src="site_libs/clipboard/clipboard.min.js"></script>
  <meta name="quarto:offset" content="./">
  <script src="site_libs/quarto-search/autocomplete.umd.js"></script>
  <script src="site_libs/quarto-search/fuse.min.js"></script>
  <script src="site_libs/quarto-search/quarto-search.js"></script>
  <link href="./stochastic_equations.html" rel="next">
  <link href="./performance_indicators.html" rel="prev">
  <script src="site_libs/quarto-html/quarto.js"></script>
  <script src="site_libs/quarto-html/popper.min.js"></script>
  <script src="site_libs/quarto-html/tippy.umd.min.js"></script>
  <script src="site_libs/quarto-html/anchor.min.js"></script>
  <link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
  <link id="quarto-text-highlighting-styles" href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
  <script src="site_libs/bootstrap/bootstrap.min.js"></script>
  <link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
  <link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
  <script id="quarto-search-options" type="application/json">{
    "location": "sidebar",
    "copy-button": false,
    "collapse-after": 3,
    "panel-placement": "start",
    "type": "textbox",
    "limit": 20,
    "language": {
      "search-no-results-text": "No results",
      "search-matching-documents-text": "matching documents",
      "search-copy-link-title": "Copy link to search",
      "search-hide-matches-text": "Hide additional matches",
      "search-more-match-text": "more match in this document",
      "search-more-matches-text": "more matches in this document",
      "search-clear-button-title": "Clear",
      "search-detached-cancel-button-title": "Cancel",
      "search-submit-button-title": "Submit"
    }
  }</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body class="floating">
<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Expert module - Calibration algorithms</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">RS MINERVE - Technical Manual</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foreword.html" class="sidebar-item-text sidebar-link">Foreword</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hydrological_models.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Hydrological and hydraulics models description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./performance_indicators.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Performance indicators</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./calibration_algorithms.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Expert module - Calibration algorithms</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stochastic_equations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Expert module - Stochastic equations</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
<h2 id="toc-title">Table of contents</h2>
<ul>
<li><a href="#sec-calibration_algorithms_intro" id="toc-sec-calibration_algorithms_intro" class="nav-link active" data-scroll-target="#sec-calibration_algorithms_intro"> <span class="header-section-number">4.1</span> Introduction to the calibration module</a></li>
<li><a href="#sec-calibration_algorithms_of" id="toc-sec-calibration_algorithms_of" class="nav-link" data-scroll-target="#sec-calibration_algorithms_of"> <span class="header-section-number">4.2</span> Objective function</a></li>
<li><a href="#sec-calibration_algorithms_sce_ua" id="toc-sec-calibration_algorithms_sce_ua" class="nav-link" data-scroll-target="#sec-calibration_algorithms_sce_ua"> <span class="header-section-number">4.3</span> Shuffled Complex Evoluation – University of Arizona</a>
<ul class="collapse">
<li><a href="#model-architecture" id="toc-model-architecture" class="nav-link" data-scroll-target="#model-architecture"> <span class="header-section-number">4.3.1</span> Model architecture</a></li>
<li><a href="#algorithm-parameters" id="toc-algorithm-parameters" class="nav-link" data-scroll-target="#algorithm-parameters"> <span class="header-section-number">4.3.2</span> Algorithm parameters</a></li>
</ul></li>
<li><a href="#sec-calibration_algorithms_uamc" id="toc-sec-calibration_algorithms_uamc" class="nav-link" data-scroll-target="#sec-calibration_algorithms_uamc"> <span class="header-section-number">4.4</span> Uniform Adaptive Monte Carlo</a>
<ul class="collapse">
<li><a href="#model-architecture-1" id="toc-model-architecture-1" class="nav-link" data-scroll-target="#model-architecture-1"> <span class="header-section-number">4.4.1</span> Model architecture</a></li>
<li><a href="#algorithm-parameters-1" id="toc-algorithm-parameters-1" class="nav-link" data-scroll-target="#algorithm-parameters-1"> <span class="header-section-number">4.4.2</span> Algorithm parameters</a></li>
</ul></li>
<li><a href="#sec-calibration_algorithms_rosenb" id="toc-sec-calibration_algorithms_rosenb" class="nav-link" data-scroll-target="#sec-calibration_algorithms_rosenb"> <span class="header-section-number">4.5</span> Coupled Latin Hypercube and Rosenbrock</a>
<ul class="collapse">
<li><a href="#model-architecture-2" id="toc-model-architecture-2" class="nav-link" data-scroll-target="#model-architecture-2"> <span class="header-section-number">4.5.1</span> Model architecture</a></li>
<li><a href="#algorithm-parameters-2" id="toc-algorithm-parameters-2" class="nav-link" data-scroll-target="#algorithm-parameters-2"> <span class="header-section-number">4.5.2</span> Algorithm parameters</a></li>
</ul></li>
</ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">
<header id="title-block-header" class="quarto-title-block default">

<div class="quarto-title"><h1 class="title display-7"><span id="sec-calibration_algorithms" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Expert module - Calibration algorithms</span></span></h1></div></header>

<section id="sec-calibration_algorithms_intro" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="sec-calibration_algorithms_intro"><span class="header-section-number">4.1</span> Introduction to the calibration module</h2>
<p>The module <em>Calibrator</em> of the <strong>RS Expert</strong> frame has been implemented for calibrating the parameters of the hydrological model. This module uses an objective function defined by the user and different algorithms to solve it.</p>
<p>The first algorithm, the Shuffled Complex Evolution – University of Arizona (SCE-UA), is a global optimization method (Duan et al., 1992, 1993) based on a synthesis of the best features from several existing algorithms, including the genetic algorithm, and introduces the concept of complex information exchange, so-called complex shuffling. The SCE-UA method was designed for solving problems encountered in conceptual watershed model calibration (Hapuarachchi H.A.P. et al., 2001; Ajami et al., 2004; Muttil and Liong, 2004; Blasone et al., 2007), but has also been satisfyingly used in water resources management (Zhu et al., 2006; Lin et al., 2008; Wang et al., 2010).</p>
<p>The second algorithm is a variation of the Adaptive Markov Chain Monte Carlo, used since it can be interesting for solving complex problems in high dimensional spaces (Gilks et al., 1996; Liu, 2001). It has been modified to an Uniform Adaptative Monte Carlo (UAMC) in this program to adjust the solution space after a defined group of simulations up to the convergence of the optimization. Variations of the Monte Carlo method are usually used in hydrological problem for parameterization optimization (Vrugt and al., 2003; Jeremiah and al., 2012).</p>
<p>The third and last algorithm used in RS&nbsp;MINERVE is the Coupled Latin Hypercube and Rosenbrock (CLHR) It couples the Latin Hypercube algorithm (McKay et al., 1979) with the Rosenbrock algorithm (Rosenbrock, 1960), generating a powerful tool for optimization of complex problems. The latin hypercube algorithm has been usually used in hydrology for sampling the initial parameter space, combined the with other methods (van Griensven et al, 2006; Kamali et al., 2013). Rosenbrock algorithm has been also used for hydrological parameters optimisation (Abbot et Refsgaard, 1996) or optimization of numerical functions (Kang et al., 2011).</p>
</section>
<section id="sec-calibration_algorithms_of" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="sec-calibration_algorithms_of"><span class="header-section-number">4.2</span> Objective function</h2>
<p>A flexible objective function (OF) has been developed for the module of calibration aiming to be adapted to the user’s requirements. The indicators presented in Chapter 4 are used in this OF, each one weighted with a value defined by the user (<a href="#tbl-weights_indicators_of">Table&nbsp;<span>4.1</span></a>).</p>
<div id="tbl-weights_indicators_of" class="anchored">
<table class="table">
<caption>Table 4.1: Weights of the indicators for the objective function</caption>
<colgroup>
<col style="width: 47%">
<col style="width: 10%">
<col style="width: 22%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th>Indicator</th>
<th>Weight</th>
<th>Range of Values</th>
<th>Ideal value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Nash</td>
<td>w<sub>1</sub></td>
<td>-∞ to 1</td>
<td>1</td>
</tr>
<tr class="even">
<td>Nash-ln</td>
<td>w<sub>2</sub></td>
<td>-∞ to 1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Pearson Correlation Coefficient</td>
<td>w<sub>3</sub></td>
<td>-1 to 1</td>
<td>1</td>
</tr>
<tr class="even">
<td>Kling-Gupta Efficiency (KGE)</td>
<td>w<sub>4</sub></td>
<td>-∞ to 1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Bias Score (BS)</td>
<td>w<sub>5</sub></td>
<td>-∞ to 1</td>
<td>1</td>
</tr>
<tr class="even">
<td>Relative Root Mean Square Error (RRMSE)</td>
<td>w<sub>6</sub></td>
<td>0 to +∞</td>
<td>0</td>
</tr>
<tr class="odd">
<td>Relative Volume Bias (RVB)</td>
<td>w<sub>7</sub></td>
<td>-∞ to +∞</td>
<td>0</td>
</tr>
<tr class="even">
<td>Normalized Peak Error (NPE)</td>
<td>w<sub>8</sub></td>
<td>-∞ to +∞</td>
<td>0</td>
</tr>
<tr class="odd">
<td>Peirce Skill Score (PSS)</td>
<td>w<sub>9</sub></td>
<td>-1 to 1</td>
<td>1</td>
</tr>
<tr class="even">
<td>Overall Accuracy (OA)</td>
<td>w<sub>10</sub></td>
<td>0 to 1</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
<p>The OF is presented in equation <a href="#eq-CAL1">Equation&nbsp;<span>4.1</span></a> and takes into account the ideal values of each indicator. Thus, the OF searches to maximize the first five and last two indicators (Nash, Nash-ln, Pearson, Kling-Gupta, BS, PSS and OA) since their ideal value is equal to the maximum possible value and, at the same time, to minimize the value or the absolute value for the three other indicators (RRMSE, RVB, NPE) since their ideal value corresponds to zero.</p>
<p><span id="eq-CAL1"><span class="math display">\[
OF = max(Nash \cdot w_{1} + Nashln \cdot w_{2} + Pearson \cdot w_{3} + KGE \cdot w_{4} + BS \cdot w_{5} - RRMSE \cdot w_{6} - \left| RVB \cdot w_{7} \right| - \left| NPE \cdot w_{8} \right| + PSS \cdot w_{9} + OA \cdot w_{10})
\qquad(4.1)\]</span></span></p>
</section>
<section id="sec-calibration_algorithms_sce_ua" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="sec-calibration_algorithms_sce_ua"><span class="header-section-number">4.3</span> Shuffled Complex Evoluation – University of Arizona</h2>
<section id="model-architecture" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="model-architecture"><span class="header-section-number">4.3.1</span> Model architecture</h3>
<p>The Shuffled Complex Evolution – University of Arizona (SCE-UA) method was developed to obtain the traditional best parameter set and its underlying posterior distribution within a single optimization run. The goal is to find a single best parameter set in the feasible space. It starts with a random sample of points distributed throughout the feasible parameter space, and uses an adaptation of the Simplex Downhill search scheme (Nelder and Mead, 1965) to continuously evolve the population toward better solutions in the search space, progressively relinquishing occupation of regions with lower posterior probability (Mariani et al., 2011).</p>
<p>A general description of the steps of the SCE-UA method is given below (Duan et al., 1994) and illustrated in <a href="#fig-flowchart_sce">Figure&nbsp;<span>4.1</span></a>.</p>
<p><em>Step 1</em></p>
<p>Generate sample: Sample NPT points in the feasible parameter space and compute the criterion value at each point. In the absence of prior information on the location of the global optimum, use a uniform probability distribution to generate a sample.</p>
<p><em>Step 2</em></p>
<p>Rank points: Sort the NPT points to increase criterion value so that the first point represents the point with the lowest criterion value and the last the one with the highest criterion value (assuming that the goal is to minimize the criterion value).</p>
<p><em>Step 3</em></p>
<p>Partition into complexes: Partition the NPT points into NGS complexes, each containing NPG points. The complexes are partitioned in such a way that the first complex contains every <em>NGS (k-1)+1</em> ranked point, the second complex contains every <em>NGS (k-1)+2</em> ranked point, and so on, where <em>k = 1,2,...,NPG</em>.</p>
<p><em>Step 4</em></p>
<p>Evolve each complex: Evolve each complex independently by taking NSPL evolution steps, according to the Competitive Complex Evolution (CCE) algorithm. <a href="#fig-sce_ua_steps">Figure&nbsp;<span>4.3</span></a> illustrates how each evolution step is taken.</p>
<p><em>Step 5</em></p>
<p>Shuffle complexes: Combine the points in the evolved complexes into a single sample population; sort the sample population in order of increasing criterion value; re-partition or shuffle the sample population into NGS complexes according to the procedure specified in the third step.</p>
<p><em>Step 6</em></p>
<p>Check convergence: If any of the pre-specified convergence criteria are satisfied, stop; otherwise, continue.</p>
<p><em>Step 7</em></p>
<p>Check complex number reduction: If <em>MINGS</em> (the minimum number of complexes)&nbsp;<em>&lt;&nbsp;NGS</em>, remove the complex with the lowest ranked points; set <em>NGS=NGS-1</em> and <em>NPT=NGS NPG</em>; and return to Step 4. If <em>MINGS=NGS</em>, return to Step 4.</p>
<div id="fig-flowchart_sce" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/fig-flowchart_sce.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.1: Flow chart of the shuffled complex evolution method (from Duan et al., 1993), with <em>V=n</em>, <em>NGS=p</em>, <em>NPG=m</em> and <em>NPT=s</em></figcaption><p></p>
</figure>
</div>
<p>The SCE-UA method is explained in <a href="#fig-sce_ua_method">Figure&nbsp;<span>4.2</span></a> and <a href="#fig-sce_ua_steps">Figure&nbsp;<span>4.3</span></a> for a two dimensional case (Duan et al., 1994). The contour lines in <a href="#fig-sce_ua_method">Figure&nbsp;<span>4.2</span></a> and <a href="#fig-sce_ua_steps">Figure&nbsp;<span>4.3</span></a> represent a function surface having a global optimum located at (4,2) and a local optimum located at (1,2). <a href="#fig-sce_ua_method">Figure&nbsp;<span>4.2</span></a> (a) shows that a sample population containing NPT (=10) points is divided into NGS (=2) complexes. Each complex contains NPG (=5) points which are marked by <strong>•</strong> and * respectively. <a href="#fig-sce_ua_method">Figure&nbsp;<span>4.2</span></a> (b) shows the locations of the points in the two independently evolved complexes at the end of the first cycle of evolution. It can be seen that one complex (marked by *) is converging towards the local optimum, while the other (marked by <strong>•</strong>) is converging toward the global optimum. The two evolved complexes are shuffled according to step 5. <a href="#fig-sce_ua_method">Figure&nbsp;<span>4.2</span></a> (c) displays the new membership of the two evolved complexes after shuffling.</p>
<p><a href="#fig-sce_ua_method">Figure&nbsp;<span>4.2</span></a> (d) illustrates the two complexes at the end of the second cycle of evolution. It is clear that both complexes are now converging to the global optimum at the end of second cycle.</p>
<div id="fig-sce_ua_method" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/fig-sce_ua_method.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.2: Illustration of the shuffled complex evolution (SCE-UA) method (from Duan et al., 1994)</figcaption><p></p>
</figure>
</div>
<p>The CCE algorithm is graphically illustrated in <a href="#fig-sce_ua_steps">Figure&nbsp;<span>4.3</span></a>. The black dots (<strong>•</strong>) indicate the locations of the points in a complex before the evolution step is taken. A sub-complex containing NPS (=3, i.e.&nbsp;forms a triangle in this case) points is selected according to a pre-specified probability distribution to initiate an evolution step.</p>
<p>The probability distribution is specified such that the better points have a higher chance of being chosen to form the sub-complex than the worse points. The symbol (*) represents the new points generated by the evolution steps. There are three types of evolution steps: reflection, contraction and mutation.</p>
<p><a href="#fig-sce_ua_steps">Figure&nbsp;<span>4.3</span></a> (a), <a href="#fig-sce_ua_steps">Figure&nbsp;<span>4.3</span></a> (b) and <a href="#fig-sce_ua_steps">Figure&nbsp;<span>4.3</span></a> (d) illustrate the "reflection" step, which is implemented by reflecting the worst point in a sub-complex through the centroid of the other points. Since the reflected point has a lower criterion value than the worst point, the worst point is discarded and replaced by the new point. Thus an evolution step is completed.</p>
<p>In <a href="#fig-sce_ua_steps">Figure&nbsp;<span>4.3</span></a> (c), the new point is generated by a "contraction" step (the new point lies half-way between the worst point and the centroid of the other points), after rejecting a reflection step for not improving the criterion value.</p>
<p>In <a href="#fig-sce_ua_steps">Figure&nbsp;<span>4.3</span></a> (e), a "mutation" step is taken by random selection of a point in the feasible parameter space to replace the wrong point of the sub-complex. This is realized after a reflection step is attempted, but results in a wrong point, i.e.&nbsp;outside of the feasible parameter space. Another scenario in which a mutation step is taken is when both the reflection step and the contraction step do not improve the criterion value.</p>
<p>Finally, the <a href="#fig-sce_ua_steps">Figure&nbsp;<span>4.3</span></a> (f) shows the final complex after NSPL (=5) evolution steps.</p>
<div id="fig-sce_ua_steps" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/fig-sce_ua_steps.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.3: Illustration of the evolution steps taken by each complex (from Duan et al., 1994).</figcaption><p></p>
</figure>
</div>
</section>
<section id="algorithm-parameters" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="algorithm-parameters"><span class="header-section-number">4.3.2</span> Algorithm parameters</h3>
<p>Different parameters of the SCE-UA have to be defined by the user (<a href="#tbl-param_sce_ua_algorithm">Table&nbsp;<span>4.2</span></a>), as presented hereafter, and other parameters are directly calculated by the process.</p>
<p>An initial set of <em>Nopt</em> parameters is given by the user or is assumed as random depending on the user’s needs and the used hydrological models. The other <em>NPT-1</em> points (or parameters sets) are randomly created by the algorithm, depending on a <em>SEED</em> value. The number of points NPG in each complex corresponds to <em>2 Nopt+1</em> and the number of points NPS in each sub-complex to <em>Nopt+1</em> (It has to be noted that each point corresponds to a set of parameters). The number of evolution steps allowed for each complex before complex shuffling, NSPL, is equal to NPG. The number of complexes is defined as <em>NGS</em>, which is assumed equal to MINGS according to the Duan investigation (Duan et al., 2004). Then, the total number of points NPT in the entire sample population is <em>NGS NPG</em>.</p>
<p>Three different convergence criteria are defined by the user:</p>
<ul>
<li><p>The maximum number of function evaluations (or iterations) <em>MAXN</em>.</p></li>
<li><p>The number of shuffling loops (<em>KSTOP</em>) in which the criterion value must change by a fixed percentage (<em>PCENTO</em>) before optimization is finished.</p></li>
<li><p>The <em>PEPS</em> parameter which provides a flag indicating whether parameter convergence is reached (It compares the value of PEPS with the normalized geometric mean of parameter ranges).</p></li>
</ul>
<div id="tbl-param_sce_ua_algorithm" class="anchored">
<table class="table">
<caption>Table 4.2: Parameters of the SCE-UA algorithm</caption>
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 45%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Units</th>
<th>Description</th>
<th>Default Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>MAXM</td>
<td>-</td>
<td>Maximum number of iterations</td>
<td>10000</td>
</tr>
<tr class="even">
<td>NGS</td>
<td>-</td>
<td>Number of complexes</td>
<td>3</td>
</tr>
<tr class="odd">
<td>KSTOP</td>
<td>-</td>
<td>Number of shuffling loops</td>
<td>10</td>
</tr>
<tr class="even">
<td>PCENTO</td>
<td>-</td>
<td>Criterion value on shuffling loops</td>
<td>0.1</td>
</tr>
<tr class="odd">
<td>PEPS</td>
<td>-</td>
<td>Convergence parameter</td>
<td>0.001</td>
</tr>
<tr class="even">
<td>SEED</td>
<td>-</td>
<td>Seed value</td>
<td>Random</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="sec-calibration_algorithms_uamc" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="sec-calibration_algorithms_uamc"><span class="header-section-number">4.4</span> Uniform Adaptive Monte Carlo</h2>
<section id="model-architecture-1" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="model-architecture-1"><span class="header-section-number">4.4.1</span> Model architecture</h3>
<p>The Uniform Adaptive Monte Carlo (UAMC) algorithm is based on the Monte Carlo experiments that rely on repeated random sampling to obtain simulation results (Gilks et al., 1996; Liu, 2001) ; but has been modified in order to iteratively adjust the solution space.</p>
<p>The algorithm randomly launches a collection of simulations (block) and finds the better results in the solution space. Afterwards, the solution space is adjusted and a new group of simulations starts. The process is repeated until the optimization converges to the best set of parameters (<a href="#fig-flowchart_uamc">Figure&nbsp;<span>4.4</span></a>).</p>
</section>
<section id="algorithm-parameters-1" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="algorithm-parameters-1"><span class="header-section-number">4.4.2</span> Algorithm parameters</h3>
<p>Different parameters of the UAMC algorithm have to be defined by the user (<a href="#tbl-param_sce_uamc_algorithm">Table&nbsp;<span>4.3</span></a>), as presented hereafter.</p>
<p>A number of iterations <em>ITGR</em> per group is defined for the optimization. Random values of parameters are used for each iteration of the group based on a <em>SEED</em> value. Once the first group of iterations is finished, a number <em>NUMBEST</em> of best values is applied for calculating the solutions space range for the next group of iterations. This solution space takes into account the minimum and the maximum values of each parameter providing the best values and adds an additional range <em>COEFRANG</em>.</p>
<p>Finally, the optimization finishes when the convergence criterion (defined as <em>ERR</em>) is achieved, or when the maximum number of iterations <em>MAXN</em> is attained.</p>
<div id="tbl-param_sce_uamc_algorithm" class="anchored">
<table class="table">
<caption>Table 4.3: Parameters of the UAMC algorithm</caption>
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 63%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Units</th>
<th>Description</th>
<th>Default Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>MAXN</td>
<td>-</td>
<td>Maximum number of iterations</td>
<td>2000</td>
</tr>
<tr class="even">
<td>ITGR</td>
<td>-</td>
<td>Number of iterations per group</td>
<td>100</td>
</tr>
<tr class="odd">
<td>NUMBEST</td>
<td>-</td>
<td>Number of best values taken into account for the next group calculation</td>
<td>5</td>
</tr>
<tr class="even">
<td>COEFRANG</td>
<td>-</td>
<td>Additional range coefficient</td>
<td>0.1</td>
</tr>
<tr class="odd">
<td>ERR</td>
<td>-</td>
<td>Error difference until convergence</td>
<td>0.001</td>
</tr>
<tr class="even">
<td>SEED</td>
<td>-</td>
<td>Seed value</td>
<td>Random</td>
</tr>
</tbody>
</table>
</div>
<div id="fig-flowchart_uamc" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/fig-flowchart_uamc.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.4: Flow chart of the UAMC algorithm</figcaption><p></p>
</figure>
</div>
</section>
</section>
<section id="sec-calibration_algorithms_rosenb" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="sec-calibration_algorithms_rosenb"><span class="header-section-number">4.5</span> Coupled Latin Hypercube and Rosenbrock</h2>
<section id="model-architecture-2" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="model-architecture-2"><span class="header-section-number">4.5.1</span> Model architecture</h3>
<p>The Coupled Latin Hypercube (McKay et al., 1979) and the Rosenbrock algorithm (Rosenbrock, 1960), called hereafter CLHR, generates a powerful tool for optimization of complex problems. This combined algorithm can discretize a wide domain and then narrow your search to smaller sectors (<a href="#fig-operation_clhr">Figure&nbsp;<span>4.5</span></a>). Scanning of the space of possible solutions is performed by the Latin Hypercube. This algorithm allows pseudo-statistical sampling conditioned by the previous calculated solutions. The Latin hypercube is an evolution of Monte Carlo method, with more homogeneous samples achieved with fewer samples. An important advantage of this method is that the dimension of the problem is defined by the division of the latin hypercube and not by the number of parameters.</p>
<p>The best results from samples become the starting points required for Rosenbrock algorithm. The advantage of this subroutine calculation lies in the speed to obtain near optimal values. This algorithm is based on a gradient search, adjusting axis changes based on the direction of maximum enhancement, thus reducing the number of evaluations of the objective function.</p>
<div id="fig-operation_clhr" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/fig-operation_clhr.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.5: Illustration of the operation of the CLHR algorithm</figcaption><p></p>
</figure>
</div>
<p>A general description of the steps of the CLHR method is given below:</p>
<p><em>Step 1</em></p>
<p>Generate sample: Generation and evaluation of a pseudorandom sample by a Latin hypercube within the feasible parameter space. If the size of the hypercube is greater, uncertainty is reduced within the domain of search.</p>
<p><em>Step 2</em></p>
<p>Rank points: The results obtained in the first step are ordered (<a href="#fig-operation_hypercube">Figure&nbsp;<span>4.6</span></a>). The best results from the Latin hypercube algorithm will serve as starting points to launch the Rosenbrock algorithm.</p>
<div id="fig-operation_hypercube" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/fig-operation_hypercube.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.6: Illustration of the operation of the Latin Hypercube algorithm</figcaption><p></p>
</figure>
</div>
<p><em>Step 3</em></p>
<p>Launch of Rosenbrock: Rosenbrock algorithm starts at least once. This subroutine searches around the starting point the values that improve the objective function. Depending on whether the objective function improves or worsens, the parameters values are changed to advance or backward.</p>
<p><em>Step 4</em></p>
<p>Axes change: Axes are changed to orient the Cartesian axes to the direction of maximum improvement. For applying this change of axes, it should have obtained worse results in all directions of search and at least an improvement in one of these directions (remember each direction has 2 ways).</p>
<p><em>Step 5</em></p>
<p>The best result of all Rosenbrock releases is stored.</p>
<div id="fig-operation_rosenbrock" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/fig-operation_rosenbrock.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4.7: Illustration of the operation of the Rosenbrock algorithm</figcaption><p></p>
</figure>
</div>
</section>
<section id="algorithm-parameters-2" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="algorithm-parameters-2"><span class="header-section-number">4.5.2</span> Algorithm parameters</h3>
<p>Number of tests with the latin hypercube algorithm is equal to the parameter <em>DivLH</em> (≥ 2).The <em>SEED</em> is responsible for generating the randomness of the sample.</p>
<p>The <em>RLAUNCHES</em> (<em>1≥RLAUNCHES≤DivLH</em>) best results from the Latin Hypercube algorithm are used as starting points for the Rosenbrock algorithm.</p>
<p>The <em>ALPHA</em> coefficient represents the increment in the direction of search if the objective function improves. The <em>BETA</em> coefficient represents the movement if a worse result is obtained.</p>
<p>The <em>STEPROS</em> parameter indicates the subdivisions for each parameter’s range. It is used to calculate value variations in each of the parameters (<em>∆<sub>i</sub></em>) to be studied, as presented in equation <a href="#eq-CAL2">Equation&nbsp;<span>4.2</span></a>.</p>
<p><span id="eq-CAL2"><span class="math display">\[
\frac{MaxP{arameterValue}_{i} - Min{ParameterValue}_{i}}{STEPROS} = \mathrm{\Delta}_{i}
\qquad(4.2)\]</span></span></p>
<p>The optimization finishes when the convergence criterion (defined as <em>ERR</em>) is achieved, or when the maximum number of iterations <em>MAXN</em> is attained.</p>
<div id="tbl-param_sce_clhr_algorithm" class="anchored">
<table class="table">
<caption>Table 4.4: Parameters of the CLHR algorithm</caption>
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 45%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Units</th>
<th>Description</th>
<th>Default Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>MAXN</td>
<td>-</td>
<td>Maximum number of iterations</td>
<td>2000</td>
</tr>
<tr class="even">
<td>DivLH</td>
<td>-</td>
<td>Latin hypercube division</td>
<td>50</td>
</tr>
<tr class="odd">
<td>SEED</td>
<td>-</td>
<td>Seed value</td>
<td>Random</td>
</tr>
<tr class="even">
<td>RLAUNCHES</td>
<td>-</td>
<td>Rosenbrock algorithm launches</td>
<td>2</td>
</tr>
<tr class="odd">
<td>ALPHA</td>
<td>-</td>
<td>Advance coefficient</td>
<td>3</td>
</tr>
<tr class="even">
<td>BETA</td>
<td>-</td>
<td>Backward coefficient</td>
<td>-0.5</td>
</tr>
<tr class="odd">
<td>STEPROS</td>
<td>-</td>
<td>Parameter range subdivision</td>
<td>40</td>
</tr>
<tr class="even">
<td>ERR</td>
<td>-</td>
<td>Convergence parameter</td>
<td>0.001</td>
</tr>
</tbody>
</table>
</div>



</section>
</section>
</main> <!-- /main -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./performance_indicators.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Performance indicators</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stochastic_equations.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Expert module - Stochastic equations</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->


</body></html>