[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "RS MINERVE - Technical Manual",
    "section": "",
    "text": "This is a Quarto book.\nTo learn more about Quarto books visit https://quarto.org/docs/books."
  },
  {
    "objectID": "foreword.html",
    "href": "foreword.html",
    "title": "Foreword",
    "section": "",
    "text": "The global analysis of a hydrologic-hydraulic network is essential in numerous decision-making situations such as the management or planning of water resources, the optimization of hydropower plant operations, the design and regulation of spillways or the development of appropriate flood protection concepts. RS MINERVE makes such analyses accessible to a broad public through its user-friendly interface and its valuable possibilities. In addition, thanks to its modular framework, the software can be developed and adapted to specific needs or issues.\nRS MINERVE contains different hydrological models for rainfall-runoff, such as GSM, SOCONT, SAC-SMA, GR4J, HBV and SCS. The combination of hydraulic structure models (reservoirs, turbines, spillways,…) can also reproduce complex hydropower schemes. In addition, a hydropower model computes the net height and the linear pressure losses, providing energy production values and total income based on the turbine performance and on the sale price of energy. A consumption model calculates water deficits for consumptive uses of cities, industries and/or agriculture. A structure efficiency model computes discharge losses in a structure such a canal or a pipe by considering a simple efficiency coefficient.\nThe Expert module, specifically created for research or complex studies, enables in-depth evaluation of hydrologic and hydraulic results. Time-slice simulation facilitates the analysis of large data sets without overloading the computer memory. Scenario simulation introduced the possibility of simulating multiple weather scenarios or several sets of parameters and initial conditions to study the variability and sensitivity of the model results. The automatic calibration with different algorithms, such as the SCE-UA, calculates the best set of hydrological parameters depending on a user-defined objective function.\nRS MINERVE program is freely distributed to interested users. Several projects and theses have used and are using this program for study basins in Switzerland, Spain, Peru, Brazil France and Nepal. In addition to the research center CREALP and the engineering office HydroCosmos SA, which currently develop RS MINERVE, two universities (Ecole Polytechnique Fédérale de Lausanne and Universitat Politècnica de València) collaborate to improve RS MINERVE and use it to support postgraduate courses in Civil Engineering and Environmental Sciences."
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  Introduction",
    "section": "",
    "text": "The Routing System II program was developed at the Laboratory of Hydraulic Constructions (LCH) at the Ecole Polytechnique Fédérale de Lausanne (EPFL) (Dubois and Boillat 2000; García Hernández et al. 2007).\nThe program presented hereafter, RS MINERVE, is based on the same concept than Routing System II. RS MINERVE is developed by the CREALP and HydroCosmos SA with the collaboration of the Laboratory of Hydraulic Constructions (LCH) at the Ecole Polytechnique Fédérale de Lausanne (EPFL) and the Universitat Politècnica de València (UPV)."
  },
  {
    "objectID": "intro.html#manuals-structure",
    "href": "intro.html#manuals-structure",
    "title": "1  Introduction",
    "section": "Manual’s structure",
    "text": "Manual’s structure\nThe presented Technical manual is organised in eight chapters:\n\nIntroduction\nHydrological and hydraulic models description\nPerformance indicators\nCalibration algorithms\nVisual basic scripts\nFiles formats\nDatabase formats\nGIS formats\n\nFor the RS MINERVE software utilisation, the reader can also use the RS MINERVE User’s Manual (Foehn et al. 2020).\n\n\n\n\n\nDubois, J., and J.-L. Boillat. 2000. “Routing System - Modélisation Du Routage Des Crues Dans Des Systèmes Hydrauliques à Surface Libre.” Communication 9. Laboratoire de Constructions Hydrauliques, Ecole Polytechnique Fédérale de Lausanne.\n\n\nFoehn, Alain, Javier García Hernández, Bastien Roquier, Javier Fluixá Sanmartín, Javier Paredes Arquiola, and Giovanni De Cesare. 2020. RS MINERVE - User’s Manual. Switzerland: RS MINERVE Group.\n\n\nGarcía Hernández, J., F. Jordan, J. Dubois, and J.-L. Boillat. 2007. “Routing System II. Flow Modelling in Hydraulic Systems.” Communication 32. Laboratoire de Constructions Hydrauliques, Ecole Polytechnique Fédérale de Lausanne."
  },
  {
    "objectID": "hydrological_models.html",
    "href": "hydrological_models.html",
    "title": "2  Hydrological and hydraulics models description",
    "section": "",
    "text": "This chapter presents the hydrological objects existing in RS MINERVE software."
  },
  {
    "objectID": "hydrological_models.html#list-of-objects",
    "href": "hydrological_models.html#list-of-objects",
    "title": "2  Hydrological and hydraulics models description",
    "section": "2.1 List of objects",
    "text": "2.1 List of objects\nThe parameters or required data (such as paired data) of all objects are presented hereafter. Not presented objects do not require data or require data from another object or from database.\n\nHydrology:\n\nVirtual Station (see Section 2.2)\nSnow-SD model (see Section 2.3)\nRunoff (SWMM) model (see Section 2.4)\nGSM model (see Section 2.5)\nSOCONT model (see Section 2.6)\nHBV model (see Section 2.7)\nGR4J model (see Section 2.8)\nSAC (SACRAMENTO-SOIL MOISTURE ACCOUNT) model (see Section 2.9)\nSCS (Soil Conservation Service) Unit Hydrograph model (see Section 2.10)\n\nRivers\n\nChannel routing description (see Section 2.11)\n\nStandard:\n\nJunction (object without parameters or paired data)\nTime Series (see Section 2.12)\nSource (object without parameters or paired data, but only a link to the database)\nComparator (see Section 2.21)\nSub-model (object without any parameters or paired data)\nGroup Interface (object without any parameters or paired data)\n\nStructures:\n\nReservoir (see Section 2.13)\nLevel-Discharge relation HQ (see Section 2.14)\nTurbine (see Section 2.15)\nTurbineDB (object linked to the database; see Section 2.15)\nHydropower (see Section 2.16)\nDiversion (see Section 2.17)\nConsumer (see Section 2.18)\nStructure Efficiency (see sec-model_efficiency)\n\nRegulation objects:\n\nPlanner (see Section 2.20)"
  },
  {
    "objectID": "hydrological_models.html#sec-virtual_station",
    "href": "hydrological_models.html#sec-virtual_station",
    "title": "2  Hydrological and hydraulics models description",
    "section": "2.2 Virtual Station",
    "text": "2.2 Virtual Station\nThe object “V-Station” (which is associated with the coordinates X, Y, Z) allows the spatial distribution of the meteorological variables (precipitation, temperature, ETP) from available measures or estimations of a database, with spatial reference in metric coordinates.\n\n\nTable 2.1: List of parameters and initial conditions for the virtual station\n\n\n\n\n\n\n\n\nName\nUnits\nDescription\nRegular Range\n\n\n\n\nX, Y, Z\n-\nCoordinates of the virtual station\n-\n\n\nSearch Radius\nm\nSearch radius of the virtual stations\n\n0\n\n\n\nNo. min. of stations\n-\nMinimal number of stations used for interpolation (higher priority than “Search Radius”)\n\n\n\nGradient P\n1/m\nPrecipitation gradient\n-1\n\n\nGradient T\n°C/m\nTemperature gradient\n-0.007 to -0.004\n\n\nGradient ETP\n1/m\nEvapotranspiration gradient\n-\n\n\nCoeff P\n-\nMultiplying correction coefficient\n0.5 to 2\n\n\nCoeff T\n°C\nAdding correction coefficient\n-2 to 2\n\n\nCoeff ETP\n-\nMultiplying correction coefficient\n0.5 to 2\n\n\n\n\nThe method chosen for the spatial distribution of the precipitation, the temperature and the ETP corresponds to the Thiessen and Shepard methods. The first method, Thiessen, searches the nearest meteorological station for each meteorological variable. The second one, Shepard, searches i stations being in a search radius and calculates the meteorological variable depending on inverse distance weighting.\n\n2.2.1 Thiessen interpolation\nThe evaluation of a variable in a virtual station s from n meteorological stations is obtained by searching the nearest meteorological station k of the database to the virtual point s (normally referring to the gravity centre of a sub-catchment).\nThis method has been extended to take into account the evolution of certain meteorological variables as a function of the altitude. Thus, gradients and coefficients for precipitation, potential evapotranspiration or temperature is also included in the method for obtaining the final value at virtual station s, as presented in equations Equation 2.1 to Equation 2.3.\n\\[\nP_s=CoeffP_s \\cdot \\big( 1 + GradP_s \\cdot (z_s-z_k) \\big) \\cdot P_k\n\\qquad(2.1)\\]\n\\[\nT_s=CoeffT_s + GradT_s \\cdot(z_s-z_k) + T_k\n\\qquad(2.2)\\]\n\\[\nETP_s=CoeffETP_s \\cdot\\big( 1 + GradETP_s \\cdot(z_s-z_k) \\big) \\cdot ETP_k\n\\qquad(2.3)\\]\nwith \\(P_s\\): value of the precipitation in the virtual station s [I.U.]; \\(T_s\\): value of the temperature in the virtual station s [I.U.]; \\(ETP_s\\): value of the potential evapotranspiration in the virtual station s [I.U.]; \\(P_k\\): value of the precipitation in the meteorological station k [I.U.]; \\(T_k\\): value of the temperature in the meteorological station ki [I.U.]; \\(ETP_k\\): value of the potential evapotranspiration in the meteorological station k [I.U.]; \\(CoeffP_s\\): precipitation coefficient [-]; \\(CoeffT_s\\): temperature coefficient [°C]; \\(CoeffETP_s\\): potential evapotranspiration coefficient [-];\\(GradP_s\\): precipitation gradient (\\(\\mathrm{d}P_s/\\mathrm{d}z\\)) [1/m]; \\(GradT_s\\): temperature gradient (\\(\\mathrm{d}T_s/\\mathrm{d}z\\)) [�C/m]; \\(GradETP_s\\): potential evapotranspiration gradient (\\(\\mathrm{d}ETP_s/\\mathrm{d}z\\)) [1/m]; \\(z_s\\): altitude of the virtual station s [m a.s.l.]; \\(z_k\\): position of the meteorological station k of the database [m a.s.l.].\nIn that case, the parameters Search Radius and No. min. of stations are not used, since only the nearest meteorological station is used.\n\n\n2.2.2 Shepard interpolation\nThe evaluation of a variable in a virtual station s from n meteorological stations localized at i=1,2,…,n is obtained by weighting according to the inverse square distance di,s between the meteorological station i of the database and the virtual station s.\n\\[\nd_{i,s}=\\sqrt{(x_i-x_s)^2+(y_i-y_s)^2}\n\\qquad(2.4)\\]\nwith \\(x_i\\), \\(y_i\\): position of the meteorological station i of the database [m]; \\(x_s\\), \\(y_s\\): position of the virtual station s [m]; \\(d_{i,s}\\): distance between the meteorological station i and the virtual station s [m].\nThe n meteorological stations for the spatial interpolation in the virtual station s are determined automatically respecting equation Equation 2.5. Hence, the number n of meteorological stations is variable for every pair (s, rs). Nevertheless, a minimal number of stations used for interpolation can be fixed by the user with the corresponding parameter.\n\\[\nd_{i,s} \\leq r_s\n\\qquad(2.5)\\]\nwith \\(r_s\\): search radius of meteorological stations [m].\nThe Shepard method (1968) has been also extended to take into account the evolution of the meteorological variables as a function of the altitude. Gradients and coefficients for precipitation, potential evapotranspiration or temperature are also included in the method for obtaining the final value at virtual station s, as presented in equations Equation 2.6 to Equation 2.8.\n\\[\nP_S=CoeffP_S \\cdot \\Bigg(\\frac{\\sum_{i=1}^{n} \\Big[ \\big( 1 + GradP_s \\cdot (z_s-z_i) \\big) \\cdot P_i \\cdot {\\frac {1}{d_{i,s}^2}} \\Big]}{\\sum_{i=1}^{n} \\frac{1}{{d_{i,s}}^2}} \\Bigg)\n\\qquad(2.6)\\]\n\\[\nT_S=CoeffT_S + \\Bigg(\\frac{\\sum_{i=1}^{n} \\Big[\\big(GradT_s \\cdot (z_s-z_i) + T_i\\big) \\cdot {\\frac {1}{d_{i,s}^2}} \\Big]}{\\sum_{i=1}^{n} \\frac{1}{{d_{i,s}}^2}} \\Bigg)\n\\qquad(2.7)\\]\n\\[\nETP_S=CoeffETP_S \\cdot \\Bigg(\\frac{\\sum_{i=1}^{n} \\Big[\\big( 1 + GradETP_s \\cdot (z_s-z_i) \\big) \\cdot ETP_i \\cdot {\\frac {1}{d_{i,s}^2}} \\Big]}{\\sum_{i=1}^{n} \\frac{1}{{d_{i,s}}^2}} \\Bigg)\n\\qquad(2.8)\\]\nwith \\(P_s\\): value of the precipitation in the virtual station s [I.U.]; \\(T_s\\): value of the temperature in the virtual station s [I.U.]; \\(ETP_s\\): value of the potential evapotranspiration in the virtual station s [I.U.]; \\(P_i\\): value of the precipitation in the meteorological station i [I.U.]; \\(T_i\\): value of the temperature in the meteorological station i [I.U.]; \\(ETP_i\\): value of the potential evapotranspiration in the meteorological station i [I.U.]; \\(CoeffP_s\\): precipitation coefficient [-]; \\(CoeffT_s\\): temperature coefficient [°C]; \\(CoeffETP_s\\): potential evapotranspiration coefficient [-]; \\(GradP_s\\): precipitation gradient (\\(\\mathrm{d}P_s/\\mathrm{d}z\\)) [1/m]; \\(GradT_s\\): temperature gradient (\\(\\mathrm{d}T_s/\\mathrm{d}z\\)) [�C/m]; \\(GradETP_s\\): potential evapotranspiration gradient (\\(\\mathrm{d}ETP_s/\\mathrm{d}z\\)) [1/m]; \\(z_s\\): altitude of the virtual station s [m a.s.l.]; \\(z_i\\): position of the meteorological station i of the database [m a.s.l.].\n\n\n2.2.3 Complementary calculations for the Potential Evapotranspiration (ETP)\nIf no ETP values are available in the database, RS MINERVE offers also the possibility of calculating the ETP from different methods directly at virtual station. These methods can be selected in the RS MINERVE Settings, on the Evapotranspiration frame (Figure 2.1).\n\n\n\nFigure 2.1: Selection of the ETP calculation\n\n\nThe available methods are presented hereafter in detail.\na. Turc\nThe potential evapotranspiration proposed by Turc (1955, 1961) is presented in equation Equation 2.9:\n\\[\nETP =\n  \\begin{cases}\n    CoeffETP \\cdot K \\cdot TT + 15 \\cdot (R_g+50)       & \\quad \\text{if } T>0\\\\\n    0                                                   & \\quad \\text{if } T \\leq 0\n  \\end{cases}\n\\qquad(2.9)\\]\nwith \\(ETP\\): potential evapotranspiration [mm/month]; \\(T\\): air temperature [°C]; \\(R_g\\): global radiation [cal/cm^2/day]; \\(K\\): constant [-].\nThe constant K value is:\n\\[\nK =\n  \\begin{cases}\n    0.4   & \\quad \\text{if Month } \\neq \\text{February}\\\\\n    0.37  & \\quad \\text{if Month = February}\n  \\end{cases}\n\\qquad(2.10)\\]\nRg value is a location dependent (latitude and longitude) monthly average of the global radiation.\nThe global radiation Rg is obtained in [kWh/m^2/day] from the Global horizontal radiation dataset provided by the Surface meteorological and Solar Energy (SSE) web portal, sponsored by the NASA’s Applied Science Program (http://eosweb.larc.nasa.gov/sse). This data comes as a grid (latitude and longitude) and is composed of monthly averaged values.\nRg data takes into account 22 year monthly average (July 1983 - June 2005). The latitude and the longitude values indicate the lower left corner of a 1x1 degree region. Negative values are south and west; positive values are north and east. Boundaries of the -90/-180 region are -90 to -89 (south) and -180 to -179 (west). The last region, 89/180, is bounded by 89 to 90 (north) and 179 to 180 (east). The mid-point of the region is +0.5 added to the latitude/longitude value. These data are regional averages, not point data.\nIf the user introduces decimals to the latitude/longitude values, the RS MINERVE program calculates the nearest integer value for Rg calculations.\nb. McGuinness\nMcGuinness et Bordne (McGuinness and Bordne 1972) proposes next ETP calculation:\n\\[\nETP =\n  \\begin{cases}\n    CoeffETP \\cdot K \\cdot \\frac{R_g}{\\lambda + \\rho} \\cdot \\frac {T_a + 5}{68}       & \\quad \\text{if } T>-5\\\\\n    0  & \\quad \\text{if } T \\leq -5\n  \\end{cases}\n\\qquad(2.11)\\]\nwith \\(ETP\\): potential evapotranspiration [m/d]; \\(R_g\\): global radiation [MJ/m^2/day]; \\(T_a\\): air temperature [°C]; \\(\\rho\\): water density, constant value of 1’000 [kg/m^3] ; \\(\\lambda\\): latent heat of vaporization, constant value of 2.26 [MJ/kg].\nRg value is a location dependent (latitude and longitude) monthly average of the global radiation.\nThe global radiation Rg is obtained in [kWh/m^2/day] from the Global horizontal radiation dataset provided by the Surface meteorological and Solar Energy (SSE) web portal, sponsored by the NASA’s Applied Science Program (http://eosweb.larc.nasa.gov/sse). This data comes as a grid (latitude and longitude) and is composed of monthly averaged values.\nRg data takes into account 22 year monthly average (July 1983 - June 2005). The latitude and the longitude values indicate the lower left corner of a 1x1 degree region. Negative values are south and west; positive values are north and east. Boundaries of the -90/-180 region are -90 to -89 (south) and -180 to -179 (west). The last region, 89/180, is bounded by 89 to 90 (north) and 179 to 180 (east). The mid-point of the region is +0.5 added to the latitude/longitude value. These data are regional averages; not point data.\nIf the user introduces decimals to the latitude/longitude values, the RS MINERVE program calculates the nearest integer value for Rg calculations.\nc. Oudin\nOudin (Oudin 2004) proposes following equation for the calculation of ETP:\n\\[\nETP =\n  \\begin{cases}\n    CoeffETP \\cdot K \\cdot \\frac{R_e}{\\lambda \\cdot \\rho} \\cdot \\frac {T + 5}{100}       & \\quad \\text{if } T>-5\\\\\n    0  & \\quad \\text{if } T \\leq -5\n  \\end{cases}\n\\qquad(2.12)\\]\nwith \\(ETP\\): potential evapotranspiration [m/d]; \\(R_e\\): extra-terrestrial radiation [MJ m^{-2} d^{-1}]; \\(T\\): Air temperature [°C]; \\(\\rho\\): water density, constant value of 1’000 [kg/m^3]; \\(\\lambda\\): latent heat of vaporization, constant value of 2.26 [MJ/kg].\nOudin method coefficients (5 and 100) were optimized for the hydrological modelling, on the basis of a study realized on many worldwide watersheds (Oudin 2004).\nLatitude are only necessary for obtaining Re values.\nThe extra-terrestrial radiation Re is calculated as follows: \\[\nR_e=37.6 \\cdot dr \\cdot \\big( \\omega \\cdot \\sin(\\psi) \\cdot \\sin(\\delta) + \\sin(\\omega) \\cdot \\cos(\\psi) \\cdot \\cos(\\delta)\\big)\n\\qquad(2.13)\\]\n\\[\ndr=1 + 0.033 \\cdot \\cos \\Big(\\frac {2 \\cdot \\Pi \\cdot J_d}{365} \\Big)\n\\qquad(2.14)\\]\n\\[\n\\omega=\\arccos (-\\tan(\\psi) \\cdot \\tan(\\delta))\n\\qquad(2.15)\\]\n\\[\n\\delta=0.409 \\cdot \\sin \\Big( \\frac{2 \\cdot \\Pi \\cdot J_d}{365} - 1.39\\Big)\n\\qquad(2.16)\\]\n\\[\nJ_d =\n  \\begin{cases}\n    275 \\cdot \\frac{month}{9} - 30 + Dm       & \\quad \\text{if month} <3\\\\\n    275 \\cdot \\frac{month}{9} - 31 + Dm       & \\quad \\text{if month} \\geq 3 \\text{ and leap year = true}\\\\\n    275 \\cdot \\frac{month}{9} - 32 + Dm       & \\quad \\text{if month} \\geq 3 \\text{ and leap year = false}\n  \\end{cases}\n\\qquad(2.17)\\]\nwith \\(dr\\): relative distance Sun-Earth [-]; \\(\\delta\\): solar declination [rad]; \\(J_d\\): Julian day [-]; \\(\\psi\\): latitude, negative in the south hemisphere [rad]; \\(\\omega\\): hour angle of the sun [rad]; \\(month\\): month of the year, 1 to 12 [-]; \\(Dm\\):day of the month [-].\nd. Uniform ETP\nThe user can also set a uniform ETP for the whole simulation period and for the entire basin.\n\\[\nETP=CoeffETP \\cdot X\n\\qquad(2.18)\\]\nwith \\(X\\): uniform ETP [mm/d]"
  },
  {
    "objectID": "hydrological_models.html#sec-model_snow",
    "href": "hydrological_models.html#sec-model_snow",
    "title": "2  Hydrological and hydraulics models description",
    "section": "2.3 Snow-SD model description",
    "text": "2.3 Snow-SD model description\nThe Snow-SD (Snow model with a Seasonal Degree-day factor) model (Figure 2.2), inspired by (Schaefli et al. 2005) and (Hamdi, Hingray, and Musy 2005), is composed of two sub-models. They simulate the transient evolution of the snow pack (accumulation and melt) as a function of the temperature (T) and precipitation (P) and produce an equivalent precipitation (Peq) which can be used as an input variable for the SAC-SMA or GR4J model.\n\n\n\nFigure 2.2: Snow-SD model\n\n\n\n\nTable 2.2: List of parameters and initial conditions for the Snow-SD model\n\n\n\n\n\n\n\n\nName\nUnits\nDecription\nRegular range\n\n\n\n\nS\nmm/°C/d\nReference degree-day snowmelt coefficient\n0.5 to 20\n\n\nSInt\nmm/°C/d\nDegree-day snowmelt interval\n0 to 4\n\n\nSMin\nmm/°C/d\nMinimal degree-day snowmelt coefficient\n\n\n\nSPh\nd\nPhase shift of the sinusoidal function\n1 to 365\n\n\nThetaCri\n-\nCritical relative water content of the snow pack\n0.1\n\n\nbp\nd/mm\nMelt coefficient due to liquid precipitation\n0.0125\n\n\nTcp1\n°C\nMinimum critical temperature for liquid precipitation\n0\n\n\nTcp2\n°C\nMaximum critical temperature for solid precipitation\n4\n\n\nTcf\n°C\nCritical snowmelt temperature\n0\n\n\nCFR\n-\nRefreezing coefficient\n0 to 1\n\n\nSWEIni\nm\nInitial snow water equivalent height\n-\n\n\nThetaIni\n-\nInitial relative water content in the snow pack\n-\n\n\n\n\nIn a first step, precipitation is separated into solid (Psn) and liquid precipitation (Pw) as a function of the temperature (equations Equation 2.19 to Equation 2.21):\n\\[\nP_w = \\alpha \\cdot P\n\\qquad(2.19)\\]\n\\[\nP_{sn} = (1 - \\alpha) \\cdot P\n\\qquad(2.20)\\]\n\\[\n\\alpha =\n  \\begin{cases}\n    0                                     & \\quad \\text{if } T \\leq T_{cp1}\\\\\n    (T - T_{cp1})/(T_{cp2} - T_{cp1})     & \\quad \\text{if } T_{cp1} < T < T_{cp2}\\\\\n    1                                     & \\quad \\text{if } T \\geq T_{cp2}\n  \\end{cases}\n\\qquad(2.21)\\]\nwith \\(P_w\\): liquid precipitation [L/T]; \\(\\alpha\\): separation factor; \\(P\\): precipitation [L/T]; \\(P_{sn}\\): solid precipitation [L/T]; \\(T\\): temperature [°C]; \\(T_{cp1}\\): minimum critical temperature for liquid precipitation [°C]; \\(T_{cp2}\\): maximum critical temperature for solid precipitation [°C].\nIf the observed temperature is lower than Tcp1, only solid precipitation is generated. If the temperature is higher than Tcp2, only liquid precipitation (Pw) is present. If the observed temperature is between these two critical values, both phases (liquid and solid) are produced. Solid precipitation (Psn) is used as input for the snow pack, varying its content as a function of melt or freezing. The snowmelt calculation is performed as follows, using a time-varying degree-day snowmelt coefficient with a lower bound as presented in Figure 2.3 (Griessinger et al. 2016, Magnusson et al. 2014, Slater and Clark 2005):\n\\[\nS' = max \\Big( S_{Min}\\ ;\\ S + \\ \\frac{S_{Int}}{2} \\cdot \\sin \\big( 2\\pi \\cdot \\frac{n - S_{Ph}}{365} \\big) \\Big)\n\\qquad(2.22)\\]\n\\[\nM_{sn} =\n  \\begin{cases}\n    S' \\cdot (1 + b_p \\cdot P_w) \\cdot (T - T_{cf})     & \\quad \\text{if } T > T_{cf}\\\\\n    S' \\cdot CFR \\cdot (T - T_{cf})        & \\quad \\text{if } T \\leq T_{cf}\n  \\end{cases}\n\\qquad(2.23)\\]\n\\[\n\\mathrm{d}H_{snow}/\\mathrm{d}t = P_{sn} - M_{sn}, \\quad M_{sn} \\leq P_{sn} + H_{snow}/\\mathrm{d}t, \\quad M_{sn} \\geq - W_{snow}/\\mathrm{d}t\n\\qquad(2.24)\\]\nwith \\(S'\\) (S Series in RS MINERVE): time-varying degree-day snowmelt coefficient [L/T/°C]; \\(S\\): reference degree-day snowmelt coefficient [L/T/°C]; \\(S_{Int}\\): degree-day snowmelt coefficient interval [L/T/°C]; \\(n\\): day of the year [T]; \\(S_{Min}\\): Minimal degree-day snowmelt coefficient [L/T/°C]; \\(S_{Ph}\\): Phase shift of the sinusoidal function [T]; \\(M_{sn}\\): snowmelt or freezing [L/T]; \\(b_p\\): melt coefficient due to liquid precipitation [T/L]; \\(T_{cf}\\): critical snowmelt temperature [°C]; \\(CFR\\): refreezing coefficient [-]; \\(H_{snow}\\): water content of the solid fraction of snow [L]; \\(dt\\): time step [T]; \\(W_{snow}\\): water content of the liquid fraction of snow [L].\n\n\n\nFigure 2.3: Time-varying degree-day snowmelt coefficient\n\n\nSMin allows to fix a lower limit to the S’ value. The SPh parameter defines the (horizontal) phase shift of the sinusoidal curve with respect to the first day of the year.\nThe equivalent precipitation (Peq) depends on the water content of the snow (equations Equation 2.25 to Equation 2.27):\n\\[\n\\theta = \\frac{W_{snow}}{H_{snow}}\n\\qquad(2.25)\\]\n\\[\nP_{eq} =\n  \\begin{cases}\n    P_w + W_{snow}/\\mathrm{d}t                            & \\quad \\text{if } H_{snow} = 0\\\\\n    0                                            & \\quad \\text{if } H_{snow} > 0 \\text{ and } \\theta \\leq \\theta_{cr}\\\\\n    (\\theta - \\theta_{cr}) \\cdot H_{snow}/\\mathrm{d}t     & \\quad \\text{if } H_{snow} > 0 \\text{ and } \\theta > \\theta_{cr}\n  \\end{cases}\n\\qquad(2.26)\\]\n\\[\n\\mathrm{d}W_{snow}/\\mathrm{d}t = P_w + M_{sn} - P_{eq}\n\\qquad(2.27)\\]\nwith \\(\\theta\\) (Theta in RS MINERVE): relative water content in the snow pack [-]; \\(\\theta_{cr}\\) (ThetaCri in RS MINERVE): critical relative water content in the snow pack [-]; \\(P_{eq}\\): equivalent precipitation [L/T].\nThe snow water equivalent is then the addition of Hsnow and Wsnow (equation Equation 2.28):\n\\[\nSWE = H_{snow} + W_{snow}\n\\qquad(2.28)\\]\nwith \\(SWE\\): snow water equivalent [L].\nThe variables for the initial situation associated to this model are (Theta in RS MINERVE) and SWE. The parameters to adjust are S, SInt and CFR. The parameters SPhi, bp, cr, Tcp1, Tcp2 and Tcf can be assumed as constant (bp = 0.0125, cr = 0.1, Tcp1 = 0 �C, Tcp2 = 4 �C, Tcf = 0 �C, SPhi = 80 (corresponding to March 21st for the Northern hemisphere; use 264 for Southern hemisphere corresponding to September 21)) but can be also be calibrated for some cases.\nThe refreezing coefficient CFR is similar to the one found for example in HBV (see Section 2.7) and is available for the Snow-SD model in RS MINERVE program from the version 2.8.0. By default, CFR is set to 1, recommended values from the literature are around 0.05.\nThe input variables of the model are precipitation (P) and temperature (T), the output value is the equivalent precipitation (Peq)."
  },
  {
    "objectID": "hydrological_models.html#sec-model_swmm",
    "href": "hydrological_models.html#sec-model_swmm",
    "title": "2  Hydrological and hydraulics models description",
    "section": "2.4 Runoff (SWMM) model description",
    "text": "2.4 Runoff (SWMM) model description\nThe SWMM (Storm Water Management Model) model presented hereafter was developed by Metcalf and Eddy (1971).\n\n\n\nFigure 2.4: SWMM Runoff model\n\n\n\n\nTable 2.3: List of parameters and initial conditions for the SWMM model\n\n\n\n\n\n\n\n\nName\nUnits\nDescription\nRegular Range\n\n\n\n\nA\nm2\nSurface of runoff\n\n0\n\n\n\nL\nm\nLength of the plane\n\n0\n\n\n\nJ0\n-\nRunoff slope\n\n0\n\n\n\nK\nm1/3/s\nStrickler coefficient\n0.1 to 90\n\n\nHIni\nm\nInitial water level downstream of the surface\n-\n\n\n\n\nThe transfer of the net intensity to an impermeable surface is carried out by the help of a non-linear transfer reservoir (Figure 2.4) depending on the equations Equation 2.29 to Equation 2.31:\n\\[\n\\mathrm{d}H/\\mathrm{d}t = 2 \\cdot (i_{Net} - i_{r}), \\quad H_{r} \\geq 0\n\\qquad(2.29)\\]\n\\[\ni_{r} = K \\cdot \\sqrt{J_{o}} \\cdot H^{5/3} \\cdot \\frac{1}{L}\n\\qquad(2.30)\\]\n\\[\nQ = i_{r} \\cdot A\n\\qquad(2.31)\\]\nwith \\(H\\): runoff water level downstream of the surface [L]; \\(i_{Net}\\): net intensity [L/T]; \\(i_r\\): runoff intensity [L/T]; \\(K\\): Strickler coefficient [L1/3/T]; \\(J_o\\): average slope of the plane [-]; \\(L\\): length of the plane [L]; \\(A\\): run-off surface [L2].\nThe variable for the initial condition associated to the model is Hr. The parameter to adjust is K. The other parameters (Jo, L, A) are supposed to be constant.\nThe SWMM model, supplied by a hyetograph of net rainfall (iNet), provides a hydrograph downstream of the surface (Q)."
  },
  {
    "objectID": "hydrological_models.html#sec-model_gsm",
    "href": "hydrological_models.html#sec-model_gsm",
    "title": "2  Hydrological and hydraulics models description",
    "section": "2.5 GSM model description",
    "text": "2.5 GSM model description\nThe GSM model (Figure 2.5) is composed of 5 sub-models, two corresponding to the Snow-SD model and the other three corresponding to the glacier model. The present model allows an easy construction of this kind of composition.\nFrom the inputs of precipitation (P) and temperature (T), the snow model creates an equivalent precipitation (Peq) which is transferred to the glacier model. The same accounts for the height of the snow (SWE) and the temperature (T).\nIn the glacier model the equivalent precipitation is transferred to the linear snow reservoir (Rsn) and finally to the outlet of the sub-catchment (Qsnow). Besides, the sub-model of the glacier melt creates a flow when the height of snow is zero (SWE=0). This glacier flow (PeqGL) is transferred to the linear glacier reservoir (Rgl) and the resulting flow (Qglacier) to the outlet of the sub-catchment.\nThe final flow (Qtot) produced by the sub-catchment is the addition of the two flows (Qglacier and Qsnow).\n\n\n\nFigure 2.5: GSM model\n\n\n\n\nTable 2.4: List of parameters and initial conditions for the GSM model\n\n\n\n\n\n\n\n\nName\nUnits\nDescription\nRegular Range\n\n\n\n\nA\nm2\nSurface of infiltration\n\n0\n\n\n\nS\nmm/°C/d\nReference degree-day snowmelt coefficient\n0.5 to 20\n\n\nSInt\nmm/°C/d\nDegree-day snowmelt interval\n0 to 4\n\n\nSMin\nmm/°C/d\nMinimal degree-day snowmelt coefficient\n\n\n\nSph\nd\nPhase shift of the sinusoidal function\n1 to 365\n\n\nThetaCri\n-\nCritical relative water content of the snow pack\n0.1\n\n\nbp\nd/mm\nMelt coefficient due to liquid precipitation\n0.0125\n\n\nTcp1\n°C\nMinimum critical temperature for liquid precipitation\n0\n\n\nTcp2\n°C\nMaximum critical temperature for solid precipitation\n4\n\n\nTcf\n°C\nCritical snowmelt temperature\n0\n\n\nG\nmm/°C/d\nReference degree-day glacier melt coefficient\n0.5 to 20\n\n\nGInt\nmm/°C/d\nDegree-day glacier melt interval\n0 to 4\n\n\nGMin\nmm/°C/d\nMinimal degree-day glacier melt coefficient\n\n\n\nTcg\n°C\nCritical glacier melt temperature\n0\n\n\nKgl\n1/d\nRelease coefficient of glacier melt reservoir\n0.1 to 5\n\n\nKsn\n1/d\nRelease coefficient of snowmelt reservoir\n0.1 to 5\n\n\nCFR\n-\nRefreezing coefficient\n0 to 1\n\n\nSWEIni\nm\nInitial snow water equivalent height\n-\n\n\nThetaIni\n-\nInitial relative water content in the snow pack\n-\n\n\nQsnowIni\nm3/s\nInitial outflow of linear snow reservoir\n-\n\n\nQglacierIni\nm3/s\nInitial outflow of linear glacier reservoir\n-\n\n\n\n\nIn a first step, the precipitation is divided into a solid precipitation (Psn) and into a liquid precipitation (Pw) as a function of the temperature (equations Equation 2.32 to Equation 2.34):\n\\[\nP_{w} = \\alpha \\cdot P\n\\qquad(2.32)\\]\n\\[\nP_{sn} = (1 - \\alpha) \\cdot P\n\\qquad(2.33)\\]\n\\[\n\\alpha =\n  \\begin{cases}\n    0                                     & \\quad \\text{if } T \\leq T_{cp1}\\\\\n    (T - T_{cp1})/(T_{cp2} - T_{cp1})     & \\quad \\text{if } T_{cp1} < T < T_{cp2}\\\\\n    1                                     & \\quad \\text{if } T \\geq T_{cp2}\n  \\end{cases}\n\\qquad(2.34)\\]\nwith \\(P_w\\): liquid precipitation [L/T]; \\(\\alpha\\): separation factor; \\(P\\): precipitation [L/T]; \\(P_{sn}\\): solid precipitation [L/T]; \\(T\\): te*mperature [°C]; \\(T_{cp1}\\): minimum critical temperature for liquid precipitation [°C]; \\(T_cp2\\): maximum critical temperature for solid precipitation [°C].\nIf the observed temperature is lower than Tcp1 only solid precipitation is produced. If the temperature is higher than Tcp2 only liquid precipitation (Pw) is produced. If the temperature observed is found between these two critical values liquid and solid precipitation are produced. The solid precipitation (Psn) is used as input for the snow pack, varying its content as a function of melt or freezing. The snowmelt calculation is performed as follows, using a time-varying degree-day snowmelt coefficient (Figure 2.3) (Magnusson et al. 2014, Slater and Clark 2005)\n\\[\nS^{'} = max \\bigg( S_{Min}\\ ;\\ S + \\frac{S_{Int}}{2} \\cdot \\sin \\Big( 2 \\pi \\cdot \\frac{n - S_{Ph}}{365} \\Big) \\bigg)\\\n\\qquad(2.35)\\]\n\\[\nM_{sn} =\n  \\begin{cases}\n    S' \\cdot (1 + b_p \\cdot P_w) \\cdot (T - T_{cf})    & \\quad \\text{if } T > T_{cf} \\\\\n    S' \\cdot CFR \\cdot (T - T_{cf})                    & \\quad \\text{if } T \\leq T_{cf}\n  \\end{cases}\n\\qquad(2.36)\\]\n\\[\n\\mathrm{d}H_{snow}/\\mathrm{d}t = P_{sn} - M_{sn} , \\quad M_{sn} \\leq P_{sn} + H_{snow}/\\mathrm{d}t , \\quad M_{sn} \\geq - W_{snow}/\\mathrm{d}t\n\\qquad(2.37)\\]\nwith \\(S'\\) (SSeries in RS MINERVE): time-varying degree-day snowmelt coefficient [L/T/°C]; \\(S\\): reference degree-day snowmelt coefficient [L/T/°C]; \\(S_{Int}\\): degree-day snowmelt coefficient interval [L/T/°C]; \\(n\\): day of the year [T]; \\(S_{Min}\\): Minimal degree-day snowmelt coefficient [L/T/°C]; \\(S_{Ph}\\): Phase shift of the sinusoidal function [T]; \\(M_{sn}\\): snowmelt or freezing [L/T]; \\(b_p\\): melt coefficient due to liquid precipitation [T/L]; \\(T_{cf}\\): critical snowmelt temperature [°C]; \\(CFR\\): refreezing coefficient [-]; \\(H_{snow}\\): water content of the solid fraction of snow [L]; dt: time step [T]; \\(W_{snow}\\): water content of the liquid fraction of snow [L].\nThe Sph parameter defines the phase shift of the sinusoidal curve with respect to the first day of the year.\nThe equivalent precipitation (Peq) is produced by the water content of the snow (equations Equation 2.38 to Equation 2.40):\n\\[\n\\theta = \\frac{W_{snow}}{H_{snow}}\n\\qquad(2.38)\\]\n\\[\nP_{eq} =\n  \\begin{cases}\n    P_{w} + W_{snow}/\\mathrm{d}t                          & \\quad \\text{if } H_{snow} = 0 \\\\\n    0                                                     & \\quad \\text{if } H_{snow} > 0 \\text{ and } \\theta \\leq \\theta_{cr} \\\\\n    (\\theta - \\theta_{cr}) \\cdot H_{snow}/\\mathrm{d}t     & \\quad \\text{if } H_{snow} > 0 \\text{ and } \\theta > \\theta_{cr}\n  \\end{cases}\n\\qquad(2.39)\\]\n\\[\n\\mathrm{d}W_{snow}/\\mathrm{d}t = P_w + M_{sn} - P_{eq}\n\\qquad(2.40)\\]\nwith \\(\\theta\\) (Theta in RS MINERVE): relative water content in the snow pack [-]; \\(\\theta_{cr}\\) (ThetaCri in RS MINERVE): critical relative water content in the snow pack [-]; \\(P_{eq}\\): equivalent precipitation [L/T].\nThe equivalent precipitation Peq is then transferred to the linear snow reservoir (Rsn), generating an outflow according to equations Equation 2.41 and Equation 2.42.\n\\[\n\\mathrm{d}H_{Rsn}/\\mathrm{d}t = P_{eq} - K_{sn} \\cdot H_{Rsn}\n\\qquad(2.41)\\]\n\\[\nQ_{snow} = K_{sn} \\cdot H_{Rsn} \\cdot A\n\\qquad(2.42)\\]\nwith \\(P_{eq}\\): equivalent precipitation [L/T]; \\(H_{Rsn}\\): level in linear snow reservoir [L]; \\(K_{sn}\\): release coefficient of linear snow reservoir [1/T]; \\(Q_{snow}\\): outflow of linear snow reservoir [L3/T]; \\(A\\): glacier surface [L2].\nThe snow water equivalent is then the addition of Hsnow and Wsnow (equation Equation 2.43):\n\\[\nSWE = H_{snow} + W_{snow}\n\\qquad(2.43)\\]\nwith \\(SWE\\): snow water equivalent [L].\nThe glacier melt sub-model only provides a discharge when the snow level is zero (Hsnow=0). The water intensity produced by the glacier melt (PeqGL) is transferred to the linear glacier reservoir (Rgl) and the resulting discharge (Qglacier) at the outlet of the sub-catchment.\nThe glacier melt Qglacier is defined according to equations Equation 2.44 to Equation 2.47:\n\\[\nG' = max \\bigg( G_{Min}\\ ;\\ G + \\frac{G_{Int}}{2} \\cdot \\sin \\Big( 2\\pi \\cdot \\frac{n - S_{Ph}}{365} \\Big) \\bigg)\n\\qquad(2.44)\\]\n\\[\nP_{eqGL} =\n  \\begin{cases}\n    0                          & \\quad \\text{if } T \\leq T_{cg} \\text{ or }  H_{snow} > 0 \\\\\n    G \\cdot (T - T_{cr})       & \\quad \\text{if } T > T_{cg}    \\text{ and } H_{snow} = 0\n  \\end{cases}\n\\qquad(2.45)\\]\n\\[\n\\mathrm{d}H_{Rgl}/\\mathrm{d}t = P_{eqGL} - K_{gl} \\cdot H_{Rgl}\n\\qquad(2.46)\\]\n\\[\nQ_{glacier} = K_{gl} \\cdot H_{Rgl} \\cdot A\n\\qquad(2.47)\\]\nwith \\(P_{eqGL}\\): glacier melt [L/T]; ]; \\(T_{cg}\\): critical glacier melt temperature [°C]; \\(G\\): degree-day glacier melt coefficient [L/T/°C]; \\(G_{Min}\\): Minimal degree-day glacier melt coefficient [L/T/°C]; \\(H_{Rgl}\\):level of glacier melt reservoir [L]; \\(K_{gl}\\): coefficient of linear glacier reservoir [1/T]; \\(Q_{glacier}\\): outflow of linear glacier reservoir [L3/T].\nAnd the total discharge is the addition of Qglacier and Qsnow:\n\\[\nQ = Q_{snow} + Q_{glacier}\n\\qquad(2.48)\\]\nwith \\(Q\\): total outflow [L3/T];\nThe variables for the initial situation associated to this model are (Theta in RS MINERVE), SWE, HRsn, and HRgl.\nThe parameters to adjust are S, SInt, CFR, cr, G, GInt, Kgl and Ksn. The parameters Sph, bp, cr, Tcp1, Tcp2, Tcf and Tcg can be assumed as constant (bp = 0.0125, cr = 0.1, Tcp1 = 0 �C, Tcp2 = 4 �C, Tcf = 0 �C, Tcg = 0 �C, SPh = 80 (corresponding to March 21st for the Northern hemisphere; use 264 for Southern hemisphere corresponding to September 21)). The parameter A is supposed to be constant.\nThe refreezing coefficient CFR is similar to the one found for example in HBV (see Section 2.7) and is available for the GSM model in the RS MINERVE program from its version 2.8.0. By default, CFR is set to 1, recommended values from the literature are around 0.05.\nThe input variables of the model are the precipitation (P) and the temperature (T). The output is the total discharge (Qtot) at the model outlet."
  },
  {
    "objectID": "hydrological_models.html#sec-model_socont",
    "href": "hydrological_models.html#sec-model_socont",
    "title": "2  Hydrological and hydraulics models description",
    "section": "2.6 SOCONT model description",
    "text": "2.6 SOCONT model description\nIn the SOCONT model (Figure 2.6), the Snow-SD model simulates the transient evolution of the snow pack (melt and accumulation) as a function of the temperature (T) and the precipitation (P), thus providing an equivalent precipitation (Peq) that is used as input by the GR3 model. The GR3 model also takes into account the potential evapotranspiration (ETP) and provides the net intensity to the SWMM model.\n\n\n\nFigure 2.6: SOCONT Model\n\n\n\n\nTable 2.5: List of parameters and initial conditions for the SOCONT model\n\n\n\n\n\n\n\n\nName\nUnits\nDescription\nRegular Range\n\n\n\n\nA\nm2\nSurface\n\n0\n\n\n\nS\nmm/°C/d\nReference degree-day snowmelt coefficient\n0.5 to 20\n\n\nSInt\nmm/°C/d\nDegree-day snowmelt interval\n0 to 4\n\n\nSMin\nmm/°C/d\nMinimal degree-day snowmelt coefficient\n\n\n\nSPh\nd\nPhase shift of the sinusoidal function\n1 to 365\n\n\nThetaCri\n-\nCritical relative water content of the snow pack\n0.1\n\n\nbp\nd/mm\nMelt coefficient due to liquid precipitation\n0.0125\n\n\nTcp1\n°C\nMinimum critical temperature for liquid precipitation\n0\n\n\nTcp2\n°C\nMaximum critical temperature for solid precipitation\n4\n\n\nTcf\n°C\nCritical snowmelt temperature\n0\n\n\nHGR3Max\nm\nMaximum height of infiltration reservoir\n0 to 2\n\n\nKGR3\n1/s\nRelease coefficient of infiltration reservoir\n0.00025 to 0.1\n\n\nL\nm\nLength of the plane\n\n0\n\n\n\nJ0\n-\nRunoff slope\n\n0\n\n\n\nKr\nm1/3/s\nStrickler coefficient\n0.1 to 90\n\n\nCFR\n-\nRefreezing coefficient\n0 to 1\n\n\nSWEIni\nm\nInitial snow water equivalent height\n-\n\n\nHGR3Ini\nm\nInitial level in infiltration reservoir\n-\n\n\nHrIni\nm\nInitial runoff water level downstream of the surface\n-\n\n\nThetaIni\n-\nInitial relative water content in the snow pack\n-\n\n\n\n\nIn a first step, the precipitation is divided into a solid precipitation (Psn) and into a liquid precipitation (Pw) as a function of the temperature (equations Equation 2.49 to Equation 2.51):\n\\[\nP_w = \\alpha \\cdot P\n\\qquad(2.49)\\]\n\\[\nP_{sn} = (1 - \\alpha) \\cdot P\n\\qquad(2.50)\\]\n\\[\n\\alpha =\n  \\begin{cases}\n    0                                     & \\quad \\text{if }  T \\leq T_{cp1} \\\\\n    (T - T_{cp1})/(T_{cp2} - T_{cp1})     & \\quad \\text{if }  T_{cp1} < T < T_{cp2} \\\\\n    1                                     & \\quad \\text{if }  T \\geq T_{cp2}\n  \\end{cases}\n\\qquad(2.51)\\]\nwith \\(P_w\\): liquid precipitation [L/T]; \\(\\alpha\\): separation factor; \\(P\\): precipitation [L/T]; \\(P_{sn}\\): solid precipitation [L/T]; \\(T\\): temperature [°C]; \\(T_{cp1}\\): minimum critical temperature for liquid precipitation [°C]; \\(T_{cp2}\\): maximum critical temperature for solid precipitation [°C].\nIf the observed temperature is lower than Tcp1 only solid precipitation is produced. If the temperature is higher than Tcp2 only liquid precipitation (Pw) is produced. If the temperature observed is found between these two critical values liquid and solid precipitation are produced. The solid precipitation (Psn) is used as input for the snow pack, varying its content as a function of melt or freezing. The snowmelt calculation is performed as follows, using a time-varying degree-day snowmelt coefficient (Figure 2.3) (Magnusson et al. 2014, Slater and Clark 2005):\n\\[\nS' = max\\left( S_{Min}\\ ;\\ S + \\ \\frac{S_{Int}}{2}\\sin\\left( 2\\pi\\frac{n - S_{Ph}}{365} \\right) \\right)\n\\qquad(2.52)\\]\n\\[\nM_{sn} =\n  \\begin{cases}\n    S' \\cdot (1 + b_{p} \\cdot P_{w}) \\cdot (T - T_{cf})      & \\quad \\text{if }  T > T_{cf} \\\\\n    S' \\cdot CFR \\cdot (T - T_{cf})                          & \\quad \\text{if }  T \\leq T_{cf}\n  \\end{cases}\n\\qquad(2.53)\\]\n\\[\n\\mathrm{d}H_{snow}/\\mathrm{d}t = P_{sn} - M_{sn}, \\quad M_{sn} \\leq P_{sn} + H_{snow}/\\mathrm{d}t, \\quad M_{sn} \\geq - W_{snow}/\\mathrm{d}t\n\\qquad(2.54)\\]\nwith \\(S'\\) (SSeries in RS MINERVE): time-varying degree-day snowmelt coefficient [L/T/°C]; \\(S\\): reference degree-day snowmelt coefficient [L/T/°C]; \\(S_{Int}\\): degree-day snowmelt coefficient interval [L/T/°C]; \\(n\\): day of the year [T]; \\(S_{Min}\\): Minimal degree-day snowmelt coefficient [L/T/°C]; \\(S_{Ph}\\): Phase shift of the sinusoidal function [T]; \\(M_{sn}\\): snowmelt or freezing [L/T]; \\(b_p\\): melt coefficient due to liquid precipitation [T/L]; \\(T_{cf}\\): critical snowmelt temperature [°C]; \\(CFR\\): refreezing coefficient [-]; \\(H_{snow}\\): water content of the solid fraction of snow [L]; \\(dt\\): time step [T]; \\(W_{snow}\\): water content of the liquid fraction of snow [L].\nThe SPh parameter defines the phase shift of the sinusoidal curve with respect to the first day of the year.\nThe equivalent precipitation (Peq) is produced by the water content of the snow (equations Equation 2.55 to Equation 2.57):\n\\[\n\\theta = W_{snow}/H_{snow}\n\\qquad(2.55)\\]\n\\[\nP_{eq} =\n  \\begin{cases}\n    P_{w} + W_{snow}/\\mathrm{d}t                            & \\quad \\text{if }  H_{snow} = 0 \\\\\n    0                                                       & \\quad \\text{if }  H_{snow} > 0 \\text{ and } \\theta \\leq \\theta_{cr} \\\\\n    (\\theta - \\theta_{cr}) \\cdot H_{snow}/\\mathrm{d}t       & \\quad \\text{if }  H_{snow} > 0 \\text{ and } \\theta > \\theta_{cr}\n  \\end{cases}\n\\qquad(2.56)\\]\n\\[\n\\mathrm{d}W_{snow}/\\mathrm{d}t = P_w + M_{sn} - P_{eq}\n\\qquad(2.57)\\]\nwith \\(\\theta\\) (Theta in RS MINERVE): relative water content in the snow pack [-]; \\(\\theta_{cr}\\) (ThetaCri in RS MINERVE): critical relative water content in the snow pack [-]; \\(P_{eq}\\): equivalent precipitation [L/T].\nThe snow water equivalent is then the addition of Hsnow and Wsnow (equation Equation 2.58):\n\\[\nSWE = H_{snow} + W_{snow}\n\\qquad(2.58)\\]\nwith \\(SWE\\): snow water equivalent [L].\nNext, the infiltration reservoir is computed as follows:\n\\[\ni_{Inf} =\n  \\begin{cases}\n    P_{eq} \\cdot \\big(1 - (H_{GR3}/H_{GR3Max})^{2} \\big)     & \\quad \\text{if }  H_{GR3} \\leq H_{GR3Max} \\\\\n    0                                                        & \\quad \\text{if }  H_{GR3} > H_{GR3Max}\n  \\end{cases}\n\\qquad(2.59)\\]\n\\[\nETR =\n  \\begin{cases}\n  ETP \\cdot \\sqrt{ \\frac{H_{GR3}}{H_{GR3Max}}}     & \\quad \\text{if }  H_{GR3} \\leq H_{GR3Max} \\\\\n  ETP                                              & \\quad \\text{if }  H_{GR3} > H_{GR3Max}\n  \\end{cases}\n\\qquad(2.60)\\]\n\\[\ni_{Net} = P_{eq} - i_{Inf}\n\\qquad(2.61)\\]\n\\[\nQ =\n  \\begin{cases}\n    Q = K_{GR3} \\cdot H_{GR3} \\cdot A           & \\quad \\text{if }  H_{GR3} \\leq H_{GR3Max} \\\\\n    Q = K_{GR3} \\cdot H_{GR3Max} \\cdot A        & \\quad \\text{if }  H_{GR3} > H_{GR3Max}\n  \\end{cases}\n\\qquad(2.62)\\]\n\\[\n\\mathrm{d}H_{GR3}/\\mathrm{d}t = i_{Inf} - ETR - \\frac{Q}{A}\n\\qquad(2.63)\\]\nwith \\(ETP\\): potential evapotranspiration [L/T]; \\(i_{Inf}\\): infiltration intensity [L/T]; \\(P_{eq}\\): equivalent precipitation [L/T]; \\(H\\): level in infiltration reservoir [L]; \\(H_{GR3Max}\\): capacity of infiltration reservoir [L]; \\(ETR\\): real evapotranspiration [L/T]; \\(Q\\): base discharge [L3/T]; \\(K_{GR3}\\): release coefficient of infiltration reservoir [1/T]; \\(A\\): surface [L2]; \\(i_{Net}\\): net intensity [L/T].\nThe transfer of the net intensity to an impermeable surface is carried out by the help of a non-linear transfer reservoir depending on the equations Equation 2.64 to Equation 2.66:\n\\[\n\\mathrm{d}H_{r}/\\mathrm{d}t = 2 \\cdot (i_{Net} - i_{r}), \\quad H_{r} \\geq 0\n\\qquad(2.64)\\]\n\\[\ni_{r} = K_{r} \\cdot \\sqrt{J_{o}} \\cdot {H_{r}}^{\\frac{5}{3}} \\cdot \\frac{1}{L}\n\\qquad(2.65)\\]\n\\[\nQ = i_{r} \\cdot A\n\\qquad(2.66)\\]\nwith \\(H_r\\): runoff water level downstream of the surface [L]; \\(i_{Net}\\): net intensity [L/T]; \\(i_r\\): runoff intensity [L/T]; \\(K_r\\): Strickler coefficient [L1/3/T]; \\(J_o\\): average slope of the plane [-]; \\(L\\): length of the plane [L].\nThe variables for the initial situation associated to this model are (Theta* in RS MINERVE), SWE, HGR3 and Hr. The parameters to adjust are S, SInt, bp, CFR, cr, KGR3, HGR3Max and Kr. The parameters SPhi, bp, cr, Tcp1, Tcp2 and Tcf can be assumed as constant (bp = 0.0125, \\thetacr = 0.1, Tcp1 = 0 �C, Tcp2 = 4 �C, Tcf = 0 �C, SPhi = 80 (corresponding to March 21st for the Northern hemisphere; use 264 for Southern hemisphere corresponding to September 21)). The other parameters (Jo, L, A) are supposed to be constant.\nThe refreezing coefficient CFR is similar to the one found for example in HBV (see Section 2.7) and is available for the SOCONT model in the RS MINERVE program from its version 2.8.0. By default, CFR is set to 1; recommended values from the literature are around 0.05.\nThe input variables of the model are the precipitation (P), the temperature (T) and the potential evapotranspiration (ETP). The output value is the equivalent precipitation (Peq).\nThe outflow discharge Qtot, composed by the base discharge (QGR3) and the run-off discharge (Qr), is finally transferred to the outlet of the sub-catchment."
  },
  {
    "objectID": "hydrological_models.html#sec-model_hbv",
    "href": "hydrological_models.html#sec-model_hbv",
    "title": "2  Hydrological and hydraulics models description",
    "section": "2.7 HBV model description",
    "text": "2.7 HBV model description\nThe integrated rainfall-runoff model HBV (Bergström, 1976, 1992) is composed of a snow function, a humidity reservoir and two (upper and lower) soil storage reservoirs. The structure of the implemented model is presented in Figure 2.7.\n\n\n\nFigure 2.7: HBV Model\n\n\n\n\nTable 2.6: List of parameters and initial conditions for the HBV model\n\n\n\n\n\n\n\n\nName\nUnits\nDescription\nRegular Range\n\n\n\n\nA\nm2\nSurface of the basin\n\n0\n\n\n\nCFMax\nmm/°C/d\nMelting factor\n0.5 to 20\n\n\nCFR\n-\nRefreezing factor\n0.05\n\n\nCWH\n-\nCritical relative water content of the snow pack\n0.1\n\n\nTT\n°C\nThreshold temperature of rain/snow\n0 to 3\n\n\nTTInt\n°C\nTemperature interval for rain/snow mixing\n0 to 3\n\n\nTTSM\n°C\nThreshold temperature for snow melt\n0\n\n\nBeta\n-\nModel parameter (shape coefficient)\n1 to 5\n\n\nFC\nm\nMaximum soil storage capacity\n0.050 to 0.65\n\n\nPWP\n-\nSoil permanent wilting point threshold\n0.030 to 1\n\n\nSUMax\nm\nUpper reservoir water level threshold\n0 to 0.10\n\n\nKr\n1/d\nNear surface flow storage coefficient\n0.05 to 0.5\n\n\nKu\n1/d\nInterflow storage coefficient\n0.01 to 0.4\n\n\nKl\n1/d\nBaseflow storage coefficient\n0 to 0.15\n\n\nKperc\n1/d\nPercolation storage coefficient\n0 to 0.8\n\n\nSWEIni\nm\nInitial snow water equivalent height\n-\n\n\nWHIni\n-\nInitial relative water content in the snow pack\n-\n\n\nHumIni\nm\nInitial humidity\n-\n\n\nSUIni\nm\nInitial upper reservoir water level\n-\n\n\nSLIni\nm\nInitial lower reservoir water level\n-\n\n\n\n\nThe precipitation is first divided into snowfall (SF) and rainfall (RF) as a function of the temperature (equations Equation 2.106 to Equation 2.108). If the observed temperature is lower than TT-TTInt/2, only solid snowfall is produced. If the temperature is higher than TT+TTInt/2, only rainfall is produced. If the observed temperature is found between these values, both rainfall and snowfall are produced.\n\\[\nRF = \\alpha \\cdot P\n\\qquad(2.67)\\]\n\\[\nSF = (1 - \\alpha) \\cdot P\n\\qquad(2.68)\\]\n\\[\n\\alpha =\n  \\begin{cases}\n    0                                    & \\quad \\text{if } T < TT - TTInt/2 \\\\\n    \\frac{T - (TT - TTInt/2)}{TTInt}     & \\quad \\text{if } TT - TTInt/2 < T < TT + TTInt/2 \\\\\n    1                                    & \\quad \\text{if } T > TT + TTInt/2\n  \\end{cases}\n\\qquad(2.69)\\]\nwith \\(RF\\): rainfall [L/T]; \\(\\alpha\\): separation factor; \\(P\\): precipitation [L/T]; \\(SF\\): snowfall [L/T]; \\(T\\): temperature [°C]; \\(TT\\): threshold temperature for rain/snow [°C]; \\(TTInt\\): temperature interval for rain/snow mixing [°C].\nThe snowfall (SF) is used as input for the snow pack, varying its content as a function of melt or freezing. The snowmelt calculation is performed as follows:\n\\[\nM_{sn} =\n  \\begin{cases}\n    CFMax \\cdot (T - TTSM)               & \\quad \\text{if } T > TTSM \\\\\n    CFR \\cdot CFMax \\cdot (T - TTSM)     & \\quad \\text{if } T \\leq TTSM\n  \\end{cases}\n\\qquad(2.70)\\]\n\\[\n\\mathrm{d}H_{snow}/\\mathrm{d}t = SF - M_{sn} , \\quad M_{sn} \\leq SF + H_{snow}/\\mathrm{d}t, \\quad M_{sn} \\geq - W_{snow}/\\mathrm{d}t\n\\qquad(2.71)\\]\nwith \\(M_{sn}\\): snowmelt or freezing [L/T]; \\(CFMax\\): degree-day melting factor [L/T/°C]; \\(CFR\\): refreezing factor [-]; \\(TTSM\\): critical snowmelt temperature [°C]; \\(H_{snow}\\): snow height [L]; \\(W_{snow}\\): water content [L]; \\(dt\\): time step [T].\nThe equivalent precipitation (Peq) is produced by the water content of the snow (equations Equation 2.72 to Equation 2.74):\n\\[\nWH = W_{snow}/H_{snow}\n\\qquad(2.72)\\]\n\\[\nP_{eq} =\n  \\begin{cases}\n    RF + W_{snow}/\\mathrm{d}t                      & \\quad \\text{if } H_{snow} = 0 \\\\\n    0                                     & \\quad \\text{if } H_{snow} > 0 \\text { and } WH \\leq CWH \\\\\n    (\\ WH - \\ CWH) \\cdot H_{snow}/\\mathrm{d}t      & \\quad \\text{if } H_{snow} > 0 \\text { and } WH > CWH\n  \\end{cases}\n\\qquad(2.73)\\]\n\\[\n\\mathrm{d}W_{snow}/\\mathrm{d}t = RF + M_{sn} - P_{eq}\n\\qquad(2.74)\\]\nwith \\(WH\\): relative water content in the snow pack [-]; \\(CWH\\): critical relative water content in the snow pack [-]; \\(P_{eq}\\): equivalent precipitation [L/T].\nThe snow water equivalent is then the addition of Hsnow and Wsnow (equation Equation 2.75):\n\\[\nSWE = H_{snow} + W_{snow}\n\\qquad(2.75)\\]\nwith \\(SWE\\): snow water equivalent [L].\nThe calculation of the recharge is carried out depending on a model parameter Beta, as presented in equation Equation 2.115. ETR is calculated as shown in equation Equation 2.116. Finally, the humidity of the soil (Hum) is performed taking into account the input (Equivalent precipitation, Peq) and outputs (Recharge intensity and ETR) as presented in equation Equation 2.117. Additionally, and based on Seibert (1997), parameter PWP is a rate related to parameter FC. Thus, the height of the soil permanent wilting point threshold is calculated multiplying PWP by FC.\n\\[\ni_{Recharge} = \\Bigg( \\frac{Hum}{FC} \\Bigg)^{Beta} \\cdot P_{eq}\n\\qquad(2.76)\\]\n\\[\nETR =\n  \\begin{cases}\n    ETP \\cdot \\frac{Hum}{(PWP \\cdot FC)}      & \\quad \\text{if } Hum < (PWP \\cdot FC) \\\\\n    ETP                                       & \\quad \\text{if } Hum \\geq (PWP \\cdot FC)\n  \\end{cases}\n\\qquad(2.77)\\]\n\\[\n\\frac{dHum}{dt} = (P_{eq} - i_{Recharge}) - ETR, \\quad Hum \\geq 0\n\\qquad(2.78)\\]\nwith \\(i_{Recharge}\\): Reservoir recharge intensity [L/T] ; \\(Hum\\): Humidity [L]; \\(FC\\): Maximum soil storage capacity [L] ; \\(Beta\\): Model parameter (shape coefficient) [-]; \\(P_{eq}\\): Equivalent precipitation [L/T]; \\(ETR\\): Evapotranspiration [L/T] ; \\(ETP\\): Potential evapotranspiration [L/T] ; \\(PWP\\): Soil permanent wilting point threshold [-].\nThen, near surface (or run-off) flow is calculated depending on the water level in the Upper reservoir (SU) and its threshold, as well as on a flow storage coefficient Kr.\n\\[\nQ_r =\n  \\begin{cases}\n    K_{r} \\cdot (SU - SU_{Max}) \\cdot A       & \\quad \\text{if } SU > SU_{Max} \\\\\n    0                                         & \\quad \\text{if } SU \\leq SU_{Max}\n  \\end{cases}\n\\qquad(2.79)\\]\nwith \\(Q_r\\): Near surface flow (or run-off flow) [L3/T]; \\(K_r\\): Near surface flow storage coefficient [1/T]; \\(SU\\): Upper reservoir water level [L]; \\(SU_{Max}\\): Upper reservoir water level threshold [L]; \\(A\\): Basin surface [L2].\nThe Upper reservoir (or interflow reservoir), corresponding to the upper soil storage and producing the interflow, is computed as follows:\n\\[\n\\frac{dSU}{dt} = i_{Recharge} - (K_{perc} + K_{u}) \\cdot SU - \\frac {Q_{r}}{A} , \\quad SU \\geq 0 \\\\\n\\qquad(2.80)\\]\n\\[\ni_{Perc} = K_{perc} \\cdot SU\n\\qquad(2.81)\\]\n\\[\nQ_{u} = K_{u} \\cdot SU \\cdot A\n\\qquad(2.82)\\]\nwith \\(K_{perc}\\): Percolation storage coefficient [1/T] ; \\(K_u\\): Interflow storage coefficient [1/T] ; \\(i_{Perc}\\): Percolation intensity [L/T] ; \\(Q_u\\): Interflow [L3/T].\nAfterwards, the lower reservoir (or baseflow reservoir), corresponding to the lower soil storage, is calculated as presented in equations Equation 2.83 and Equation 2.84.\n\\[\n\\mathrm{d}SL/\\mathrm{d}t = i_{Perc} - K_{l} \\cdot SL , \\quad SL \\geq 0\n\\qquad(2.83)\\]\n\\[\nQ_{l} = K_{l} \\cdot SL \\cdot A\n\\qquad(2.84)\\]\nwith \\(SL\\): Lower reservoir water level [L]; \\(K_l\\): Baseflow storage coefficient [1/T]; \\(Q_l\\): Baseflow [L3/T].\nAnd finally the total outflow is:\n\\[\nQ_{tot} = Q_{r} + Q_{u} + Q_{l}\n\\qquad(2.85)\\]\nwith \\(Q_{tot}\\): Total outflow [L3/T].\nThe initial conditions associated to this model are SWEIni, WHIni, HumIni, SUIni and SLIni. The parameters to adjust are CFMax, CFR, CWH, TT, TTInt, TTSM, Beta, FC, PWP, SUmax, Kr, Ku, Kl and Kperc. The parameter A is supposed to be constant.\nThe model inputs are the precipitation (P), the temperature (T) and the potential evapotranspiration (ETP). The output is the total discharge at the model outlet (Qtot)."
  },
  {
    "objectID": "hydrological_models.html#sec-model_gr4j",
    "href": "hydrological_models.html#sec-model_gr4j",
    "title": "2  Hydrological and hydraulics models description",
    "section": "2.8 GR4J model description",
    "text": "2.8 GR4J model description\nThe GR4J model is a global hydrological model with four parameters developed by Perrin et al. (2003). It is an empirical model (Figure 2.8), but its structure is similar to the conceptual models. It takes into account the humidity and contains two reservoirs (production and routing). Unit hydrographs are also associated for the hydrological behaviour of the basin.\n\n\n\nFigure 2.8: GR4J Model\n\n\n\n\nTable 2.7: List of parameters and initial conditions for the GR4J model\n\n\n\n\n\n\n\n\nName\nUnits\nDescription\nRegular Range\n\n\n\n\nA\nm2\nSurface of the basin\n\n0\n\n\n\nX1\nm\nCapacity of production store\n0.01 to 1.2\n\n\nX2\nm\nWater exchange coefficient\n-0.005 to 0.003\n\n\nX3\nm\nCapacity of routing store\n0.01 to 0.5\n\n\nX4\nd\nUH time base\n-0.5 to 1\n\n\nSIni\nm\nInitial water content in the production reservoir\n-\n\n\nRIni\nm\nInitial water level in the routing reservoir\n-\n\n\n\n\nThe first calculation is the neutralization of Peq by ETP for determining a net intensity (Pn) and a net evapotranspiration (En) according to equations Equation 2.86 and Equation 2.87.\n\\[\nP_n =\n  \\begin{cases}\n    P_{eq} - ETP       & \\quad \\text{if } P \\geq ETP \\\\\n    0                  & \\quad \\text{if } P < ETP\n  \\end{cases}\n\\qquad(2.86)\\]\n\\[\nE_n =\n  \\begin{cases}\n    0                  & \\quad \\text{if } P \\geq ETP \\\\\n    ETP - P_{eq}       & \\quad \\text{if } P < ETP\n  \\end{cases}\n\\qquad(2.87)\\]\nwith \\(P_n\\): net rain intensity [L/T] ; \\(P_{eq}\\) : Equivalent precipitation [L/T] ; ETP: potential evapotranspiration [L/T] ; \\(E_n\\): net evapotranspiration [L/T].\nWhen Pn is not zero, a part (Ps) of Pn feed the production reservoir (S) as presented in equation Equation 2.88. Similarly, when En is not zero, an evapotranspiration (Es) from the production reservoir is calculated depending on the water level in the production reservoir as described in equation Equation 2.89.\n\\[\nP_s = \\frac{\\mathrm{d}}{\\mathrm{d} t} \\frac {X1 \\cdot \\bigg( 1-{( \\frac{S}{X1})}^{2} \\bigg) \\cdot tanh \\Big( \\frac{P_n \\cdot dt}{X1} \\Big)}{1 + \\frac{S}{X1} \\cdot tanh\\Big( \\frac{P_n \\cdot dt}{X1} \\Big)}\n\\qquad(2.88)\\]\n\\[\nE_s = \\frac{\\mathrm{d}}{\\mathrm{d} t} \\frac {S \\cdot  \\bigg( 2- \\frac{S}{X1} \\bigg) \\cdot tanh \\Big( \\frac{E_n \\cdot dt}{X1} \\Big)}{1 + \\Big( 1 - \\frac{S}{X1} \\Big) \\cdot tanh\\Big( \\frac{E_n \\cdot dt}{X1} \\Big)}\n\\qquad(2.89)\\]\nwith \\(P_s\\): rain intensity feeding the production reservoir [L/T]; \\(X1\\): maximum capacity of production reservoir \\(S\\) [L] ; \\(S\\) : water content in the production reservoir [L]; \\(E_s\\) : evapotranspiration from the production reservoir [L/T].\nThe percolation (iPerc) flowing from the production reservoir is then calculated as follows:\n\\[\ni_{Perc} = \\frac {\\mathrm{d}}{\\mathrm{d} t} \\big( S + (P_s - E_s) \\cdot dt \\big) \\cdot \\Bigg( 1 - \\bigg( 1 + \\Big( \\frac{4}{9} \\cdot \\frac{ S + (P_s - E_s) \\cdot dt}{X1} \\Big)^{4} \\bigg)^{- \\frac{1}{4}} \\Bigg)\n\\qquad(2.90)\\]\nwith \\(i_{Perc}\\): percolation intensity [L/T].\nFinally, the variation in the production reservoir S is obtained according to equation Equation 2.91:\n\\[\n\\frac {\\mathrm{d} S}{\\mathrm{d} t} = P_s - E_s - i_{Perc} , \\quad S \\geq 0\n\\qquad(2.91)\\]\nThe quantity of water (iPr) which goes to the routing reservoir is provided by:\n\\[\ni_{Pr} = i_{Perc} + (P_n - P_s)\n\\qquad(2.92)\\]\nwith \\(i_{Pr}\\) : intensity flowing to the routing reservoir [L/T].\nAfterwards, for the calculation of unit hydrographs, iPr is divided in two flow components: 90% are routed by a unit hydrograph UH1 and a routing reservoir and 10% by a symmetrical unit hydrograph UH2. UH1 and UH2 depend on parameter X4, which is the base time.\nThe ordinates of the hydrographs are calculated from curves SH1 and SH2, which correspond to the cumulated hydrograph. SH1 and SH2 are defined depending on the time step t as presented in equation Equation 2.93 and Equation 2.94. The ordinates of UH1 and UH2 are then calculated.\n\\[\nSH1_{t} =\n  \\begin{cases}\n    0                                              & \\quad \\text{if } t \\leq 0 \\\\\n    \\bigg( \\frac{t}{X4} \\bigg)^{\\frac{5}{2}}       & \\quad \\text{if } 0 < t < X4 \\\\\n    1                                              & \\quad \\text{if } t \\geq X4\n  \\end{cases}\n\\qquad(2.93)\\]\n\\[\nSH2_{t} =\n  \\begin{cases}\n    0                                                                      & \\quad \\text{if } t \\leq 0 \\\\\n    \\frac{1}{2} \\cdot \\bigg( \\frac{t}{X4} \\bigg)^{\\frac{5}{2}}             & \\quad \\text{if } 0 < t < X4 \\\\\n    1 - \\frac{1}{2} \\cdot \\bigg( 2 - \\frac{t}{X4} \\bigg)^{\\frac{5}{2}}     & \\quad \\text{if } X4 < t < 2 \\cdot X4 \\\\\n    1                                                                      & \\quad \\text{if } t \\geq 2 \\cdot X4 \\\\\n  \\end{cases}\n\\qquad(2.94)\\]\n\\[\nUH1_{j} = SH1_{j} - SH1_{j - 1}\n\\qquad(2.95)\\]\n\\[\nUH2_{j} = SH2_{j} - SH2_{j - 1}\n\\qquad(2.96)\\]\nwith \\(SH1\\): hydrograph 1 from \\(S\\) [-]; \\(SH2\\): hydrograph 2 from \\(S\\) [-]; \\(t\\): time step [T]; \\(X4\\): base time [T]; \\(UH1\\): hydrograph from SH1 [-]; \\(UH2\\): hydrograph from \\(SH2\\) [-].\nThen, at each time step k, outflows Q9 and Q1 from the two hydrographs correspond to the convolution of previous intensities according to the repartition provided by the discretized hydrograph and calculated as presented in equations Equation 2.97 and Equation 2.98.\n\\[\nQ9 = 0.9 \\cdot \\sum_{j = 1}^{l} ( UH1_{j} \\cdot {i_{Pr}}_{k - j - l})\n\\qquad(2.97)\\]\n\\[\nQ1 = 0.1 \\cdot \\sum_{j = 1}^{m} ( UH2_{j} \\cdot {i_{Pr}}_{k - j - l})\n\\qquad(2.98)\\]\nwith \\(Q9\\): Unitary flow from the UH1 hydrograph; [L/T]; \\(Q1\\): Unitary flow from the UH2 hydrograph [L/T]; \\(j\\): day (integer) [T]; \\(l\\): integer value of \\(X4 + 1\\) [T] ; \\(m\\): integer value of \\(2 \\cdot X4+1\\) [T].\nThen, an exchange function (iF) with the non-atmospheric outside produces an underground water exchange according to equation Equation 2.99 (physical interpretation of this function is not direct). Then, the routing reservoir (R) is emptied by a routing discharge (Qr’) as described in equation Equation 2.100.\n\\[\ni_F = \\frac{\\mathrm{d}}{\\mathrm{d} t}X2 \\cdot \\bigg( \\frac{R}{X3} \\bigg)^{\\frac{7}{2}}\n\\qquad(2.99)\\]\n\\[\nQ_{r'} = \\frac{\\mathrm{d}}{\\mathrm{d} t} \\big( R + (Q9 + iF) \\cdot dt \\big) \\cdot \\Bigg( 1 - \\bigg( 1 + \\Big( \\frac{R + (Q9 + iF) \\cdot dt}{X3} \\Big)^{4} \\bigg)^{- \\frac{1}{4}} \\Bigg)\n\\qquad(2.100)\\]\nwith \\(i_F\\): exchange function [L/T] ; \\(X2\\): water exchange coefficient, positive for contributions, negative for losses due to infiltration or zero when no exchange is produced [L]; \\(R\\): water level in the routing reservoir [L] ; \\(X3\\): one day capacity of routing reservoir [L]; \\(Q_{r'}\\): unitary routing reservoir outflow [L/T].\nThe variation of the water level in the routing reservoir is:\n\\[\n\\mathrm{d}R/\\mathrm{d}t = Q9 - i_F - Q_{r'} , \\quad R \\geq 0\n\\qquad(2.101)\\]\nThe outflow Q1 from hydrograph UH2 has also the same exchange for providing the complementary flow Qd’:\n\\[\nQ_{d'} = Q1 + i_F\n\\qquad(2.102)\\]\nwith \\(Q_{d'}\\): unitary complementary outflow [L/T].\nFinally, the model outflows are calculated as presented in equations Equation 2.103 and Equation 2.104 and the total flow at the outlet, Qtot, as presented in equation Equation 2.105:\n\\[\nQ_r = Q_{r'} \\cdot A\n\\qquad(2.103)\\]\n\\[\nQ_d = Q_{d'} \\cdot A\n\\qquad(2.104)\\]\n\\[\nQ_{tot} = Q_r + Q_d\n\\qquad(2.105)\\]\nwith \\(Q_r\\): outflow from the routing reservoir [L3/T]; \\(A\\): Basin surface [L2]; \\(Q_d\\): complementary outflow [L3/T]; \\(Q_{tot}\\): total outflow [L3/T].\nThe variables associated to this model are SIni and RIni. The parameters to adjust are X1, X2, X3 and X4. The parameter A is supposed to be constant.\nThe model inputs are the equivalent precipitation (Peq) and the potential evapotranspiration (ETP). The output is the total discharge at the model outlet (Qtot)."
  },
  {
    "objectID": "hydrological_models.html#sec-model_sac_sma",
    "href": "hydrological_models.html#sec-model_sac_sma",
    "title": "2  Hydrological and hydraulics models description",
    "section": "2.9 SAC-SMA model description",
    "text": "2.9 SAC-SMA model description\nThe SAC-SMA (Figure 2.9) or SACRAMENTO hydrological model was developed in the 70’s (Burnash et al., 1973; Burnash, 1995) to optimize humidity characteristics into the soil, distributed into different level, with rational percolation characteristics, for an efficient simulation of discharges. This model calculates the total discharge from the precipitation (P) and the potential evapotranspiration (ETP) depending on the parameters and initial conditions presented in Table 2.8.\n\n\n\nFigure 2.9: SAC-SMA Model\n\n\n\n\nTable 2.8: List of parameters and initial conditions for the SAC-SMA model\n\n\n\n\n\n\n\n\nName\nUnits\nDescription\nRegular Range\n\n\n\n\nA\nm2\nSurface of the basin\n\n0\n\n\n\nAdimp\n-\nMaximum fraction of an additional impervious area due to saturation\n0 to 0.2\n\n\nPctim\n-\nPermanent impervious area fraction\n0 to 0.05\n\n\nRiva\n-\nRiparian vegetarian area fraction\n0 to 0.2\n\n\nUztwMax\nm\nUpper Zone Tension Water capacity\n0.01 to 0.15\n\n\nUzfwMax\nm\nUpper Zone Free Water capacity\n0.005 to 0.10\n\n\nUzk\n1/d\nInterflow depletion rate from the Upper Zone Free Water storage\n0.10 to 0.75\n\n\nZperc\n-\nRatio of maximum and minimum percolation rates\n10 to 350\n\n\nRexp\n-\nShape parameter of the percolation curve\n1 to 4\n\n\nPfree\n-\nPercolation fraction that goes directly to the Lower Zone Free Water storages\n0 to0.6\n\n\nLztwMax\nm\nThe Lower Zone Tension Water capacity\n0.05 to 0.40\n\n\nLzfpMax\nm\nThe Lower Zone primary Free Water capacity\n0.03 to 0.80\n\n\nLzfsMax\nm\nThe Lower Zone supplementary Free Water capacity\n0.01 to 0.40\n\n\nRserv\n-\nFraction of Lower Zone Free Water not transferable to Lower Zone Tension Water\n0 to 1\n\n\nLzpk\n1/d\nDepletion rate of the Lower Zone primary Free Water storage\n0.001 to 0.03\n\n\nLzsk\n1/d\nDepletion rate of the Lower Zone supplemental Free Water storage\n0.02 to 0.3\n\n\nSide\n-\nRatio of deep percolation from Lower Zone Free Water storages\n0 to 0.5\n\n\nAdimIni\nm\nInitial Tension Water content of the Adimp area\n-\n\n\nUztwIni\nm\nInitial Upper Zone Tension Water content\n-\n\n\nUzfwIni\nm\nInitial Upper Zone Free Water content\n-\n\n\nLztwIni\nm\nInitial Lower Zone Tension Water content\n-\n\n\nLzfpIni\nm\nInitial Lower Zone Free supplementary content\n-\n\n\nLzfsIni\nm\nInitial Lower Zone Free primary content\n-\n\n\n\n\nWhen considering rainfall over a basin, two basic basin areas are taken into account:\n\nAn impervious portion of the soil mantle covered by streams, lake surfaces, marshes and other impervious material directly linked to the streamflow network. This area produces impervious and direct runoff QDirectRunoff from any rainfall.\nA pervious portion of the soil mantle which distributes rainwater to the next storages. In addition, the pervious area can produce runoff when rainfall rates are sufficiently heavy.\n\nThe basin may present permanent or temporarily impervious areas, determined by:\n\nThe permanent impervious area fraction (Pctim).\nThe maximum fraction of an additional impervious area due to saturation (Adimp). It represents the maximum portion of reservoirs and temporary watersheds contained in the basin.\n\nThus, the permanent pervious area fraction of the basin is calculated following equation Equation 2.106.\n\\[\nP_{area} = 1 - (P_{ctim} + A_{dimp})\n\\qquad(2.106)\\]\nwith \\(P_{area}\\): permanent pervious area fraction of the basin [-] ; \\(P_{ctim}\\): permanent impervious area fraction [-] ; \\(A_{dimp}\\): maximum fraction of an additional impervious area due to saturation [-].\nIt is worth mentioning that the behaviour of the additional impervious area might be purely pervious, purely impervious or mixed, depending on the storage of the permanent pervious and impervious areas. The pervious capacity (or fraction) of this area will decrease as the rainfall grows.\nAs shown in Figure 2.9, the SAC model divides the soil in 2 zones:\n\nAn Upper Zone, sub-divided in two areas that receive the infiltrated water from rainfall.\nA Lower Zone, sub-divided in 3 reservoirs, where the input is the percolation from the Upper Zone.\n\nThe main components of the model and their flow transfers are described below.\nUpper Zone Tension Water storage\nThis storage represents the water bound by adhesion and cohesion in between the soil pores as well as the water intercepted by vegetation. The water can be only consumed by evapotranspiration.\nThe water that reaches this reservoir comes from the rain felt into the pervious area of the basin, but also from transfers from the Upper Zone Free Water storage.\nThe following concepts are defined for this reservoir:\n\nThe Upper Zone Tension Water Maximum capacity (UztwMax) is the maximum Tension Water storage admissible in the Upper Zone.\nThe Upper Zone Tension Water Content (UztwC) is the Tension Water stored in this Upper Zone at any given time.\n\nIf the relative content of Tension Water (ratio between its content and its maximum storage) is smaller than the relative content of Free Water, a transfer is produced from the Free Water storage to the Tension Water storage. The expressions of these ratios and the infiltration transfer are shown in equations Equation 2.107 to Equation 2.109:\n\\[\nT = \\frac{UztwC}{Uztw_{Max}}\n\\qquad(2.107)\\]\n\\[\nF = \\frac{UzfwC}{Uzfw_{Max}}\n\\qquad(2.108)\\]\n\\[\nUztr =\n  \\begin{cases}\n    \\mathrm{d} \\bigg( \\frac{UzfwC \\cdot Uztw_{Max} - UztwC \\cdot Uzfw_{Max}}{Uzfw_{Max} + Uztw_{Max}} \\bigg) / \\mathrm{d}t      & \\quad \\text{if } T < F \\\\\n    0                                                                                                                           & \\quad \\text{if } T \\geq F\n  \\end{cases}\n\\qquad(2.109)\\]\nwith \\(T\\): relative content of Upper Zone Tension Water [-]; \\(F\\): relative content of Upper Zone Free Water [-]; \\(Uztr\\): infiltration transfer from the Free Water storage to the Tension Water storage [L/T]; \\(UztwC\\): the Upper Zone Tension Water storage [L]; \\(Uztw_{Max}\\): the Upper Zone Tension Water capacity [L]; \\(UzfwC\\): the Upper Zone Free Water storage [L]; \\(Uzfw_{Max}\\): the Upper Zone Free Water capacity [L].\nAlthough free water is present during filling of Upper Zone Tension Water (by infiltration), this free water is rapidly transformed into Upper Zone Tension Water until tension water relative content requirements are satisfied.2\nIn addition, when the Upper Zone Tension Water volume has been filled, excess moisture above the Upper Zone Tension Water capacity is accumulated in the Upper Zone Free Water.\nUpper Zone Free Water storage\nThis storage represents the water not attached to the soil particles and free to move under gravitational forces. The water that reaches this reservoir comes from the infiltration of the Upper Zone Tension Water storage\nThe following concepts are defined:\n\nThe Upper Zone Free Water Maximum capacity (UzfwMax) is the maximum Free Water storage admissible in the Upper Zone.\nThe Upper Zone Free Water Content (UzfwC) is the Free Water stored in the Upper Zone at any given time.\nThe Interflow depletion rate (Uzk) represents the portion of the Upper Zone Free Water that is transferred outside as interflow.\n\nThe water may be depleted by evapotranspiration, percolation to the Lower Zone or horizontal flow (surface runoff and interflow).\nOn the one hand, the percolation to the Lower Zone is computed prior to the interflow computation as it is its preferred path. It depends on the deficiency of the Lower Zone moisture volumes, on the soil properties, and on the water relative storage in this reservoir. The first 2 factors define the percolation demand from the Lower Zone (DDA). This demand represents the percolation in case of total percolation availability on the Upper Zone Free Water storage.\n\\[\nP_{Base} = Lzfp_{Max} \\cdot Lzpk + Lzfs_{Max} \\cdot Lzsk\n\\qquad(2.110)\\]\n\\[\nDEFR = \\frac{(Lztw_{Max} - LztwC) + (Lzfp_{Max} - LzfpC) + (Lzfs_{Max} - LzfsC)}{Lztw_{Max} + Lzfp_{Max} + Lzfs_{Max}}\n\\qquad(2.111)\\]\n\\[\nDDA = P_{Base} \\cdot (1 + Zperc \\cdot {DEFR}^{Rexp})\n\\qquad(2.112)\\]\nwith \\(P_{Base}\\): the continuing percolation rate under saturated condition (maximal percolation) [L/T]; \\(DDA\\): Lower Zone maximum percolation demand [L/T]; \\(Zperc\\): ratio of maximum and minimum percolation rates [-]; \\(DEFR\\): relative Lower Zone water deficiency [-]; \\(Rexp\\): shape parameter of the percolation curve [-].\nThe effective percolation depends on the percolation demand and the ratio between the Upper Zone Free Water content and the Upper Zone Free Water capacity as shown in equation Equation 2.113. In addition, the effective percolation is limited by the humidity content in the Upper Zone and also by the deficiency in the Lower Zone (equations Equation 2.114 and Equation 2.115 respectively):\n\\[\nPERC = DDA \\cdot \\frac{UzfwC}{Uzfw_{Max}}\n\\qquad(2.113)\\]\n\\[\nPERC \\leq \\mathrm{d}(UzfwC)/\\mathrm{d}t\n\\qquad(2.114)\\]\n\\[\nPERC \\leq \\mathrm{d} \\Big( (Lztw_{Max} - LztwC) + (Lzfp_{Max} - LzfpC) + (Lzfs_{Max} - LzfsC) \\Big) / \\mathrm{d}t\n\\qquad(2.115)\\]\nwith \\(PERC\\): real percolation [L/T]; \\(DDA\\): Lower Zone maximum percolation demand [L/T]; \\(UzfwC\\): Upper Zone Free Water content [L]; \\(Uzfw_{Max}\\): Upper Zone Free Water capacity [L].\nOn the other hand, the interflow occurs only when the rate of precipitation exceed the rate at which downward motion can occur from the Upper Zone Free Water. It depends on the water content and on its interflow depletion rate Uzk, as shown in equation Equation 2.116:\n\\[\nQ_{interflow} = Uzk \\cdot UzfwC \\cdot P_area \\cdot A\n\\qquad(2.116)\\]\nwith \\(Q_{interflow}\\): interflow [L3/T]; \\(Uzk\\): interflow depletion rate from the Upper Zone Free water storage [T-1]; \\(UzfwC\\): Upper Zone Free Water content [L]; \\(P_{area}\\): pervious area fraction of the basin [-]; \\(A\\): surface of the basin [L2].\nMoreover, when the Upper Zone Free Water storage is completely full and the precipitation intensity exceeds both the percolation rate and the maximum interflow drainage capacity, the excess precipitation results in surface runoff QSurfRunoff.\nLower Zone Tension Water storage\nThis storage represents the semi-saturated zone. It characterizes the volume of moisture in the lower soils which will be claimed by dry soil particles when moisture from a wetting front reaches that depth. The water is consumed through evapotranspiration, proportionally to the remaining ETP of the Upper Zone Tension Water storage.\nThe water reaching this reservoir comes from the Upper Zone percolation. One fraction (Pfree) of this percolation goes directly to the Free Water storages, even if the Tension Water storage is not yet full, and the other fraction (1-Pfree) goes to the Tension Water storage of the Lower Zone 3. The water also reaches this storage from transfers between the other Lower Zone Free Water storages.\nThe following concepts are defined:\n\nThe Lower Zone Tension Water Maximum capacity (LztwMax) is the maximum Tension Water storage admissible in the Lower Zone.\nThe Lower Zone Tension Water Content (LztwC) is the Tension Water stored in the Lower Zone at any given time.\n\nIf the relative content of Tension Water (ratio between its content and its maximum storage) is smaller than the relative content of Free Water, the incoming excess is transferred from Free Water to Tension Water. The expressions of both ratios are shown in equations Equation 2.117 to Equation 2.119:\n\\[\nRFW = Rserv \\cdot (LzfpMax + Lzfs_{Max})\n\\qquad(2.117)\\]\n\\[\nT = \\frac{LztwC}{Lztw_{Max}}\n\\qquad(2.118)\\]\n\\[\nF = \\frac{LzfpC + LzfsC - RFW}{Lzfp_{Max} + Lzfs_{Max} - RFW}\n\\qquad(2.119)\\]\nwith \\(T\\): relative content of Lower Zone Tension Water [-]; \\(F\\): relative content of Lower Zone Free Water [-]; \\(RFW\\): Lower Zone Free Water not transferable to Lower Zone Tension Water, susceptible to become baseflow [L]; \\(Rserv\\): fraction of Lower Zone Free Water not transferable to Lower Zone Tension Water[-].\nIf the relative content of the Lower Zone Tension Water is smaller than the relative fullness of the global Lower Zone, a water transfer DEL occurs from the Lower Zone Free Supplementary reservoir to the Lower Zone Tension Water reservoir, as described by the following equations:\n\\[\nR = \\frac{LzfpC + LzfsC + LztwC - RFW}{Lzfp_{Max} + Lzfs_{Max} + Lztw_{Max} - RFW}\n\\qquad(2.120)\\]\n\\[\nDEL = Lztw_{Max} \\cdot \\mathrm{d}(R - T)/\\mathrm{d}t\n\\qquad(2.121)\\]\nwith \\(DEL\\): the Free-Tension Water transfer in the Lower Zone [L/T]; \\(R\\): ratio between the available water for evapotranspiration and the total water content, in the whole Lower Zone [-]; \\(RFW\\): Lower Zone Free Water not transferable to Lower Zone Tension Water, susceptible to become baseflow [L].\nLower Zone Primary and Supplementary Free Water storages\nThis storage represents the saturated zone of the subsoil, i.e. the aquifer. There are two types of Lower Zone Free Water: a primary type with a very slow draining providing baseflow over long periods of time, and a supplementary type which supplements the baseflow after a period of relatively recent rainfall.\nThe water that reaches these storages comes from the Pfree fraction of the percolation of the Upper Zone Free Water. This fraction is distributed into the primary and supplementary storages according to their deficiency of water.\nThe following concepts are defined:\n\nThe Lower Zone primary Free Water Maximum capacity (LzfpMax) is the maximum primary water storage admissible in the Lower Zone.\nThe Lower Zone primary Free Water Content (LzfpC) is the primary Free Water stored in the Lower Zone at any given time.\nThe Depletion rate of the Lower Zone primary Free Water storage (Lzpk) is the portion of primary Free Water that drains as baseflow per day.\nThe Lower Zone supplementary Free Water Maximum capacity (LzfsMax) is the maximum supplementary water storage admissible in the Lower Zone.\nThe Lower Zone supplementary Free Water Content (LzfsC) is the supplementary Free Water stored in the Lower Zone at any given time.\nThe Depletion rate of the Lower Zone supplementary Free Water storage (Lzsk) is the portion of supplementary Free Water that drains as baseflow per day.\n\nThe drained water leaving these two storages (primary flow Qprimary and supplementary flow Qsupplementary) follows the Darcy’s law and forms the baseflow of the Lower Zone Q~Lower Zone~ as shown in equations Equation 2.122 to Equation 2.124:\n\\[\nQ_{primary} = Lzpk \\cdot LzfpC \\cdot P_area \\cdot A\n\\qquad(2.122)\\]\n\\[\nQ_{supplementary} = Lzsk \\cdot LzfsC \\cdot P_area \\cdot A\n\\qquad(2.123)\\]\n\\[\nQ_{Lower\\ Zone} = Q_{primary} + Q_{supplementary}\n\\qquad(2.124)\\]\nwith \\(Q_{primary}\\): primary baseflow [L3/T]; \\(Q_{supplementary}\\): supplementary baseflow [L3/T]; \\(Q_{Lower\\ Zone}\\): total baseflow produced in the Lower Zone [L3/T]; \\(Lzpk\\): depletion rate of the Lower Zone primary Free Water storage [T-1]; \\(LzfpC\\): Lower Zone primary Free Water Content [L]; \\(Lzsk\\): depletion rate of the Lower Zone supplementary Free Water storage [T-1]; \\(LzfsC\\): Lower Zone supplementary Free Water Content [L]; \\(P_area\\): pervious area fraction of the basin [-]; \\(A\\): surface of the basin [L2].\nThe model allows including baseflow losses, called subsurface flow QSubSurf, due to the existence of geological faults, fractured rocks, etc. that lead to filtrations throughout the aquifer. The Side parameter captures these losses as shown in equation Equation 2.125:\n\\[\nQ_{SubSurf} = Side \\cdot Q_{baseflow}\n\\qquad(2.125)\\]\nwith \\(Side\\): ratio of deep percolation from Lower Zone Free Water storages [-], \\(Q_{baseflow}\\): Lower Zone Free Water volume actually integrated to the channel outflow hydrographs [L3/T]; \\(Q_{SubSurf}\\): discharge lost into the aquifer [L3/T].\nAnd so this Side parameter is used to correct the baseflow as follows:\n\\[\nQ_{baseflow} = \\frac{Q_{Lower\\ Zone}}{1 + Side}\n\\qquad(2.126)\\]\n\\[\nQ_{SubSurf} = Side \\cdot \\frac{Q_{Lower\\ Zone}}{1 + Side}\n\\qquad(2.127)\\]\nEvapotranspiration\nThe real evapotranspirations are obtained from each Tension Water storage, from the transfers between Free Water and Tension Water storages, from riverside vegetation and from impervious areas. They are described hereafter.\n\nETR1: evapotranspiration from the Upper Zone Tension Water reservoir. If this reservoir is not full, the evapotranspiration is proportional to its content (equation Equation 2.128):\n\n\\[\nETR1 = ETP \\cdot \\frac{UztwC}{Uztw_{Max}} \\leq UztwC\n\\qquad(2.128)\\]\nwith \\(ETP\\): potential evapotranspiration [L/T].\nThe remaining evapotranspiration demand RED and the updated content of water in the Upper Zone Tension Water reservoir UztwC are then calculated:\n\\[\nRED = ETP - ETR1\n\\qquad(2.129)\\]\n\\[\n\\mathrm{d}(UztwC)/\\mathrm{d}t = - ETR1\n\\qquad(2.130)\\]\n\nETR2: evapotranspiration from the Upper Zone Free Water reservoir. This evapotranspiration is equal to the remaining RED left by the Tension Water reservoir, but it is limited by the Upper Zone Free Water content UzfwC:\n\n\\[\nETR2 = min \\big( RED ; \\mathrm{d}(UzfwC)/\\mathrm{d}t \\big)\n\\qquad(2.131)\\]\nThen, the remaining evapotranspiration REDLz from the Lower Zone is:\n\\[\nREDLz = RED - ETR2\n\\qquad(2.132)\\]\nThe variation of the water content UzfwC in the Upper Zone Free Water reservoir is defined as follows:\n\\[\n\\mathrm{d}(UzfwC)/\\mathrm{d}t = - ETR2\n\\qquad(2.133)\\]\n\nETR3: evapotranspiration from the Lower Zone Tension Water reservoir. The evapotranspiration availability corresponds to the remaining evapotranspiration demand in the Lower Zone. Evapotranspiration in this reservoir is proportional to the remaining evapotranspiration and to the Lower Zone Tension Water content, and inversely proportional to the Tension Water reservoirs’ capacity of the Upper Zone and the Lower Zone:\n\n\\[\nETR3 = REDLz \\cdot \\frac{LztwC}{Uztw_{Max} + Lztw_{Max}} \\leq \\mathrm{d}(LztwC)/\\mathrm{d}t\n\\qquad(2.134)\\]\n\nETR4: evapotranspiration from the basin covered by riverside vegetation. Riverside vegetation absorbs the deficiency of potential evapotranspiration from the Upper Zone and the Lower Zone:\n\n\\[\nETR4 = ETP - ETR1 - ETR2 - ETR3\n\\qquad(2.135)\\]\n\nETR5: evapotranspiration from the impervious fraction of the basin.\n\n\\[\nETR5 = ETR1 + (RED + ETR2) \\cdot \\frac{AdimC - UztwC - V_{ETR1}}{Uztw_{Max} + Lztw_{Max}}\n\\qquad(2.136)\\]\n\\[\nV_{ETR1} = \\int_{t1}^{t2}{ETR1 \\cdot \\mathrm{d}t}\n\\qquad(2.137)\\]\nwith \\(AdimC\\): sum of the Upper Zone and Lower Zone Tension Water Content in the Adimp area [-]; \\(V_{ETR1}\\): evapotranspirated water from the Upper Zone Tension Water reservoir in a time step [L].\nEach evapotranspiration value is weighted based on the portion of the basin area in which it is produced. The total evapotranspiration is finally:\n\\[\nETRtotal = \\Big( (ETR1 + ETR2 + ETR3) \\cdot P_area + ETR4 \\cdot Riva + ETR5 \\cdot A_dimp \\Big) \\cdot A\n\\qquad(2.138)\\]\nwith \\(ETRtotal\\): total evapotranspiration [L3/T]; \\(P_area\\): pervious area fraction of the basin [-]; \\(Riva\\): riparian vegetarian area fraction [-]; \\(Pctim\\): permanent impervious area fraction of the basin [-]; \\(A_dimp\\): maximum fraction of an additional impervious area due to saturation [-]; \\(A\\): surface of the basin [L2].\nA more detailed guide about the SAC-SMA equations can be found on the following National Weather Service link: http://www.nws.noaa.gov/iao/iao_SAC_SMA.php"
  },
  {
    "objectID": "hydrological_models.html#sec-model_scs",
    "href": "hydrological_models.html#sec-model_scs",
    "title": "2  Hydrological and hydraulics models description",
    "section": "2.10 SCS (Soil Conservation Service) model description",
    "text": "2.10 SCS (Soil Conservation Service) model description\nThe Soil Conservation Service (SCS) model is a popular method developed in the early 70’s (SCS, 1972) for assessing an event runoff volume and peak rate of discharge using limited input data (precipitation). It is especially applicable for small watersheds.\nThe SCS model only requires precipitation as input, which provides the effective precipitation considered after the initial abstraction. The hydrograph computation is by default based on the dimensionless unit hydrograph (Figure 2.10) resulting from a 1 cm of excess rainfall. This unit hydrograph (UH) has 37.5% of the total runoff volume before the peak discharge (T/Tp=1) and the remaining 62.5% volume after. The shape of the default UH can be tailored in RS MINERVE.\nTo use the SCS UH, one needs to determine only two things: time to peak Tp; and peak discharge Qp.\nThe total hydrograph from the rainfall event will be the addition of each hydrograph resulting from each excess rainfall, scaled by the rainfall magnitude.\n\n\n\nFigure 2.10: Curvilinear and triangular dimensionless unit hydrographs\n\n\n\n\nTable 2.9: List of parameters and initial conditions for the SCS model\n\n\n\n\n\n\n\n\nName\nUnits\nDescription\nRegular Range\n\n\n\n\nA\nm2\nSurface of the basin\n\n0\n\n\n\nCN\n-\nCurve Number\n30 to 100\n\n\nL\nm\nWidth of the plane\n\n\n\nJ0\n-\nRunoff slope\n\n\n\nIa\nmm\nInitial abstraction\n0 to 100000\n\n\nTI\ns\nLag time\n\n\n\n\n\nFirst, according to the SCS-CN method, we define the rainfall excess (Qe, in m) as:\n\\[\nQ_{e} = \\frac{(P - Ia)^{2}}{P - Ia + \\lambda} \\text{ for } P > 0.2 \\lambda , \\text{ else } Q_{e} = 0\n\\qquad(2.139)\\]\nInitial abstraction (Ia, in m) is all losses before runoff begins. It includes water retained in surface depressions, water intercepted by vegetation, evaporation, and infiltration. If not specified, Ia will be derived from the Curve Number following equation Equation 2.140.\n\\[\nI_{a} = 0.2 \\cdot \\lambda\n\\qquad(2.140)\\]\nwith \\(\\lambda\\): potential maximum retention after runoff begins [m], given by equation Equation 2.141:\n\\[\n\\lambda = \\bigg( \\frac{25400}{CN} - 254 \\bigg) \\cdot \\frac{1}{1000}\n\\qquad(2.141)\\]\nwith \\(CN\\): curve number [-].\nThe UH can be solved using a simplified form of ‘triangular’ unit hydrograph. Assuming that this triangular unit hydrograph has the same 37.5% of volume on the rising side as the dimensionless UH of Figure 2.10, we can solve for the Tb, which contains entire 100% volume of runoff:\n\\[\nT_{b} = \\frac{1}{0.375} \\cdot T_{p} = 2.67 \\cdot T_{p}\n\\qquad(2.142)\\]\nTp (in h) and Qp (in m3/s per unit excess rainfall) can then be derived from the triangular UH. By considering two triangles, we can write the total volume (Q) under the hydrograph:\n\\[\nQ = \\frac{Q_{p} \\cdot T_{p}}{2} + \\frac{Q_{p} \\cdot (T_{b} - T_{p})}{2} = \\frac{Q_{p}}{2} \\cdot 2.67 \\cdot T_{p}\n\\qquad(2.143)\\]\nSince the area under the UH is equivalent to 1 cm, we have (for 1 cm rainfall depth, with A in m2):\n\\[\n\\frac{q_{p}}{2} \\cdot 2.67T_{p} \\cdot 3600 = \\frac{A}{100}\n\\qquad(2.144)\\]\n\\[\nq_{p} = \\frac{2A}{100 \\cdot 3600 \\cdot 2.67T_{p}} = \\frac{2A}{3600 \\cdot 2.67 \\cdot T_{p}} \\text { per m excess rainfall}\n\\qquad(2.145)\\]\nFrom the scheme in Figure 2.10, we have the time-of-peak:\n\\[\nT_{p} = \\frac{T_{r}}{2} + T_{l}\n\\qquad(2.146)\\]\nwith \\(T_r\\) (in h) being the duration of the unit excess rainfall and \\(T_l\\) (in h) the time between the center of mass of excess rainfall and the peak of the UH. In RS MINERVE we numerically apply the UH to each precipitation time interval, therefore Tr is equal to the computation time-step dT in the code. If the lag time parameter (Tl) is not provided, SCS defines it as:\n\\[\nT_{l} = 0.6 \\cdot T_{c}\n\\qquad(2.147)\\]\nwith \\(T_c\\): the time of concentration defined in SI (in h), as:\n\\[\nT_{c} = \\frac{227 \\cdot L^{0.8}(\\lambda + 1)^{0.7}}{10^{5} \\sqrt{J0}}\n\\qquad(2.148)\\]\nwith \\(L\\): the width of plane parameter; \\(J0\\): the runoff slope parameter.\nIf Tl is provided, Tc is simply computed from equation Equation 2.147. We can thus compute Tp as:\n\\[\nT_{p} = \\frac{dT}{2} + 0.6 \\cdot T_{c}\n\\qquad(2.149)\\]\nAnd the resulting flow Qp becomes (with Qe the excess rainfall during the time interval dT):\n\\[\nQ_p = q_p \\cdot Q_e = \\frac {2.08 \\cdot 10^{-4} \\cdot A}{T_p} \\cdot Q_e\n\\qquad(2.150)\\]"
  },
  {
    "objectID": "hydrological_models.html#sec-model_channel_routing",
    "href": "hydrological_models.html#sec-model_channel_routing",
    "title": "2  Hydrological and hydraulics models description",
    "section": "2.11 Channel routing description",
    "text": "2.11 Channel routing description\nThe channel routing can be solved by the St-Venant, Muskingum-Cunge or Kinematic wave. The three possibilities are presented hereafter and their parameters in Table 2.10.\n\n\nTable 2.10: List of parameters and initial conditions for the channel routing model\n\n\n\n\n\n\n\n\nName\nUnits\nDescription\nRegular Range\n\n\n\n\nL\nm\nLength\n\n0\n\n\n\nB0\nm\nWidth of the channel base\n\n0\n\n\n\nm\n-\nSide bank relation coefficient (1H/mV)\n0.1 to 1\n\n\nJ0\n-\nSlope\n\n0\n\n\n\nK\nm1/3/s\nStrickler coefficient\n10 to 90\n\n\nN\n-\nNumber of sections (not for Lag-Time)\n\n0\n\n\n\nLag\nmin\nLag time (only for Lag-Time)\n\n\n\nQIni\nm3/s\nInitial discharge\n-\n\n\n\n\n\n2.11.1 St. Venant routing\nThe St. Venant equations solving the 1D unsteady flow are:\n\\[\n\\frac{\\partial A}{\\partial t} + \\frac{\\partial Q}{\\partial x} = 0\n\\qquad(2.151)\\]\n\\[\n\\frac{\\partial Q}{\\partial t} + \\frac{\\partial}{\\partial x} \\bigg( \\frac{Q^{2}}{A} + g \\cdot I_{1} \\bigg) = g \\cdot A \\cdot \\big( J_{0} - J_{f} \\big) + g \\cdot I_{2}\n\\qquad(2.152)\\]\nwith \\(A\\): cross sectional flow area [L2]; \\(Q\\): discharge [L3/T]; \\(J_0\\): bottom slope; \\(J_f\\): friction slope [-]; \\(I_1\\): profile coefficient [L3]; \\(I_2\\): coefficient for cross sectional variation [L2].\nEquation Equation 2.151 expresses the mass conservation while equation Equation 2.152 ensures the conservation of momentum. The term I1 takes into account the shape of the transversal profile and is calculated as follows:\n\\[\nI_{1} = \\int_{0}^{h}{(h - \\eta) \\cdot b(\\eta})\\ \\mathrm{d}\\eta\n\\qquad(2.153)\\]\nThe term b represents the cross-sectional variation for the level and constitutes an integration variable according to Figure 2.11. St. Venant equations can be solved in RS MINERVE for a trapezoidal profile (Figure 2.12).\n::: {#fig-channel_routing_st_venant layout-ncol=2}\n\n\n\nFigure 2.11: Descriptive sketch for parameters used in the calculation of I1\n\n\n\n\n\nFigure 2.12: Transversal profile available for the computation of channel routing\n\n\n::: Sections of the Channel routing model\nFor this trapezoidal section, the equation defining I1 is reduced to:\n\\[\nI_1 = \\frac {B \\cdot h^2}{2} + \\frac {m \\cdot h^3}{3}\n\\qquad(2.154)\\]\nwith \\(B\\): width of the base of the transversal profile [L]; \\(h\\): water level [L]; \\(m\\): side bank relation coefficient (1 vertical / m horizontal) [-].\nThe friction slope Jf is calculated according to Manning-Strickler:\n\\[\nJ_f = \\frac{Q \\cdot |Q|}{A^{2} \\cdot K^{2} \\cdot {R_{h}}^{\\frac{4}{3}}}\n\\qquad(2.155)\\]\n\\[\nR_h = \\frac{A}{L_p}\n\\qquad(2.156)\\]\nwith \\(J_f\\): friction slope [-]; \\(K\\): Strickler coefficient [L1/3/T]; \\(R_h\\): hydraulic radius [L]; \\(A\\): flow area [L2]; \\(L_p\\): wetted perimeter [L].\nThe term I2 takes into account the variation of the section along the channel. In the case of a prismatic channel I2 is equal to zero. In general, I2 is:\n\\[\nI_2 = \\int_{0}^{h}{(h - \\eta) \\ {\\frac{\\partial b}{\\partial x}} |_{h = \\eta}}\n\\qquad(2.157)\\]\nFor a prismatic channel, equations Equation 2.151 and Equation 2.152 are solved by the Euler method (first order) as follows:\n\\[\n{A_{j + 1}}^{n + 1} = {A_{j + 1}}^{n} - \\frac{\\Delta t}{\\Delta x}({Q_{j + 1}}^{n} - {Q_{j}}^{n})\n\\qquad(2.158)\\]\n\\[\n  {Q_{j + 1}}^{n + 1} = {Q_{j + 1}}^{n} - \\frac{\\Delta t}{\\Delta x}(\\frac{({Q_{j + 1}}^{n})^{2}}{{A_{j + 1}}^{n}} - \\frac{({Q_{j}}^{n})^{2}}{{A_{j}}^{n}} + g \\cdot {I_{1,j + 1}}^{n} - g \\cdot {I_{1,j}}^{n}) + \\Delta t \\cdot g \\cdot \\frac{({A_{j}}^{n} + {A_{j + 1}}^{n})}{2} \\cdot J_{0} - \\Delta t \\cdot g \\cdot {A_{j + 1}}^{n} \\cdot {{J_{f}}_{j + 1}}^{n}\n\\qquad(2.159)\\]\nwith \\(j\\) and \\(j+1\\) representing the spatial position; \\(n\\) and \\(n+1\\) representing the time increment; \\(g\\): gravity constant [L2/T]; \\(\\Delta x\\): longitudinal increment [L].\nThe downstream boundary condition used by RS MINERVE is the normal flow depth.\nIn practice, according to the physical situation to be simulated, some terms of the complete dynamic equations can be eliminated in order to get simplified expressions without losing precision. Applicable solutions are the diffusive and kinematic waves which are presented in the following.\n\n\n2.11.2 Muskingum-Cunge routing\nRuling out the first two terms of equation Equation 2.152 yields:\n\\[\n\\frac{\\partial I_{1}}{\\partial x} = A \\cdot \\left( J_{0} - J_{f} \\right) + I_{2}\n\\qquad(2.160)\\]\nThis new equation corresponds to the approximation of the diffusive wave. With the supplementary hypothesis of a prismatic channel (Cunge, 1991) it is possible to express equation Equation 2.152 as follows:\n\\[\n\\frac{\\partial Q}{\\partial t} + \\bigg( \\frac{Q}{BD}\\frac{\\mathrm{d}D}{\\mathrm{d}h} \\bigg) \\cdot \\frac{\\partial Q}{\\partial x} - \\frac{D^{2}}{2 \\cdot B \\cdot |Q|} \\cdot \\frac{\\partial^{2}Q}{\\partial x^{2}} = 0\n\\qquad(2.161)\\]\nwith \\(B\\): width of the bottom of the transversal profile [L]; \\(D\\): discharge rate [L3/T].\nThe discharge rate is the capacity of a cross section of a channel to transport a certain flow and is defined as:\n\\[\nQ = D \\cdot {J_{0}}^{\\frac{1}{2}}\n\\qquad(2.162)\\]\nEquation Equation 2.161 is an equation with partial derivatives of parabolic type which represents the convection and the diffusion of the variable Q. Hence, the flow transported with a velocity c (equation Equation 2.163) and diffused with a diffusion coefficient (equation Equation 2.164):\n\\[\nc = \\frac{Q}{B \\cdot D} \\cdot \\frac{\\mathrm{d}D}{\\mathrm{d}h}\n\\qquad(2.163)\\]\n\\[\n\\delta = \\frac{D^{2}}{2B \\cdot |Q|}\n\\qquad(2.164)\\]\nBased on the hypothesis of a clearly defined relation between the flow Q and the water level h, equation Equation 2.161 is reduced to:\n\\[\n\\frac{\\partial Q}{\\partial t} + \\bigg( \\frac{\\mathrm{d}Q}{\\mathrm{d}A} \\bigg)_{x_{0}} \\cdot \\frac{\\partial Q}{\\partial x} = 0\n\\qquad(2.165)\\]\nThis equation is called “equation of the kinematic wave” and describes the simple convection of the flow with a velocity c according to equation Equation 2.163. It can be solved by the following numerical finite difference scheme:\n\\[\n\\frac{\\partial Q}{\\partial t} \\approx \\frac{X \\cdot \\big( {Q_{j}}^{n + 1} - {Q_{j}}^{n} \\big) + (1 + X) \\cdot \\big( {Q_{j + 1}}^{n + 1} - {Q_{j + 1}}^{n} \\big)}{\\Delta t}\n\\qquad(2.166)\\]\n\\[\n\\frac{\\partial Q}{\\partial x} \\approx \\frac{\\frac{1}{2} \\cdot \\big( {Q_{j + 1}}^{n + 1} - {Q_{j}}^{n + 1} \\big) + \\frac{1}{2} \\cdot \\big( {Q_{j + 1}}^{n} - {Q_{j}}^{n} \\big)}{\\Delta x}\n\\qquad(2.167)\\]\nApplying this scheme to equation Equation 2.165 yields:\n\\[\n\\frac{X \\cdot \\big( {Q_{j}}^{n + 1} - {Q_{j}}^{n} \\big) + (1 + X) \\cdot \\big( {Q_{j + 1}}^{n + 1} - {Q_{j + 1}}^{n} \\big)}{c \\cdot \\Delta t} + \\frac{\\frac{1}{2} \\cdot \\big( {Q_{j + 1}}^{n + 1} - {Q_{j}}^{n + 1} \\big) + \\frac{1}{2} \\cdot \\big( {Q_{j + 1}}^{n} - {Q_{j}}^{n} \\big)}{\\Delta x} = 0\n\\qquad(2.168)\\]\nWe can express the solution of this equation as a function of the unknown variable Qj+1n+1 namely:\n\\[\n{Q_{j + 1}}^{n + 1} = C_1 \\cdot {Q_{j}}^{n + 1} + C_2 \\cdot {Q_{j}}^{n} + C_3 \\cdot {Q_{j + 1}}^{n}\n\\qquad(2.169)\\]\nwith:\n\\[\n\\begin{matrix}\n  C_1 = - \\frac{K \\cdot X - \\frac{\\Delta t}{2}}{K \\cdot (1 - X) + \\frac{\\Delta t}{2}} \\\\\n  C_2 = \\frac{K \\cdot X + \\frac{\\Delta t}{2}}{K \\cdot (1 - X) + \\frac{\\Delta t}{2}} \\\\\n  C_3 = \\frac{K \\cdot (1 - X) - \\frac{\\Delta t}{2}}{K \\cdot (1 - X) + \\frac{\\Delta t}{2}} \\\\\n\\end{matrix}\n\\qquad(2.170)\\]\n\\[\nK = \\frac{\\Delta x}{c}\n\\qquad(2.171)\\]\n\\[\nc = \\frac{{Q_{j + 1}}^{n} - {Q_{j}}^{n}}{{A_{j + 1}}^{n} - {A_{j}}^{n}}\n\\qquad(2.172)\\]\nHere, hydraulic engineers might recognize the equation of Muskingum (Boillat, 1980) corresponding to the name of the river localized in the United States where the method was employed for the first time. The Muskingum method represents an approximation by finite differences of the equation for the kinematic wave. This is not only an appearance since developing the terms of equation Equation 2.168 in terms of a Taylor series around the point (j, n) assuming x/t = c and neglecting the quadratic terms (x^2) the equation can be written as follows:\n\\[\n\\frac{\\partial Q}{\\partial t} + c \\cdot \\frac{\\partial Q}{\\partial x} - c \\cdot B\\frac{\\partial^{2}Q}{\\partial x^{2}} = 0\n\\qquad(2.173)\\]\n\\[\nB = \\Delta x \\cdot \\bigg( \\frac{1}{2} - X \\bigg)\n\\qquad(2.174)\\]\nAccording to this analysis proposed by Cunge (1969) it can be recognized that the Muskingum equation is a solution in terms of finite differences of the equation of the diffusive wave (Equation 2.161) under the condition of correctly introducing the value of the parameters K and X. K is defined by equation Equation 2.171 and according to the celerity c (equation Equation 2.174), X corresponds to:\n\\[\nX = \\frac{1}{2} - \\frac{D^3}{2 \\cdot \\Delta x \\cdot |Q| \\cdot Q \\cdot \\frac{\\mathrm{d}D}{\\mathrm{d}h}}\n\\qquad(2.175)\\]\nThis function of the diffusive wave implemented at present in RS MINERVE is capable of solving the Muskingum-Cunge equation for the trapezoidal geometry of a transversal profile according to Figure 2.12.\n\n\n2.11.3 Kinematic Wave routing\nIn the kinematic wave model the terms of inertia and pressure of the St. Venant equations are supposed to be negligible. As a consequence, the cinematic hypothesis supposes that the gravity forces are identical, though with an opposite sign, to the friction forces. This implies that there is an explicit relationship between the flow and the water level (measured normal water depth).\nThe equation of the cinematic wave as presented in the previous chapter is presented as follows:\n\\[\n\\frac{\\partial Q}{\\partial t} + \\left( \\frac{dQ}{dA} \\right)_{x_{0}} \\cdot \\frac{\\partial Q}{\\partial x} = 0\n\\qquad(2.176)\\]\nThis is a simple equation of convection which indicates that the flow Q is transported downstream with a celerity c which is defined as:\n\\[\nc = \\frac{\\partial Q}{\\partial A}\n\\qquad(2.177)\\]\nThis rather simple model transports each point of the hydrograph from upstream to downstream with a velocity c. Since no diffusive term appears in the equation the peak discharge remains constant and is not reduced. On the contrary, the general behaviour of a flood is modified, since high discharges are transferred downstream more rapidly than small ones.\nThe initial parameters are identical to those of the model of the diffusive wave. The geometry for the transversal profiles also corresponds to the same than for the Muskingum-Cunge method (trapezoidal channels, Figure 2.12). Opposite to the model of the diffusive wave, no reduction of the flood is produced as mentioned previously. The solution is performed according to the following equations:\n\\[\nc = \\frac{{Q_{j + 1}}^{n} - {Q_{j}}^{n}}{{A_{j + 1}}^{n} - {A_{j}}^{n}}\n\\qquad(2.178)\\]\n\\[\n\\alpha = c \\cdot \\frac{\\Delta t}{\\Delta L}\n\\qquad(2.179)\\]\n\\[\n{Q_{j + 1}}^{n + 1}=\n  \\begin{cases}\n    \\alpha \\cdot {Q_{j}}^{n} + (1 - \\alpha) \\cdot {Q_{j + 1}}^{n}                                   & \\quad \\text{if } \\alpha \\leq 1 \\\\\n    1/\\alpha \\cdot {Q_{j}}^{n} + (1 - \\frac{1}{\\alpha}) \\cdot {Q_{j}}^{n + 1}               & \\quad \\text{if } \\alpha > 1\n  \\end{cases}\n\\qquad(2.180)\\]\n\n\n2.11.4 Lag-time\nThe lag-time model is the simpler routing model where upstream and downstream flows are delayed by a fixed lag time called Lag (in minutes)."
  },
  {
    "objectID": "hydrological_models.html#sec-model_timeseries",
    "href": "hydrological_models.html#sec-model_timeseries",
    "title": "2  Hydrological and hydraulics models description",
    "section": "2.12 Time series",
    "text": "2.12 Time series\nIn this object, temporary series of flow, precipitation, temperature or ETP can be directly introduced. The time is incorporated in seconds and the associated values in their corresponding units, in tabular form “t [s] - value [depending on the series]”.\n\n\nTable 2.11: Time series required data\n\n\n\n\n\n\n\nName\nUnits\nDescription\n\n\n\n\nSeries (paired data)\ns (depending on the series)\nTime - Value series"
  },
  {
    "objectID": "hydrological_models.html#sec-model_reservoir",
    "href": "hydrological_models.html#sec-model_reservoir",
    "title": "2  Hydrological and hydraulics models description",
    "section": "2.13 Reservoir",
    "text": "2.13 Reservoir\nThe transient evolution of a water volume \\(V\\) in a reservoir is described by the following retention equation:\n\\[\n\\frac{\\mathrm{d}V}{\\mathrm{d}t} = Q_{e} - Q_{s}\n\\qquad(2.181)\\]\nwith \\(V\\): volume in the reservoir [L3]; \\(Q_e\\): inflow in the reservoir [L3/T]; \\(Q_s\\): outflow [L3/T].\nUsually, reservoirs are equipped with turbines, pumps and spillways depending on the water level in the reservoir. To solve equation Equation 2.181, it is necessary to know the outflow as a function of the water volume \\(V\\) in the reservoir. This operation is possible if relation between the water level and the water volume is known (Table 2.12).\n\n\nTable 2.12: Reservoir paired data and initial condition required\n\n\n\n\n\n\n\nName\nUnits\nDescription\n\n\n\n\nH-V (paired data)\nmasl - m3\nLevel - Volume relation\n\n\nHini\nmasl\nInitial level in the reservoir"
  },
  {
    "objectID": "hydrological_models.html#sec-model_hq",
    "href": "hydrological_models.html#sec-model_hq",
    "title": "2  Hydrological and hydraulics models description",
    "section": "2.14 Level-Discharge Relation (HQ)",
    "text": "2.14 Level-Discharge Relation (HQ)\nThe HQ object provides an outflow depending on a level in a reservoir. The outflow is calculated by the help of a “Level - Discharge” relation (Table 2.13). Hence, the discharge in then calculated as follows:\n\\[\n  {Q_{outflow}}^{n} =\n  \\begin{cases}\n    0                                                                                               & \\quad \\text{if } H^n < H_{1} \\\\\n    Q_{dev,i} + (H_{i + 1} - H^{n}) \\cdot \\frac{Q_{outflow,i+1} - Q_{outflow,i}}{H_{i+1} - H_i}     & \\quad \\text{if } H_i < H^n < H_{i+1} \\\\\n  \\end{cases}\n\\qquad(2.182)\\]\nwith \\({Q_{outflow}}^n\\): discharge at instant n [L3/T]; \\(H^n\\): water level at instant n [L]; \\(Q_{outflow,i}\\): discharge flow for a water level \\(H_i\\) [L3/T]; \\(H_i\\): reservoir water level [L].\n\n\nTable 2.13: ** HQ** paired data required\n\n\n\n\n\n\n\nName\nUnits\nDescription\n\n\n\n\nH-Q (paired data)\nmasl - m3/s\nLevel - Discharge relation"
  },
  {
    "objectID": "hydrological_models.html#sec-model_turbine",
    "href": "hydrological_models.html#sec-model_turbine",
    "title": "2  Hydrological and hydraulics models description",
    "section": "2.15 Turbine",
    "text": "2.15 Turbine\nIn this object, temporary series of flow can be directly introduced to provide an outflow in a reservoir. The time is incorporated in seconds and the associated values in their corresponding units, in tabular form “t [s] - discharge”. The final discharge also depends on the level reservoir as presented in next equations:\n\\[\n{Q_{turbine}}^n =\n  \\begin{cases}\n    {Q_{wanted}}^{n}    & \\quad \\text{if } \\left( H^{n} > H_{on}  \\right) \\text{ or } (H_{off} \\leq  H^{n} \\leq H_{on} \\text{ and } IsOperating = 1)  \\\\\n    0                   & \\quad \\text{if } \\left( H^{n} < H_{off} \\right) \\text{ or } (H_{off} \\leq  H^{n} \\leq H_{on} \\text{ and } IsOperating = 0) \\\\\n  \\end{cases}\n\\qquad(2.183)\\]\nwith \\({Q_{turbine}}^n\\): discharge at instant n [L3/T]; \\(H^n\\): water level at instant n [L]; \\({Q_{wanted}}^n\\): discharge flow wanted at instant n [L3/T]; \\(Hon\\): Threshold in the level of the reservoir to start the turbine cycle [L]; \\(Hoff\\): Threshold in the level of the reservoir to stop the turbine cycle [L]; \\(IsOperating\\): Planned turbine cycle at instant t [0/1].\n\n\nTable 2.14: Time-Q paired data, parameters and initial conditions required\n\n\n\n\n\n\n\nName\nUnits\nDescription\n\n\n\n\nH-Q (paired data)\nmasl - m3/s\nLevel - Discharge relation\n\n\nHon\nmasl\nThreshold in the level of the reservoir to start the turbine cycle (turbine starts when the threshold is exceeded)\n\n\nHoff\nmasl\nThreshold in the level of the reservoir to stop the turbine cycle (turbine stops when level go below the threshold)\n\n\nIsOper atingIni\n0/1\nFirst suggested value for the turbine cycle (0 = not turbine; 1 = turbine). Only taken into account if Hoff > H > Hon\n\n\n\n\n\n\n\nFigure 2.13: Time-H, tubine start and stop operation"
  },
  {
    "objectID": "hydrological_models.html#sec-model_hydropower",
    "href": "hydrological_models.html#sec-model_hydropower",
    "title": "2  Hydrological and hydraulics models description",
    "section": "2.16 Hydropower",
    "text": "2.16 Hydropower\nThe inputs of this object are a reservoir level and a discharge. It also needs the paired data relation “Discharge (Q) - Performance (\\(\\eta\\))” for the turbine, the altitude (Zcentral) of the hydropower plant, the length (L), the diameter (D) and the roughness (K) of the pipe as well as the kinematic viscosity of the fluid (*).\nAs outputs, the object calculates not only the power and the revenue for each time step, as presented in equations Equation 2.184 to Equation 2.186, but also the total energy produced and the total obtained revenue. For this calculation, it takes into account the head loss in terms of volumetric flow rate in a full-flowing circular pipe from the Darcy-Weisbach equation (Darcy, 1857; Simmons, 2008).\n\\[\n{Z_{net}}^{n} = ({Z_{water}}^{n} - Z_{central}) - f \\cdot \\frac{8 \\cdot L \\cdot {Q^{n}}^{2}}{g \\cdot \\pi^{2} \\cdot D^{5}}\n\\qquad(2.184)\\]\n\\[\nPower^{n} = \\eta^{n} \\cdot 1000 \\cdot Q^{n} \\cdot g \\cdot {Z_{net}}^{n}\n\\qquad(2.185)\\]\n\\[\nRevenue^{n} = Power^{n} \\cdot Price^{n}\n\\qquad(2.186)\\]\nwith \\({H_{net}}^n\\): net height at instant n [L]; \\({Z_{water}}^n\\): water height in the reservoir at instant n [L]; \\(Z_{central}\\): hydropower plant altitude [L]; \\(f\\): friction factor [-]; \\(L\\): length of the pipe [L]; \\(Q^n\\): discharge at instant n [L3/T]; \\(g\\): gravity, 9.81 [L2/T]; \\(D\\): diameter [L]; \\(Power^n\\): power at instant n [Watt]; \\(\\eta\\): performance of the turbine at instant n [%]; \\(Revenue^n\\): Revenue of the turbine at instant n [/Kwh]; \\(Price^n\\): Price of the energy at instant n [/Kwh].\nIf the discharge actually provided to the object Hydropower is higher than the range proposed in the relation Q-of this object, the maximum discharge of the paired data Q-is taken for the energy production calculations.\n\n\nTable 2.15: Hydropower paired data and parameters required\n\n\n\n\n\n\n\nName\nUnits\nDescription\n\n\n\n\nQ- (paired data)\nm^ 3^/s - %\nDischarge-Performance relation\n\n\nZplant\nmasl\nHydropower plant altitude\n\n\nL\nm\nLength of the pipe\n\n\nD\nm\nDiameter of the pipe\n\n\nK\nm\nRoughness\n\n\n\nm2/s\nKinematic viscosity\n\n\nDefault Price\neu ro/Kwh\nDefault price, only used if no data exists in the database\n\n\n\n\nA default price can be introduced for first approximation of the revenue. It is used only if the object does not have a price series in the database.\nFor the calculation of the friction factor f of the Darcy-Weisbach equation, the equation of Colebrook-White (Colebrook and White, 1937; Colebrook, 1939) is used. It is presented in equation Equation 2.187, where represents f. In addition, the Reynolds number, Re*, is presented in equation Equation 2.188.\n\\[\n\\frac{1}{\\sqrt{\\lambda}} = - 2 \\cdot log_{10}\\left( \\frac{k/D}{3.7} + \\frac{2.51}{Re \\cdot \\sqrt{\\lambda}} \\right)\n\\qquad(2.187)\\]\n\\[\nRe = v \\cdot \\frac{D}{\\upsilon}\n\\qquad(2.188)\\]\nwith \\(\\lambda\\): friction factor [-]; \\(k\\): roughness [L]; \\(Re\\): Reynolds number [-]; \\(v\\): velocity [L/T]; \\(\\upsilon\\): kinematic viscosity [L2/T]\nThe equation Equation 2.187 is solved for the range of discharges of the paired data *Q-, providing the paired data relation “Discharge (Q) - Friction factor ()” for user information."
  },
  {
    "objectID": "hydrological_models.html#sec-model_diversion",
    "href": "hydrological_models.html#sec-model_diversion",
    "title": "2  Hydrological and hydraulics models description",
    "section": "2.17 Diversion",
    "text": "2.17 Diversion\nThis object needs the paired data relation “Inflow - Diverted flow” as information as well as the incoming hydrograph. The relation describes the behaviour of the diversion and is generated by the user, who performs a calculation for the behaviour of the diversion and then creates the relation “Inflow - Diverted flow”.\nWith this information, the Diversion calculates the diverted hydrograph and the downstream hydrograph, as presented in equation Equation 2.189:\n\\[\n{Q_{up}}^{n} = {Q_{down}}^{n} + {Q_{diverted}}^{n}\n\\qquad(2.189)\\]\nwith \\({Q_{up}}^n\\): total flow upstream at instant n [L3/T]; \\({Q_{diverted}}^n\\): diverted flow at instant n [L3/T]; \\({Q_{down}}^n\\): downstream flow at instant n [L3/T].\n\n\nTable 2.16: Diversion paired data required\n\n\n\n\n\n\n\nName\nUnits\nDescription\n\n\n\n\nQup-Qdiverted (paired data)\nm3/s - m3/s\nUpstream flow - Diverted flow relation"
  },
  {
    "objectID": "hydrological_models.html#sec-model_consumer",
    "href": "hydrological_models.html#sec-model_consumer",
    "title": "2  Hydrological and hydraulics models description",
    "section": "2.18 Consumer",
    "text": "2.18 Consumer\nThe Consumer object is used to take into account a consumption site (agriculture, cities, etc.). A series in the database is used as the demand of the Consumer object. If no information about consummation exists in the database, the parameter “Default QDemand” is used for the whole period of the simulation as uniform demand.\nThe LossRate parameter provides the distribution losses of a demand site (physical leaks, clandestine connections, etc.). If the input discharge (Qup) is sufficient, the delivered flow (Qdelivered) is equal to the Qdemand and the supply requirement (Qsupplied) is equal to the Qdemand divided by (1-LossRate), otherwise the supply requirement is equal to the input discharge (Qup). Then, the ConsumptionRate parameter is used to determine the discharge consumed by the demand site and which is lost (evaporation, embodied products, etc). The discharge remainder (Qreturn) is returned to the main system. The output flow is equal to the input flow minus the losses and the effective consumption (Qconsumed).\nThe Consumer object calculates the losses, the consumed discharge as well as the downstream hydrograph, as presented in next equations. At the same time, the object also calculates the unmet demand and the demand coverage (%) series during the simulation period.\n\\[\n{Q_{supplied}}^{n} = min \\bigg( \\frac{{Q_{demand}}^{n}}{1 - LossRate};{Q_{up}}^{n} \\bigg)\n\\qquad(2.190)\\]\n\\[\n{Q_{stream}}^{n} = {Q_{up}}^{n} - {Q_{supplied}}^{n}\n\\qquad(2.191)\\]\n\\[\n{Q_{losses}}^{n} = {Q_{supplied}}^{n} \\cdot LossRate\n\\qquad(2.192)\\]\n\\[\n{Q_{delivered}}^{n} = {Q_{supplied}}^{n} \\cdot (1 - LossRate)\n\\qquad(2.193)\\]\n\\[\n{Q_{UnmetDemand}}^{n} = {Q_{demand}}^{n} - {Q_{delivered}}^{n}\n\\qquad(2.194)\\]\n\\[\n{DemandCoverage}^{n} = \\frac{{Q_{demand}}^{n} - {Q_{delivered}}^{n}}{{Q_{demand}}^{n}} \\cdot 100\n\\qquad(2.195)\\]\n\\[\n{Q_{consumed}}^{n} = {Q_{delivered}}^{n} \\cdot ConsumptionRate\n\\qquad(2.196)\\]\n\\[\n{Q_{return}}^{n} = {Q_{delivered}}^{n} \\cdot (1 - ConsumptionRate)\n\\qquad(2.197)\\]\n\\[\n{Q_{down}}^{n} = {Q_{up}}^ {n} - {Q_{losses}}^{n} - {Q_{consumed}}^{n}\n\\qquad(2.198)\\]\nwith \\({Q_{demand}}^n\\): demanded consumption at instant n [L3/T]; \\({Q_{up}}^n\\): total flow upstream at instant n [L3/T]; \\(LossRate\\): fraction of the Qsupplied lost at the demand site [-]; \\({Q_{supplied}}^n\\): supplied discharge at instant n [L3/T]; \\({Q_{stream}}^n\\): discharge that flows downstream after the initial supply at instant n [L3/T]; \\({Q_{losses}}^n\\): part of the Qsupplied discharge that is lost at instant n [L3/T]; \\(LossRate\\): fraction of the Qsupplied discharge that will be lost before its delivery [-]; \\({Q_{delivered}}^n\\): part of the Qsupplied discharge that is not lost at instant n [L3/T]; \\({Q_{UnmetDemand}}^n\\): discharge shortfall at the consumption site at instant n [L3/T]; \\(DemandCoverage\\): percentage of the demand covered by the delivered discharge at instant n [%]; \\(ConsumptionRate\\): fraction of the Qdelivered ultimately consumed [-]; \\({Q_{consumed}}^n\\): discharge consumed at the consumption site at instant n [L3/T]; \\({Q_{return}}^n\\): discharge returning downstream from the consumption site at instant n [L3/T]; \\({Q_{down}}^n\\): downstream flow at instant n [L3/T].\n\n\nTable 2.17: Consumer parameters required\n\n\n\n\n\n\n\nName\nUnits\nDescription\n\n\n\n\nLossRate\n-\nFraction of the Qsupplied lost at the demand site\n\n\nConsumptionRate\n-\nFraction of the Qdelivered ultimately consumed\n\n\nDefault QDemand\nm3/s\nDefault demand of consummation, only used if no data exists in the database\n\n\n\n\n\n\n\nFigure 2.14: Distribution of discharges in the Consumer object"
  },
  {
    "objectID": "hydrological_models.html#sec-model_efficiency",
    "href": "hydrological_models.html#sec-model_efficiency",
    "title": "2  Hydrological and hydraulics models description",
    "section": "2.19 Structure efficiency",
    "text": "2.19 Structure efficiency\nThis object needs an efficiency coefficient as information to describe the efficiency of a structure such a canal or a pipe, as well as the incoming hydrograph.\nAn efficiency of 1 provides an output flow equivalent to the input hydrograph. An efficiency of 0 generates a complete loss of the input.\nThe downstream hydrograph is calculated as presented in equation Equation 2.199 and Equation 2.200:\n\\[\n{Q_{down}}^{n} = {Q_{up}}^{n} \\cdot \\text{Efficiency}\n\\qquad(2.199)\\]\n\\[\n{Q_{lost}}^{n} = {Q_{up}}^{n} \\cdot (1 - \\text{Efficiency})\n\\qquad(2.200)\\]\nwith \\({Q_{up}}^n\\): total flow upstream at instant n [L3/T]; \\({Q_{lost}}^n\\): lost flow at instant n [L3/T]; \\({Q_{down}}^n\\): downstream flow at instant n [L3/T].\n\n\nTable 2.18: Structure efficiency parameters required\n\n\n\n\n\n\n\nName\nUnits\nDescription\n\n\n\n\nEfficiency\n-\nEfficiency of the structure"
  },
  {
    "objectID": "hydrological_models.html#sec-model_planner",
    "href": "hydrological_models.html#sec-model_planner",
    "title": "2  Hydrological and hydraulics models description",
    "section": "2.20 Planner",
    "text": "2.20 Planner\nWhen a planner object is selected, a manage system is generated. Inside this object, several Rules can be created. All the rules will be computed, from first one to last one. In each rule define several Conditions is possible and also create combinations between them (with AND or OR operators). The rule will be applied if the combined condition (or an individual condition) is satisfied.\n\n\nTable 2.19: Operators to combine rule conditions\n\n\n\n\n\n\nOperator\nCombined condition is satisfied when\n\n\n\n\nOR\nLeft condition OR Right condition are satisfied\n\n\nAND\nLeft condition AND Right condition are satisfied\n\n\n\n\nA typical example of planner is the implementation of a turbine / pump law as a function of the water level in the reservoir. Thus, some Rules should be created with different conditions regarding to reservoir levels or, in some cases, to results from other objects.\n\n\nTable 2.20: Planner data required\n\n\n\n\n\n\n\n\nObject\nName\nUnits\nDescription\n\n\n\n\nPlanner\nRule\n-\nRule to be applied regarding at least one condition\n\n\nRules\nCondition\n-\nExpression to be evaluated and if it is satisfied the parent rule will be applied\n\n\n\n\nThe possible operators to use inside the conditions are presented in Table 2.20.\n\n\nTable 2.21: Operators for rule conditions\n\n\n\n\n\n\nOperator\nDefinition\n\n\n\n\n>\nBigger than\n\n\n\nBigger than or equal to\n\n\n=\nEqual to\n\n\n\nSmaller than or equal to\n\n\n<\nSmaller than"
  },
  {
    "objectID": "hydrological_models.html#sec-model_comparator",
    "href": "hydrological_models.html#sec-model_comparator",
    "title": "2  Hydrological and hydraulics models description",
    "section": "2.21 Comparator",
    "text": "2.21 Comparator\nThe Comparator object calculates ten performance indicators by comparing a simulated and a reference (observed) timeseries. The warm up period parameter (in days) is used for the initialization of the model state variables. Note that this time period starts at the beginning of and must be shorter than the simulation period and is not used to compute the performance indicators. The description of each indicator is presented in Chapter 3.\nMoreover, for the calculation of threshold-based indicators (Peirce Skill Score and Overall Accuracy), the definition of both the reference and the simulation thresholds is required (Table 2.22).\n\n\nTable 2.22: Comparator parameters required\n\n\n\n\n\n\n\nName\nUnits\nDescription\n\n\n\n\nReference threshold\n(depends on the variable)\nThreshold used by threshold-based indicators (returns TRUE if reference value > threshold)\n\n\nSimulation threshold\n(depends on the variable)\nThreshold used by threshold-based indicators (returns TRUE if simulation value > threshold)\n\n\nWarm up period\nDays\nWarm up period, not used for indicators computation\n\n\n\n\n\n\n\n\n\nHamdi, Y, B Hingray, and A Musy. 2005. “Un Modèle de Prévision Hydro-Météorologique Pour Les Crues Du Rhône Supérieur En Suisse.” Wasser, Energie and Luft, 325–32.\n\n\nMcGuinness, J. L., and Erich F. Bordne. 1972. “A Comparison of Lysimeter-Derived Potential Evapotranspiration with Computed Values.” https://EconPapers.repec.org/RePEc:ags:uerstb:171893.\n\n\nOudin, L. 2004. “Recherche d’un Modèle d’évapotranspiration Potentielle Pertinent Comme Entrée d’un Modèle Pluie-Débit Global.” {PhD} {Thesis}, Ecole Nationale du Génie Rural, des Eaux et des Forêts, Paris.\n\n\nSchaefli, B., B. Hingray, M. Niggli, and A. Musy. 2005. “A Conceptual Glacio-Hydrological Model for High Mountainous Catchments.” Hydrology and Earth System Sciences 9 (1/2): 95–109. https://doi.org/10.5194/hess-9-95-2005."
  },
  {
    "objectID": "performance_indicators.html",
    "href": "performance_indicators.html",
    "title": "3  Performance indicators",
    "section": "",
    "text": "The indicators calculated by the Comparator object are based on observed and simulated values. Since the Comparator object is able to compare variables of type flow, height, altitude, power and True/False, the descriptions below only refer to these 2 variables."
  },
  {
    "objectID": "performance_indicators.html#sec-performance_indicators_nash",
    "href": "performance_indicators.html#sec-performance_indicators_nash",
    "title": "3  Performance indicators",
    "section": "3.1 Nash coefficient",
    "text": "3.1 Nash coefficient\nThe Nash-Sutcliffe criteria (Nash and Sutcliffe, 1970) is used to assess the predictive power of hydrological models (Ajami et al., 2004; Schaefli and al, 2005; Jordan, 2007; Viviroli et al., 2009; García Hernández et al., 2011). It is defined as presented in equation Equation 3.1.\n\\[\nNash = 1 - \\frac{\\sum_{t = t_{i}}^{t_{f}}{(X_{sim,t} - X_{ref,t})^{2}}}{\\sum_{t = t_{i}}^{t_{f}}{(X_{ref,t} - {\\overline{X}_{ref}})^{2}}}\n\\qquad(3.1)\\]\nwith \\(Nash\\): Nash-Sutcliffe model efficiency coefficient [-]; \\(X_{sim,t}\\): simulated variable (discharge [L3/T] or height [L]) at time t; \\(X_{ref,t}\\) : observed variable (discharge [L3/T] or height [L]) at time t; \\(\\overline{X}_{ref}\\): average observed variable (discharge [L3/T] or height [L]) for the considered period.\nIt varies from -∞ to 1, with 1 representing the best performance of the model and zero the same performance than assuming the average of all the observations at each time step."
  },
  {
    "objectID": "performance_indicators.html#sec-performance_indicators_nashlog",
    "href": "performance_indicators.html#sec-performance_indicators_nashlog",
    "title": "3  Performance indicators",
    "section": "3.2 Nash coefficient for logarithm values",
    "text": "3.2 Nash coefficient for logarithm values\nThe Nash-Sutcliffe coefficient for logarithm flow values (Nash-ln) is used to assess the hydrological models performance for low values (Krause et al., 2005; Nóbrega et al., 2011). It is defined as presented in equation eq-IND2.\n\\[\n\\text{Nash-ln} = 1 - \\frac{\\sum_{t = t_{i}}^{t_{f}}{(ln(X_{sim,t}) - ln(X_{ref,t}))^{2}}}{\\sum_{t = t_{i}}^{t_{f}}{(ln(X_{ref,t}) - ln({\\overline{X}_{ref}}))^{2}}}\n\\qquad(3.2)\\]\nwith \\(Nash-ln\\): Nash-Sutcliffe coefficient for log values [-].\nIt varies from -∞ to 1, with 1 representing the best performance of the model."
  },
  {
    "objectID": "performance_indicators.html#sec-performance_indicators_pearson",
    "href": "performance_indicators.html#sec-performance_indicators_pearson",
    "title": "3  Performance indicators",
    "section": "3.3 Pearson Correlation Coefficient",
    "text": "3.3 Pearson Correlation Coefficient\nThe Pearson correlation coefficient shows the covariability of the simulated and observed values without penalizing for bias (AghaKouchak and Habib, 2010; Wang et al., 2011). It is defined as presented in equation Equation 3.3.\n\\[\nPearson = \\frac{\\sum_{t = t_{i}}^{t_{f}}{(X_{sim,t} - {\\overline{X}_{sim}}) \\cdot (X_{ref,t} - {\\overline{X}_{ref}})}}{\\sqrt{\\sum_{t = t_{i}}^{t_{f}}{(X_{sim,t} - {\\overline{X}_{sim}})^{2}} \\cdot \\sum_{t = t_{i}}^{t_{f}}{(X_{ref,t} - {\\overline{X}_{ref}})^{2}}}}\n\\qquad(3.3)\\]\nwith \\(Pearson\\): Pearson Correlation Coefficient [-]; \\({\\overline{X}_{sim}}\\): average simulated variable (discharge [L3/T] or height [L]) for the considered period.\nIt varies from -1 to 1, with 1 representing the best performance of the model."
  },
  {
    "objectID": "performance_indicators.html#sec-performance_indicators_klinggupta",
    "href": "performance_indicators.html#sec-performance_indicators_klinggupta",
    "title": "3  Performance indicators",
    "section": "3.4 Kling-Gupta Efficiency",
    "text": "3.4 Kling-Gupta Efficiency\nThe Kling-Gupta efficiency (Gupta et al., 2009) provides an indicator which facilitates the global analysis based on different components (correlation, bias and variability) for hydrological modelling issues.\nKling et al. (2012) proposed a revised version of this indicator, to ensure that the bias and variability ratios are not cross-correlated. This update is proposed as indicator in RS MINERVE (equation Equation 3.4):\n\\[\nKGE' = 1 - \\sqrt{(r - 1)^{2} + (\\beta - 1)^{2} + (\\gamma - 1)^{2}}\n\\qquad(3.4)\\]\n\\[\n\\beta = \\frac{\\mu_{s}}{\\mu_{o}}\n\\qquad(3.5)\\]\n\\[\n\\gamma = \\frac{{CV}_{s}}{{CV}_{o}} = \\frac{\\sigma_{s}/\\mu_{s}}{\\sigma_{o}/\\mu_{o}}\n\\qquad(3.6)\\]\nwith \\(KGE'\\): modified KGE-statistic [-]; \\(r\\): correlation coefficient between simulated and reference values [-]; \\(\\beta\\): bias ratio; \\(\\gamma\\): variability ratio [-]; \\(\\mu\\): mean discharge [L3/T]; \\(CV\\): coefficient of variation [-]; \\(\\sigma\\): standard deviation of discharge [L3/T]; the indices \\(s\\) and \\(o\\) indicate respectively simulated and observed discharge values.\nIt varies from 0 to 1, with 1 representing the best performance."
  },
  {
    "objectID": "performance_indicators.html#sec-performance_indicators_biasscore",
    "href": "performance_indicators.html#sec-performance_indicators_biasscore",
    "title": "3  Performance indicators",
    "section": "3.5 Bias Score",
    "text": "3.5 Bias Score\nThe Bias Score (BS) is a symmetric estimation of the match between the average simulation and average observation (Wang et al., 2011). It is defined as presented in equation Equation 3.7.\n\\[\nBS = 1 - \\bigg( max(\\frac{{\\overline{X}}_{sim}}{{\\overline{X}}_{ref}};\\frac{{\\overline{X}}_{ref}}{{\\overline{X}}_{sim}}) - 1 \\bigg)^2\n\\qquad(3.7)\\]\nwith \\(BS\\): Bias Score [-].\nIt varies from -∞ to 1, with 1 representing the best performance of the model."
  },
  {
    "objectID": "performance_indicators.html#sec-performance_indicators_rrmse",
    "href": "performance_indicators.html#sec-performance_indicators_rrmse",
    "title": "3  Performance indicators",
    "section": "3.6 Relative Root Mean Square Error",
    "text": "3.6 Relative Root Mean Square Error\nThe Relative Root Mean Square Error (RRMSE) is defined as the RMSE normalized to the mean of the observed values (Feyen et al., 2000; El-Nasr et al., 2005; Heppner et al., 2006) and is presented in Eq. IND.8.\n\\[\nRRMSE = \\frac{\\sqrt{\\frac{\\sum_{t = t_{i}}^{t_{f}}{(X_{sim,t} - X_{ref,t})^{2}}}{n}}}{{\\overline{X}}_{ref}}\n\\qquad(3.8)\\]\nwith \\(RRMSE\\): relative RMSE [-]; \\(n\\): number of values [-].\nIt varies from 0 to +∞. The smaller RRMSE, the better the model performance is."
  },
  {
    "objectID": "performance_indicators.html#sec-performance_indicators_rvb",
    "href": "performance_indicators.html#sec-performance_indicators_rvb",
    "title": "3  Performance indicators",
    "section": "3.7 Relative Volume Bias",
    "text": "3.7 Relative Volume Bias\nThe Relative Volume Bias (RVB), sometimes called differently, corresponds in this case to the relative error between the simulated and the observed volumes during the studied period (Ajami and al, 2004; Schaefli and al, 2005; Moriasi et al., 2007; AghaKouchak and Habib, 2010) according to Eq. IND.9. This indicator is envisaged for the comparison between observed and simulated discharges.\n\\[\nRVB = \\frac{\\sum_{t = t_{i}}^{t_{f}}{(X_{sim,t} - X_{ref,t})}}{\\sum_{t = t_{i}}^{t_{f}}{(X_{ref,t})}}\n\\qquad(3.9)\\]\nwith RVB: relative volume bias between forecast and observation for the considered period [-]; X usually corresponding to the discharge variable.\nThe RVB varies from -1 to +∞. An index near to zero indicates a good performance of the simulation. Negative values are returned when simulated variable is, in average, smaller than the average of the observed one (deficit model), while positive values mean the opposite (overage model)."
  },
  {
    "objectID": "performance_indicators.html#sec-performance_indicators_npe",
    "href": "performance_indicators.html#sec-performance_indicators_npe",
    "title": "3  Performance indicators",
    "section": "3.8 Normalized Peak Error",
    "text": "3.8 Normalized Peak Error\nThe Normalized Peak Error (NPE) indicates the relative error between the simulated and the observed maximum values (Masmoudi and Habaieb, 1993; Sun and al, 2000; Ajami and al, 2004; Gabellani and al, 2007). It is computed according to IND.10 TO IND.12.\n\\[\nNPE = \\frac{S_{\\max} - R_{\\max}}{R_{\\max}}\n\\qquad(3.10)\\]\n\\[\nS_{\\max} = \\overset{t_{f}}{\\underset{t = t_{i}}{\\vee}}Q_{sim,t}\n\\qquad(3.11)\\]\n\\[\nR_{\\max} = \\overset{t_{f}}{\\underset{t = t_{i}}{\\vee}}Q_{ref,t}\n\\qquad(3.12)\\]\nwith NPE: relative error between simulated and observed peak value [-]; Smax : maximum simulated value (discharge [L3/T] or height [L]) for the studied period; Rmax : maximum observed value (discharge [L3/T] or height [L]) for the studied period.\nThe NPE varies from -1 to +∞. Negative values are returned when maximum simulated value is below the observed one, while positive values mean the opposite. Values near to zero indicate a good performance of simulated peaks regarding observed ones.\n\n\n\n\n\n\nWarning\n\n\n\nThe indicator is computed over the entire simulation period and the absolute maximum of the simulated and the observed peaks are considered! This indicator should therefore be used with care when simulating over long periods of time."
  },
  {
    "objectID": "performance_indicators.html#sec-performance_indicators_pierce",
    "href": "performance_indicators.html#sec-performance_indicators_pierce",
    "title": "3  Performance indicators",
    "section": "3.9 Peirce Skill Score",
    "text": "3.9 Peirce Skill Score\nThe Peirce Skill Score (PSS) indicates the performance of the model to reproduce the overrun of a threshold (Peirce, 1884; Manzato, 2007). Based on a contingency table definging the number of cases where the simulation and the obseration exceed or not the threshold, the PSS is computed according to IND.13.\n\\[\nPSS = \\frac{ad - bc}{(a + c)(b + d)}\n\\qquad(3.13)\\]\nwith \\(a\\): the number of cases when both simulation and observation exceed the threshold defined in the Comparator (event); \\(b\\): the number of cases when the simulation exceeds the threshold but not the obseration (false); \\(c\\): the number of cases when the observation exceeds the threshold but not the simulation (miss); \\(d\\): the number of cases when both simulation and obseration are below the threshold (nonevent).\n\n\n\n\n\n\nNote\n\n\n\nRemark : If the denominerator equals 0 (division by 0), a value of 0 is returned for the PSS."
  },
  {
    "objectID": "performance_indicators.html#sec-performance_indicators_oa",
    "href": "performance_indicators.html#sec-performance_indicators_oa",
    "title": "3  Performance indicators",
    "section": "3.10 Overall Accuracy",
    "text": "3.10 Overall Accuracy\nThe Overall Accurary (OA) indicates the performance of the model to reproduce the overrun of a threshold (Parajka and Blöschl, 2008). Based on the same contingency table as the Pierce Skill Score, the OA is computed according to equation Equation 3.14.\n\\[\nOA = \\frac{a + d}{a + b + \\ c + d}\n\\qquad(3.14)\\]"
  },
  {
    "objectID": "calibration_algorithms.html",
    "href": "calibration_algorithms.html",
    "title": "4  Expert module - Calibration algorithms",
    "section": "",
    "text": "The module Calibrator of the RS Expert frame has been implemented for calibrating the parameters of the hydrological model. This module uses an objective function defined by the user and different algorithms to solve it.\nThe first algorithm, the Shuffled Complex Evolution – University of Arizona (SCE-UA), is a global optimization method (Duan et al., 1992, 1993) based on a synthesis of the best features from several existing algorithms, including the genetic algorithm, and introduces the concept of complex information exchange, so-called complex shuffling. The SCE-UA method was designed for solving problems encountered in conceptual watershed model calibration (Hapuarachchi H.A.P. et al., 2001; Ajami et al., 2004; Muttil and Liong, 2004; Blasone et al., 2007), but has also been satisfyingly used in water resources management (Zhu et al., 2006; Lin et al., 2008; Wang et al., 2010).\nThe second algorithm is a variation of the Adaptive Markov Chain Monte Carlo, used since it can be interesting for solving complex problems in high dimensional spaces (Gilks et al., 1996; Liu, 2001). It has been modified to an Uniform Adaptative Monte Carlo (UAMC) in this program to adjust the solution space after a defined group of simulations up to the convergence of the optimization. Variations of the Monte Carlo method are usually used in hydrological problem for parameterization optimization (Vrugt and al., 2003; Jeremiah and al., 2012).\nThe third and last algorithm used in RS MINERVE is the Coupled Latin Hypercube and Rosenbrock (CLHR) It couples the Latin Hypercube algorithm (McKay et al., 1979) with the Rosenbrock algorithm (Rosenbrock, 1960), generating a powerful tool for optimization of complex problems. The latin hypercube algorithm has been usually used in hydrology for sampling the initial parameter space, combined the with other methods (van Griensven et al, 2006; Kamali et al., 2013). Rosenbrock algorithm has been also used for hydrological parameters optimisation (Abbot et Refsgaard, 1996) or optimization of numerical functions (Kang et al., 2011)."
  },
  {
    "objectID": "calibration_algorithms.html#sec-calibration_algorithms_of",
    "href": "calibration_algorithms.html#sec-calibration_algorithms_of",
    "title": "4  Expert module - Calibration algorithms",
    "section": "4.2 Objective function",
    "text": "4.2 Objective function\nA flexible objective function (OF) has been developed for the module of calibration aiming to be adapted to the user’s requirements. The indicators presented in Chapter 4 are used in this OF, each one weighted with a value defined by the user (Table 4.1).\n\n\nTable 4.1: Weights of the indicators for the objective function\n\n\n\n\n\n\n\n\nIndicator\nWeight\nRange of Values\nIdeal value\n\n\n\n\nNash\nw1\n-∞ to 1\n1\n\n\nNash-ln\nw2\n-∞ to 1\n1\n\n\nPearson Correlation Coefficient\nw3\n-1 to 1\n1\n\n\nKling-Gupta Efficiency (KGE)\nw4\n-∞ to 1\n1\n\n\nBias Score (BS)\nw5\n-∞ to 1\n1\n\n\nRelative Root Mean Square Error (RRMSE)\nw6\n0 to +∞\n0\n\n\nRelative Volume Bias (RVB)\nw7\n-∞ to +∞\n0\n\n\nNormalized Peak Error (NPE)\nw8\n-∞ to +∞\n0\n\n\nPeirce Skill Score (PSS)\nw9\n-1 to 1\n1\n\n\nOverall Accuracy (OA)\nw10\n0 to 1\n1\n\n\n\n\nThe OF is presented in equation Equation 4.1 and takes into account the ideal values of each indicator. Thus, the OF searches to maximize the first five and last two indicators (Nash, Nash-ln, Pearson, Kling-Gupta, BS, PSS and OA) since their ideal value is equal to the maximum possible value and, at the same time, to minimize the value or the absolute value for the three other indicators (RRMSE, RVB, NPE) since their ideal value corresponds to zero.\n\\[\nOF = max(Nash \\cdot w_{1} + Nashln \\cdot w_{2} + Pearson \\cdot w_{3} + KGE \\cdot w_{4} + BS \\cdot w_{5} - RRMSE \\cdot w_{6} - \\left| RVB \\cdot w_{7} \\right| - \\left| NPE \\cdot w_{8} \\right| + PSS \\cdot w_{9} + OA \\cdot w_{10})\n\\qquad(4.1)\\]"
  },
  {
    "objectID": "calibration_algorithms.html#sec-calibration_algorithms_sce_ua",
    "href": "calibration_algorithms.html#sec-calibration_algorithms_sce_ua",
    "title": "4  Expert module - Calibration algorithms",
    "section": "4.3 Shuffled Complex Evoluation – University of Arizona",
    "text": "4.3 Shuffled Complex Evoluation – University of Arizona\n\n4.3.1 Model architecture\nThe Shuffled Complex Evolution – University of Arizona (SCE-UA) method was developed to obtain the traditional best parameter set and its underlying posterior distribution within a single optimization run. The goal is to find a single best parameter set in the feasible space. It starts with a random sample of points distributed throughout the feasible parameter space, and uses an adaptation of the Simplex Downhill search scheme (Nelder and Mead, 1965) to continuously evolve the population toward better solutions in the search space, progressively relinquishing occupation of regions with lower posterior probability (Mariani et al., 2011).\nA general description of the steps of the SCE-UA method is given below (Duan et al., 1994) and illustrated in Figure 4.1.\nStep 1\nGenerate sample: Sample NPT points in the feasible parameter space and compute the criterion value at each point. In the absence of prior information on the location of the global optimum, use a uniform probability distribution to generate a sample.\nStep 2\nRank points: Sort the NPT points to increase criterion value so that the first point represents the point with the lowest criterion value and the last the one with the highest criterion value (assuming that the goal is to minimize the criterion value).\nStep 3\nPartition into complexes: Partition the NPT points into NGS complexes, each containing NPG points. The complexes are partitioned in such a way that the first complex contains every NGS (k-1)+1 ranked point, the second complex contains every NGS (k-1)+2 ranked point, and so on, where k = 1,2,...,NPG.\nStep 4\nEvolve each complex: Evolve each complex independently by taking NSPL evolution steps, according to the Competitive Complex Evolution (CCE) algorithm. Figure 4.3 illustrates how each evolution step is taken.\nStep 5\nShuffle complexes: Combine the points in the evolved complexes into a single sample population; sort the sample population in order of increasing criterion value; re-partition or shuffle the sample population into NGS complexes according to the procedure specified in the third step.\nStep 6\nCheck convergence: If any of the pre-specified convergence criteria are satisfied, stop; otherwise, continue.\nStep 7\nCheck complex number reduction: If MINGS (the minimum number of complexes) < NGS, remove the complex with the lowest ranked points; set NGS=NGS-1 and NPT=NGS NPG; and return to Step 4. If MINGS=NGS, return to Step 4.\n\n\n\nFigure 4.1: Flow chart of the shuffled complex evolution method (from Duan et al., 1993), with V=n, NGS=p, NPG=m and NPT=s\n\n\nThe SCE-UA method is explained in Figure 4.2 and Figure 4.3 for a two dimensional case (Duan et al., 1994). The contour lines in Figure 4.2 and Figure 4.3 represent a function surface having a global optimum located at (4,2) and a local optimum located at (1,2). Figure 4.2 (a) shows that a sample population containing NPT (=10) points is divided into NGS (=2) complexes. Each complex contains NPG (=5) points which are marked by • and * respectively. Figure 4.2 (b) shows the locations of the points in the two independently evolved complexes at the end of the first cycle of evolution. It can be seen that one complex (marked by *) is converging towards the local optimum, while the other (marked by •) is converging toward the global optimum. The two evolved complexes are shuffled according to step 5. Figure 4.2 (c) displays the new membership of the two evolved complexes after shuffling.\nFigure 4.2 (d) illustrates the two complexes at the end of the second cycle of evolution. It is clear that both complexes are now converging to the global optimum at the end of second cycle.\n\n\n\nFigure 4.2: Illustration of the shuffled complex evolution (SCE-UA) method (from Duan et al., 1994)\n\n\nThe CCE algorithm is graphically illustrated in Figure 4.3. The black dots (•) indicate the locations of the points in a complex before the evolution step is taken. A sub-complex containing NPS (=3, i.e. forms a triangle in this case) points is selected according to a pre-specified probability distribution to initiate an evolution step.\nThe probability distribution is specified such that the better points have a higher chance of being chosen to form the sub-complex than the worse points. The symbol (*) represents the new points generated by the evolution steps. There are three types of evolution steps: reflection, contraction and mutation.\nFigure 4.3 (a), Figure 4.3 (b) and Figure 4.3 (d) illustrate the \"reflection\" step, which is implemented by reflecting the worst point in a sub-complex through the centroid of the other points. Since the reflected point has a lower criterion value than the worst point, the worst point is discarded and replaced by the new point. Thus an evolution step is completed.\nIn Figure 4.3 (c), the new point is generated by a \"contraction\" step (the new point lies half-way between the worst point and the centroid of the other points), after rejecting a reflection step for not improving the criterion value.\nIn Figure 4.3 (e), a \"mutation\" step is taken by random selection of a point in the feasible parameter space to replace the wrong point of the sub-complex. This is realized after a reflection step is attempted, but results in a wrong point, i.e. outside of the feasible parameter space. Another scenario in which a mutation step is taken is when both the reflection step and the contraction step do not improve the criterion value.\nFinally, the Figure 4.3 (f) shows the final complex after NSPL (=5) evolution steps.\n\n\n\nFigure 4.3: Illustration of the evolution steps taken by each complex (from Duan et al., 1994).\n\n\n\n\n4.3.2 Algorithm parameters\nDifferent parameters of the SCE-UA have to be defined by the user (Table 4.2), as presented hereafter, and other parameters are directly calculated by the process.\nAn initial set of Nopt parameters is given by the user or is assumed as random depending on the user’s needs and the used hydrological models. The other NPT-1 points (or parameters sets) are randomly created by the algorithm, depending on a SEED value. The number of points NPG in each complex corresponds to 2 Nopt+1 and the number of points NPS in each sub-complex to Nopt+1 (It has to be noted that each point corresponds to a set of parameters). The number of evolution steps allowed for each complex before complex shuffling, NSPL, is equal to NPG. The number of complexes is defined as NGS, which is assumed equal to MINGS according to the Duan investigation (Duan et al., 2004). Then, the total number of points NPT in the entire sample population is NGS NPG.\nThree different convergence criteria are defined by the user:\n\nThe maximum number of function evaluations (or iterations) MAXN.\nThe number of shuffling loops (KSTOP) in which the criterion value must change by a fixed percentage (PCENTO) before optimization is finished.\nThe PEPS parameter which provides a flag indicating whether parameter convergence is reached (It compares the value of PEPS with the normalized geometric mean of parameter ranges).\n\n\n\nTable 4.2: Parameters of the SCE-UA algorithm\n\n\n\n\n\n\n\n\nName\nUnits\nDescription\nDefault Value\n\n\n\n\nMAXM\n-\nMaximum number of iterations\n10000\n\n\nNGS\n-\nNumber of complexes\n3\n\n\nKSTOP\n-\nNumber of shuffling loops\n10\n\n\nPCENTO\n-\nCriterion value on shuffling loops\n0.1\n\n\nPEPS\n-\nConvergence parameter\n0.001\n\n\nSEED\n-\nSeed value\nRandom"
  },
  {
    "objectID": "calibration_algorithms.html#sec-calibration_algorithms_uamc",
    "href": "calibration_algorithms.html#sec-calibration_algorithms_uamc",
    "title": "4  Expert module - Calibration algorithms",
    "section": "4.4 Uniform Adaptive Monte Carlo",
    "text": "4.4 Uniform Adaptive Monte Carlo\n\n4.4.1 Model architecture\nThe Uniform Adaptive Monte Carlo (UAMC) algorithm is based on the Monte Carlo experiments that rely on repeated random sampling to obtain simulation results (Gilks et al., 1996; Liu, 2001) ; but has been modified in order to iteratively adjust the solution space.\nThe algorithm randomly launches a collection of simulations (block) and finds the better results in the solution space. Afterwards, the solution space is adjusted and a new group of simulations starts. The process is repeated until the optimization converges to the best set of parameters (Figure 4.4).\n\n\n4.4.2 Algorithm parameters\nDifferent parameters of the UAMC algorithm have to be defined by the user (Table 4.3), as presented hereafter.\nA number of iterations ITGR per group is defined for the optimization. Random values of parameters are used for each iteration of the group based on a SEED value. Once the first group of iterations is finished, a number NUMBEST of best values is applied for calculating the solutions space range for the next group of iterations. This solution space takes into account the minimum and the maximum values of each parameter providing the best values and adds an additional range COEFRANG.\nFinally, the optimization finishes when the convergence criterion (defined as ERR) is achieved, or when the maximum number of iterations MAXN is attained.\n\n\nTable 4.3: Parameters of the UAMC algorithm\n\n\n\n\n\n\n\n\nName\nUnits\nDescription\nDefault Value\n\n\n\n\nMAXN\n-\nMaximum number of iterations\n2000\n\n\nITGR\n-\nNumber of iterations per group\n100\n\n\nNUMBEST\n-\nNumber of best values taken into account for the next group calculation\n5\n\n\nCOEFRANG\n-\nAdditional range coefficient\n0.1\n\n\nERR\n-\nError difference until convergence\n0.001\n\n\nSEED\n-\nSeed value\nRandom\n\n\n\n\n\n\n\nFigure 4.4: Flow chart of the UAMC algorithm"
  },
  {
    "objectID": "calibration_algorithms.html#sec-calibration_algorithms_rosenb",
    "href": "calibration_algorithms.html#sec-calibration_algorithms_rosenb",
    "title": "4  Expert module - Calibration algorithms",
    "section": "4.5 Coupled Latin Hypercube and Rosenbrock",
    "text": "4.5 Coupled Latin Hypercube and Rosenbrock\n\n4.5.1 Model architecture\nThe Coupled Latin Hypercube (McKay et al., 1979) and the Rosenbrock algorithm (Rosenbrock, 1960), called hereafter CLHR, generates a powerful tool for optimization of complex problems. This combined algorithm can discretize a wide domain and then narrow your search to smaller sectors (Figure 4.5). Scanning of the space of possible solutions is performed by the Latin Hypercube. This algorithm allows pseudo-statistical sampling conditioned by the previous calculated solutions. The Latin hypercube is an evolution of Monte Carlo method, with more homogeneous samples achieved with fewer samples. An important advantage of this method is that the dimension of the problem is defined by the division of the latin hypercube and not by the number of parameters.\nThe best results from samples become the starting points required for Rosenbrock algorithm. The advantage of this subroutine calculation lies in the speed to obtain near optimal values. This algorithm is based on a gradient search, adjusting axis changes based on the direction of maximum enhancement, thus reducing the number of evaluations of the objective function.\n\n\n\nFigure 4.5: Illustration of the operation of the CLHR algorithm\n\n\nA general description of the steps of the CLHR method is given below:\nStep 1\nGenerate sample: Generation and evaluation of a pseudorandom sample by a Latin hypercube within the feasible parameter space. If the size of the hypercube is greater, uncertainty is reduced within the domain of search.\nStep 2\nRank points: The results obtained in the first step are ordered (Figure 4.6). The best results from the Latin hypercube algorithm will serve as starting points to launch the Rosenbrock algorithm.\n\n\n\nFigure 4.6: Illustration of the operation of the Latin Hypercube algorithm\n\n\nStep 3\nLaunch of Rosenbrock: Rosenbrock algorithm starts at least once. This subroutine searches around the starting point the values that improve the objective function. Depending on whether the objective function improves or worsens, the parameters values are changed to advance or backward.\nStep 4\nAxes change: Axes are changed to orient the Cartesian axes to the direction of maximum improvement. For applying this change of axes, it should have obtained worse results in all directions of search and at least an improvement in one of these directions (remember each direction has 2 ways).\nStep 5\nThe best result of all Rosenbrock releases is stored.\n\n\n\nFigure 4.7: Illustration of the operation of the Rosenbrock algorithm\n\n\n\n\n4.5.2 Algorithm parameters\nNumber of tests with the latin hypercube algorithm is equal to the parameter DivLH (≥ 2).The SEED is responsible for generating the randomness of the sample.\nThe RLAUNCHES (1≥RLAUNCHES≤DivLH) best results from the Latin Hypercube algorithm are used as starting points for the Rosenbrock algorithm.\nThe ALPHA coefficient represents the increment in the direction of search if the objective function improves. The BETA coefficient represents the movement if a worse result is obtained.\nThe STEPROS parameter indicates the subdivisions for each parameter’s range. It is used to calculate value variations in each of the parameters (∆i) to be studied, as presented in equation Equation 4.2.\n\\[\n\\frac{MaxP{arameterValue}_{i} - Min{ParameterValue}_{i}}{STEPROS} = \\mathrm{\\Delta}_{i}\n\\qquad(4.2)\\]\nThe optimization finishes when the convergence criterion (defined as ERR) is achieved, or when the maximum number of iterations MAXN is attained.\n\n\nTable 4.4: Parameters of the CLHR algorithm\n\n\n\n\n\n\n\n\nName\nUnits\nDescription\nDefault Value\n\n\n\n\nMAXN\n-\nMaximum number of iterations\n2000\n\n\nDivLH\n-\nLatin hypercube division\n50\n\n\nSEED\n-\nSeed value\nRandom\n\n\nRLAUNCHES\n-\nRosenbrock algorithm launches\n2\n\n\nALPHA\n-\nAdvance coefficient\n3\n\n\nBETA\n-\nBackward coefficient\n-0.5\n\n\nSTEPROS\n-\nParameter range subdivision\n40\n\n\nERR\n-\nConvergence parameter\n0.001"
  },
  {
    "objectID": "stochastic_equations.html",
    "href": "stochastic_equations.html",
    "title": "5  Expert module - Stochastic equations",
    "section": "",
    "text": "The problem of identifiability is basic to all statistical methods and data analysis and it occurs in diverse areas such as reliability theory, survival analysis, econometrics, etc., where stochastic modelling is widely used (Prakasa, 1992).\nThe module Stochastic of the Expert frame has been implemented for launching multiple simulations depending of the object’s selected parameters. This module uses probability distributions to calculate the simulation parameters. The defaults results are two CSV files, one of them is a statistics series of all the simulations and the other is a parameter series with a selected distribution. The user can save all the simulation in a single file when the process is finished."
  },
  {
    "objectID": "stochastic_equations.html#sec-stochastic_equations_distributions",
    "href": "stochastic_equations.html#sec-stochastic_equations_distributions",
    "title": "5  Expert module - Stochastic equations",
    "section": "5.2 Probability distributions",
    "text": "5.2 Probability distributions\nA probability distribution assigns a probability to each measurable subset of the possible outcomes of a random experiment. The predefined distributions are uniform, normal, log normal, exponential and finally it is possible use a customized distribution (Figure 5.1).\n\n\n\nFigure 5.1: Probability distributions of the stochastic simulations module\n\n\nFor define a correct probability distribution, the area under the probability density function must be equal to 1. For other hand, cumulative distribution function is bounded between 0 and 1 and also it must be non-decreasing and right-continuous.\n\n5.2.1 Uniform\nThe continuous uniform distribution or rectangular distribution is a family of symmetric probability distributions such that for each member of the family, all intervals of the same length on the distribution’s support are equally probable. Figure 5.2 shows an example with a bounded X between [-5, 5].\n\n\n\nFigure 5.2: Uniform distribution. Probability density function (left), cumulative distribution function (right)\n\n\n\n\n5.2.2 Normal\nThe normal distribution (or Gaussian distribution) is a very common continuous probability distribution. Normal distributions are important in statistics and are often used to represent distributions are not known. Several characterizations of the univariate and the multivariate normal distribution are known (Kagan et al., 1967; Prakasa, 1992) The normal distribution is sometimes informally called the bell curve. The following Figure 5.3 shows an example with a bounded X axis between [-5,5], where is more probable to find a X value.\n\n\n\nFigure 5.3: Normal distribution. Probability density function (left), cumulative distribution function (right)\n\n\nProbability density function:\n\\[\n\\varphi = f(x\\ |\\ \\mu,\\ \\sigma) = \\frac{1}{\\sigma\\sqrt{2\\pi}} \\cdot e^{- \\frac{(x - \\mu)^{2}}{2\\sigma^{2}}}\n\\qquad(5.1)\\]\nwith \\(\\mu\\): mean or expectation of the distribution (and also its median and mode); \\(\\sigma^{2}\\): variance; \\(\\sigma\\): standard deviation.\nCumulative distribution function:\n\\[\n\\phi = f(x\\ |\\ \\mu,\\ \\sigma) = \\frac{1}{2}\\cdot \\Bigg( 1 + \\frac{1}{\\sqrt{\\pi}}\\int_{- \\Big( \\frac{x - \\mu}{\\sigma\\sqrt{2}} \\Big)}^{\\Big( \\frac{x - \\mu}{\\sigma\\sqrt{2}} \\Big)}e^{{- t}^{2}} \\mathrm{d}t \\Bigg)\n\\qquad(5.2)\\]\nThe normal distribution is useful because of the central limit theorem. In its most general form, under some conditions, it states that averages of random variables independently drawn from independent distributions converge in distribution to the normal, that is, become normally distributed when the number of random variables is sufficiently large.\n\n\n5.2.3 Log normal\nA log-normal distribution is a continuous probability distribution of a random variable whose logarithm is normally distributed. Consequently, if the random variable X is log-normally distributed, then Y = ln(X) has a normal distribution. Likewise, if Y has a normal distribution, then X = ey has a log-normal distribution. A random variable which is log-normally distributed takes only positive real values (Johnson et al., 1994). Figure 5.4 shows an example with a bounded X axis between [0, 2], where is more probable to find an X value.\n\n\n\nFigure 5.4: Log normal distribution. Probability density function (left), cumulative distribution function (right)\n\n\nProbability density function:\n\\[\n\\varphi = f(x\\ |\\ \\mu,\\ \\sigma) = \\frac{1}{x\\sigma\\sqrt{2\\pi}}e^{- \\frac{\\left( \\ln x - \\mu \\right)^{2}}{2\\sigma^{2}}}\n\\qquad(5.3)\\]\nwith \\(\\mu\\): mean or expectation of the distribution (and also its median and mode); \\(\\sigma^{2}\\): variance; \\(\\sigma\\) standard deviation.\nCumulative distribution function:\n\\[\n\\phi = f(x\\ |\\ \\mu,\\ \\sigma) = \\frac{1}{2}\\left\\lbrack 1 + \\frac{1}{\\sqrt{\\pi}}\\int_{- \\left( \\frac{\\ln x - \\mu}{\\sigma\\sqrt{2}} \\right)}^{\\left( \\frac{\\ln x - \\mu}{\\sigma\\sqrt{2}} \\right)}e^{{- t}^{2}}dt \\right\\rbrack\n\\qquad(5.4)\\]\nA log-normal process is the statistical realization of the multiplicative product of many independent random variables, each of which is positive. This is justified by considering the central limit theorem in the log domain. The log-normal distribution is the maximum entropy probability distribution for a random variate X for which the mean and variance of ln(X) are specified (Park and Vera, 2009)\n\n\n5.2.4 Exponential\nThe exponential distribution describes the time between events in a Poisson point process. Is a type of random mathematical object that consists of points randomly located on a mathematical space (Stoyan et al., 1995). It is a particular case of the gamma distribution. It is the continuous analogue of the geometric distribution, and it has the key property of being memoryless. Figure 5.5 shows an example with a bounded X axis between [0, 10], where is more probable to find an X value.\n\n\n\nFigure 5.5: Exponential distribution. Probability density function (left), cumulative distribution function (right)\n\n\nProbability density function:\n\\[\n\\varphi = f(x\\ |\\ \\lambda) = \\lambda e^{- \\lambda x}\n\\qquad(5.5)\\]\nwith \\(\\lambda\\): the parameter of the distribution, often called the rate parameter [λ>0].\nCumulative distribution function:\n\\[\n\\phi = f(x\\ |\\ \\lambda) = 1 - e^{- \\lambda x}\n\\qquad(5.6)\\]\n\n\n5.2.5 User defined\nFor define a custom probability distribution, the user must create a text file with two columns (Figure 27, left). The first column is the cumulated probability and the second it is for the X value associated. The middle values are calculated with a linear interpolation method. Figure 5.6 right is the cumulative distribution for a user defined distribution.\n\n\n\nFigure 5.6: Custom distribution. Format distribution file (left). Cumulative distribution function (right).\n\n\nFigure 5.7 shows the probability density function for the user defined distribution. As same to cumulative distribution, program calculate middle point through linear interpolation.\n\n\n\nFigure 5.7: User distribution. Probability density function."
  }
]