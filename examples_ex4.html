<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>RS MINERVE Manuals - 19&nbsp; Example 4 – Automatic calibration of a model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./acknowledgments.html" rel="next">
<link href="./examples_ex3.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Example 4 – Automatic calibration of a model</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title"><span id="sec-examples_ex4" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Example 4 – Automatic calibration of a model</span></span></h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">RS MINERVE Manuals</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./user_manual.html" class="sidebar-item-text sidebar-link">User Manual</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./user_rainfall_runoff_modelling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Rainfall-runoff modelling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./user_hydraulic_infrastructures.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Hydraulic infrastructures modelling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./user_database.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Database</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./user_gis.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">GIS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./user_hydro_hydrau_simulation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Hydrological-hydraulic simulation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./user_expert_module.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Expert module</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./user_plugins.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Plugins</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./tech_manual.html" class="sidebar-item-text sidebar-link">Technical Manual</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tech_hydrological_models.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Hydrological and hydraulics models description</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tech_performance_indicators.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Performance indicators</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tech_calibration_algorithms.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Calibration algorithms</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tech_stochastic_equations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Stochastic equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tech_scripts.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Visual Basic Scripts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tech_file_formats.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">File formats</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tech_database_formats.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Database formats</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tech_gis_formats.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">GIS formats</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./examples.html" class="sidebar-item-text sidebar-link">Examples of application</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./examples_ex1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Example 1 – Simple basin with only runoff</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./examples_ex2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Example 2 – Combined full basin with meteorological stations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./examples_ex3.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Example 3 – Equipped basin with a hydropower scheme</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./examples_ex4.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Example 4 – Automatic calibration of a model</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./acknowledgments.html" class="sidebar-item-text sidebar-link">Acknowledgments</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Appendices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix_list_param_ic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Appendix: List of parameters and initial conditions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix_list_notifications.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">List of notifications from pre-simulation and post-simulation reports</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#objective-of-example-4" id="toc-objective-of-example-4" class="nav-link active" data-scroll-target="#objective-of-example-4"><span class="toc-section-number">19.1</span>  Objective of Example 4</a></li>
  <li><a href="#resolution-of-example-4" id="toc-resolution-of-example-4" class="nav-link" data-scroll-target="#resolution-of-example-4"><span class="toc-section-number">19.2</span>  Resolution of Example 4</a></li>
  <li><a href="#results-of-example-4" id="toc-results-of-example-4" class="nav-link" data-scroll-target="#results-of-example-4"><span class="toc-section-number">19.3</span>  Results of Example 4</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>This example allows an introduction to the use of the tool of hydrologic calibration in Expert module. The model starts with the previous model built in Example 2, with the same parameters. The calibration will be based on the comparison between observed and simulated discharges. Through this example (<a href="#fig-examples_model_scheme_ex4">Figure&nbsp;<span>19.1</span></a>), five parameters are calibrated. Two parameters are calibrated for the GSM object and three for the HBV model:</p>
<ul>
<li><p>GSM-An, the degree-day snowmelt coefficient</p></li>
<li><p>GSM-Agl, the Degree-day icemelt coefficient</p></li>
<li><p>HBV-FC, the maximum soil storage capacity</p></li>
<li><p>HBV-SUMax, the upper reservoir water level threshold</p></li>
<li><p>HBV-Kr, the near surface flow storage coefficient</p></li>
</ul>
<p>The range of values for the calibration can be defined based on the values given as regular range in <a href="appendix_list_param_ic.html"><span>Appendix&nbsp;A</span></a>. The temperatures, the precipitations and the outflow observed are in the database “Database manual”. A uniform and null ETP is assumed for this example (the user can check the selected ETP method in the RS MINERVE Settings).</p>
<div id="fig-examples_model_scheme_ex4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/fig-examples_model_scheme_ex4.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;19.1: Model scheme</figcaption><p></p>
</figure>
</div>
<section id="objective-of-example-4" class="level2" data-number="19.1">
<h2 data-number="19.1" class="anchored" data-anchor-id="objective-of-example-4"><span class="header-section-number">19.1</span> Objective of Example 4</h2>
<p>The wanted result is the new values for the calibrated parameters of the GSM and HBV models after the automatic calibration. For the calibration, observed and simulated data are compared at the confluence point and at the outlet for a period between the 01.09.2011 00:00 and the 31.08.2012 00:00. In this example, the calibration uses an Objective Function (OF) with a weight of four for the Nash indicator, two for the Pearson Correlation Coeff indicator, four for the Relative Volume Bias indicator and zero for the other indicators. The “Simulation time step” and the “Recording time step” are fixed to 600 s.</p>
</section>
<section id="resolution-of-example-4" class="level2" data-number="19.2">
<h2 data-number="19.2" class="anchored" data-anchor-id="resolution-of-example-4"><span class="header-section-number">19.2</span> Resolution of Example 4</h2>
<p>For the calibration, it is necessary to add two source objects <img src="figures/fig-icon_object_source.png" style="height:0.24in"> to have a reference flows (observed discharges) at the confluence point and at the outlet. Two comparators objects <img src="figures/fig-icon_object_comparator.png" style="height:0.24in"> are also necessary to compare the results of the simulation with the reference data (observations) coming from the source object.</p>
<p>The Confluence and the Source 1 are connected to the comparator 1. The Outlet and the Source 2 are connected to the Comparator 2. The relations created can be visualized by double clicking on each blue arrow (<a href="#fig-examples_topologic_links_between_objects_ex4">Figure&nbsp;<span>19.2</span></a>, <a href="#fig-examples_possible_outputs_transfer_ex4">Figure&nbsp;<span>19.3</span></a>, <a href="#fig-examples_connection_between_objects_ex4">Figure&nbsp;<span>19.4</span></a>).</p>
<div id="fig-examples_topologic_links_between_objects_ex4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/fig-examples_topologic_links_between_objects_ex4.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;19.2: Topologic links between the different objects</figcaption><p></p>
</figure>
</div>
<p>&nbsp;</p>
<div id="fig-examples_possible_outputs_transfer_ex4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/fig-examples_possible_outputs_transfer_ex4.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;19.3: Possible outputs transfers between objects</figcaption><p></p>
</figure>
</div>
<p>&nbsp;</p>
<div id="fig-examples_connection_between_objects_ex4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/fig-examples_connection_between_objects_ex4.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;19.4: Connections between objects</figcaption><p></p>
</figure>
</div>
<p>Constructed model can be now saved clicking in the button <img src="figures/fig-icon_save_button.png" style="height:0.24in"> and giving a name to the .rsm file (e.g.&nbsp;“Example4.rsm”).</p>
<p>Next, the meteorological data have to be loaded: the dialog box of the database is opened clicking in <img src="figures/fig-icon_database_open.png" style="height:0.24in"> (<a href="#fig-examples_database_frame_ex4">Figure&nbsp;<span>19.5</span></a>) for loading the corresponding database file (“Database manual.dbx”).</p>
<div id="fig-examples_database_frame_ex4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/fig-examples_database_frame_ex2.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;19.5: Database frame</figcaption><p></p>
</figure>
</div>
<p>The user can visualize or modify the database (<a href="#fig-examples_database_model_ex4">Figure&nbsp;<span>19.6</span></a>).</p>
<div id="fig-examples_database_model_ex4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/fig-examples_database_model_ex4.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;19.6: Database of the model</figcaption><p></p>
</figure>
</div>
<p>Once the database is loaded, the user can connect the database to the hydrological model. For achieving this purpose, the user has to choose the correct data source in the corresponding frame (<a href="#fig-examples_datasource_connection_ex4">Figure&nbsp;<span>19.7</span></a>): the group “Measure” and the dataset “DataSet Example 4” for the current example.</p>
<div id="fig-examples_datasource_connection_ex4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/fig-examples_datasource_connection_ex4.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;19.7: Data source used for connecting the model to the database</figcaption><p></p>
</figure>
</div>
<p>Then, the user has to choose the series identifier for each Source object (the series of the database which contains the observed discharges) as shown in <a href="#fig-examples_series_identifier_source_ex4">Figure&nbsp;<span>19.8</span></a>.</p>
<div id="fig-examples_series_identifier_source_ex4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/fig-examples_series_identifier_source_ex4.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;19.8: Series identifier for the “Source 2” object</figcaption><p></p>
</figure>
</div>
<p>In order to clarify the use of the Calibrator tool, the different objects of the model will be aggregated in 2 zones:</p>
<ul>
<li><p>Zone 1: all the objects upstream the “Confluence” object (including the “Confluence”).</p></li>
<li><p>Zone 2: the rest of the objects of the model.</p></li>
</ul>
<p>For that, the user has to double-click on each objects of the Zone 1 and change the Zone form 0 (default) to 1 as shown in <a href="#fig-examples_change_zone_ex4">Figure&nbsp;<span>19.9</span></a>. The user will proceed similarly for the Zone 2.</p>
<div id="fig-examples_change_zone_ex4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/fig-examples_change_zone_ex4.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;19.9: Change of the Zone of the “Station G1” object</figcaption><p></p>
</figure>
</div>
<p>Finally, the module of hydrologic calibration can be launched by clicking on Expert <span class="math inline">\(\rightarrow\)</span> Calibrator in the <em>Modules</em> frame (<a href="#fig-examples_interface_calibrator">Figure&nbsp;<span>19.10</span></a>).</p>
<div id="fig-examples_interface_calibrator" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/fig-examples_interface_calibrator.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;19.10: Interface of the Calibrator tool</figcaption><p></p>
</figure>
</div>
<p>Two calibration configurations can be created, one for each zone of the model (<a href="#fig-examples_creation_calibration_config">Figure&nbsp;<span>19.11</span></a>). Give the order 1 to the calibration of Zone 1 (this one will be executed first) and order 2 to the calibration of Zone 2 (this one will be executed next).</p>
<div id="fig-examples_creation_calibration_config" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/fig-examples_creation_calibration_config.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;19.11: Creation of the calibration configurations</figcaption><p></p>
</figure>
</div>
<p><u>For each calibration configuration</u>, in the Selection frame the HBV and GSM objects types are selected with the corresponding zone (<a href="#fig-examples_selection_objects_calibration">Figure&nbsp;<span>19.12</span></a>).</p>
<div id="fig-examples_selection_objects_calibration" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/fig-examples_selection_objects_calibration.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;19.12: Selection of objects and zones to calibrate, for the “Confluence” calibration configuration</figcaption><p></p>
</figure>
</div>
<p>The parameters to calibrate are checked in the Parameters frame (<a href="#fig-examples_param_calibration">Figure&nbsp;<span>19.13</span></a>). For each of them, the minimum and maximum values are:</p>
<ul>
<li><p>GSM-An: 0.5 – 10</p></li>
<li><p>GSM-Agl: 0.5 – 10</p></li>
<li><p>HBV-FC: 0.05 – 0.65</p></li>
<li><p>HBV-SUMax: 0 – 0.1</p></li>
<li><p>HBV-Kr: 0.05 – 0.5</p></li>
</ul>
<p>The source of the initial values is selected as random for the parameters to calibrate and from model for the others.</p>
<div id="fig-examples_param_calibration" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/fig-examples_param_calibration.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;19.13: Definition of the parameters to calibrate</figcaption><p></p>
</figure>
</div>
<p>In the Comparators frame, select alternatively the comparator whose the observed discharges will be used for the calibration of the corresponding zone (Comparator 1 for the first calibration configuration, and Comparator 2 for the second one).</p>
<div id="fig-examples_selection_comparators" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/fig-examples_selection_comparators.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;19.14: Selection of comparators</figcaption><p></p>
</figure>
</div>
<p>In the Objective Function (OF) frame the weight of the Nash and Relative Volume Bias coefficient are settled to 4 and the weight of the Pearson relative coefficient is 2. The other coefficients are all settled to zero (<a href="#fig-examples_weight_indicators_ex4">Figure&nbsp;<span>19.15</span></a>). The default algorithm parameters are used.</p>
<div id="fig-examples_weight_indicators_ex4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/fig-examples_weight_indicators_ex4.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;19.15: Weight of each indicator to determine the objective function</figcaption><p></p>
</figure>
</div>
<p>After specifying the calibration period in the Solver tab of the Hydrologic parameters optimization frame, the calibration configuration can be saved and then started.</p>
<p>At the end of the calibrations the final parameters obtained are collected in the current model. If the model is saved, the parameters are stored; if not, the hydrological model keeps preliminary parameters.</p>
</section>
<section id="results-of-example-4" class="level2" data-number="19.3">
<h2 data-number="19.3" class="anchored" data-anchor-id="results-of-example-4"><span class="header-section-number">19.3</span> Results of Example 4</h2>
<p>Once the calculation is finished (after approximately 1’300 iterations for the confluence calibration and 400 iteration for the outlet calibration), the best values obtained for the parameters can be visualized in the Summary results frame. From a maximum possible value of the Objective Function (OF) of 6, the best score provided by the algorithm is 5.448 and 5.560 for the confluence calibration and the outlet calibration, respectively.</p>
<p>Hereafter (<a href="#tbl-examples_calibrated_params">Table&nbsp;<span>19.1</span></a> and <a href="#tbl-examples_performance_indicators">Table&nbsp;<span>19.2</span></a>) the results of the calibration (since the algorithm contains the random calculations, it is possible to obtain a similar but not exactly the same result).</p>
<div id="tbl-examples_calibrated_params" class="anchored">
<table class="table">
<caption>Table&nbsp;19.1: Calibrated parameters</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 21%">
<col style="width: 16%">
<col style="width: 21%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">Initial Parameter</th>
<th style="text-align: center;">Initial Parameter</th>
<th style="text-align: center;">Best Parameter</th>
<th style="text-align: center;">Best Parameter</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td style="text-align: center;"><strong>Confluence</strong></td>
<td style="text-align: center;"><strong>Outlet</strong></td>
<td style="text-align: center;"><strong>Confluence</strong></td>
<td style="text-align: center;"><strong>Outlet</strong></td>
</tr>
<tr class="even">
<td>GSM - An</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">0.761</td>
<td style="text-align: center;">-</td>
</tr>
<tr class="odd">
<td>GSM – Agl</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">0.500</td>
<td style="text-align: center;">-</td>
</tr>
<tr class="even">
<td>HBV – FC</td>
<td style="text-align: center;">Different values</td>
<td style="text-align: center;">0.275</td>
<td style="text-align: center;">0.126</td>
<td style="text-align: center;">0.534</td>
</tr>
<tr class="odd">
<td>HBV – SUMax</td>
<td style="text-align: center;">Different values</td>
<td style="text-align: center;">0.0055</td>
<td style="text-align: center;">0.100</td>
<td style="text-align: center;">0.0781</td>
</tr>
<tr class="even">
<td>HBV – Kr</td>
<td style="text-align: center;">Different values</td>
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">0.281</td>
<td style="text-align: center;">0.152</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
<div id="tbl-examples_performance_indicators" class="anchored">
<table class="table">
<caption>Table&nbsp;19.2: Performance indicators</caption>
<colgroup>
<col style="width: 16%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">Initial Performance</th>
<th style="text-align: center;">Initial Performance</th>
<th style="text-align: center;">Final Performance</th>
<th style="text-align: center;">Final Performance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td style="text-align: center;"><strong>Confluence</strong></td>
<td style="text-align: center;"><strong>Outlet</strong></td>
<td style="text-align: center;"><strong>Confluence</strong></td>
<td style="text-align: center;"><strong>Outlet</strong></td>
</tr>
<tr class="even">
<td>Nash</td>
<td style="text-align: center;">-26.38</td>
<td style="text-align: center;">0.87</td>
<td style="text-align: center;">0.89</td>
<td style="text-align: center;">0.91</td>
</tr>
<tr class="odd">
<td>Nash-ln</td>
<td style="text-align: center;">-2.67</td>
<td style="text-align: center;">0.81</td>
<td style="text-align: center;">0.80</td>
<td style="text-align: center;">0.84</td>
</tr>
<tr class="even">
<td>Pearson Correlation Coeff.</td>
<td style="text-align: center;">0.57</td>
<td style="text-align: center;">0.95</td>
<td style="text-align: center;">0.95</td>
<td style="text-align: center;">0.96</td>
</tr>
<tr class="odd">
<td>Kling-Gupta Efficiency</td>
<td style="text-align: center;">-2.20</td>
<td style="text-align: center;">0.91</td>
<td style="text-align: center;">0.94</td>
<td style="text-align: center;">0.95</td>
</tr>
<tr class="even">
<td>Bias Score</td>
<td style="text-align: center;">-9.03</td>
<td style="text-align: center;">0.99</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td>RRMSE</td>
<td style="text-align: center;">3.95</td>
<td style="text-align: center;">0.26</td>
<td style="text-align: center;">0.25</td>
<td style="text-align: center;">0.22</td>
</tr>
<tr class="even">
<td>Relative Volume Bias</td>
<td style="text-align: center;">3.17</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">2E-5</td>
<td style="text-align: center;">-6E-7</td>
</tr>
<tr class="odd">
<td>Normalized Peak Error</td>
<td style="text-align: center;">0.63</td>
<td style="text-align: center;">0.001</td>
<td style="text-align: center;">-0.02</td>
<td style="text-align: center;">-0.005</td>
</tr>
<tr class="even">
<td>OF</td>
<td style="text-align: center;">-117.06</td>
<td style="text-align: center;">5.12</td>
<td style="text-align: center;">5.45</td>
<td style="text-align: center;">5.56</td>
</tr>
</tbody>
</table>
</div>
<p>The simulation fits pretty well the outflow observed (<a href="#fig-examples_results_calibration_ex4">Figure&nbsp;<span>19.16</span></a>). Thus, the new parameters after the calibration can be kept by saving the model.</p>
<div id="fig-examples_results_calibration_ex4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/fig-examples_results_calibration_ex4.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;19.16: Graphic results of the calibration. Hydrograph of both observed and current simulated discharge</figcaption><p></p>
</figure>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./examples_ex3.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Example 3 – Equipped basin with a hydropower scheme</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./acknowledgments.html" class="pagination-link">
        <span class="nav-page-text">Acknowledgments</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>